<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTML5学习笔记 📑 | Make Innovations</title>
    <meta name="description" content=" ">
    <link rel="icon" href="/bob.png">
    
    <link rel="preload" href="/assets/css/0.styles.522f73f5.css" as="style"><link rel="preload" href="/assets/js/app.6a253733.js" as="script"><link rel="preload" href="/assets/js/14.ef8b2dda.js" as="script"><link rel="prefetch" href="/assets/js/10.e3b3ae83.js"><link rel="prefetch" href="/assets/js/11.1743e1e9.js"><link rel="prefetch" href="/assets/js/12.e2a2f476.js"><link rel="prefetch" href="/assets/js/13.8cab6c69.js"><link rel="prefetch" href="/assets/js/15.fb2d2713.js"><link rel="prefetch" href="/assets/js/16.7983a61f.js"><link rel="prefetch" href="/assets/js/17.dec508bf.js"><link rel="prefetch" href="/assets/js/18.db1c2439.js"><link rel="prefetch" href="/assets/js/19.5aa44128.js"><link rel="prefetch" href="/assets/js/2.f32d8142.js"><link rel="prefetch" href="/assets/js/20.b6a814c1.js"><link rel="prefetch" href="/assets/js/21.4f2dad75.js"><link rel="prefetch" href="/assets/js/3.ab30b814.js"><link rel="prefetch" href="/assets/js/4.99255317.js"><link rel="prefetch" href="/assets/js/5.871beb45.js"><link rel="prefetch" href="/assets/js/6.dd899a8f.js"><link rel="prefetch" href="/assets/js/7.ca4fe73c.js"><link rel="prefetch" href="/assets/js/8.7399e17f.js"><link rel="prefetch" href="/assets/js/9.3dabbb14.js">
    <link rel="stylesheet" href="/assets/css/0.styles.522f73f5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Make Innovations</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">分享</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fenxiang/blog.html" class="nav-link">大神博客</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/wenzhang.html" class="nav-link">技术文章</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/gistfile.html" class="nav-link">Emoji表情</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/ziyuan.html" class="nav-link">资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/html5.html" class="nav-link router-link-exact-active router-link-active">HTML5</a></li><li class="dropdown-subitem"><a href="/learn/css3.html" class="nav-link">CSS3</a></li><li class="dropdown-subitem"><a href="/learn/js.html" class="nav-link">js</a></li><li class="dropdown-subitem"><a href="/learn/jQuery.html" class="nav-link">jQuery</a></li><li class="dropdown-subitem"><a href="/learn/ES6.html" class="nav-link">ES6</a></li><li class="dropdown-subitem"><a href="/learn/webpack.html" class="nav-link">webpack</a></li><li class="dropdown-subitem"><a href="/learn/wangluo.html" class="nav-link">网络</a></li><li class="dropdown-subitem"><a href="/learn/git.html" class="nav-link">git</a></li><li class="dropdown-subitem"><a href="/learn/vue.html" class="nav-link">vue</a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/node.html" class="nav-link">node</a></li><li class="dropdown-subitem"><a href="/learn/MySQL.html" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/learn/MongoDB.html" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">分享</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fenxiang/blog.html" class="nav-link">大神博客</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/wenzhang.html" class="nav-link">技术文章</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/gistfile.html" class="nav-link">Emoji表情</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/ziyuan.html" class="nav-link">资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/html5.html" class="nav-link router-link-exact-active router-link-active">HTML5</a></li><li class="dropdown-subitem"><a href="/learn/css3.html" class="nav-link">CSS3</a></li><li class="dropdown-subitem"><a href="/learn/js.html" class="nav-link">js</a></li><li class="dropdown-subitem"><a href="/learn/jQuery.html" class="nav-link">jQuery</a></li><li class="dropdown-subitem"><a href="/learn/ES6.html" class="nav-link">ES6</a></li><li class="dropdown-subitem"><a href="/learn/webpack.html" class="nav-link">webpack</a></li><li class="dropdown-subitem"><a href="/learn/wangluo.html" class="nav-link">网络</a></li><li class="dropdown-subitem"><a href="/learn/git.html" class="nav-link">git</a></li><li class="dropdown-subitem"><a href="/learn/vue.html" class="nav-link">vue</a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/node.html" class="nav-link">node</a></li><li class="dropdown-subitem"><a href="/learn/MySQL.html" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/learn/MongoDB.html" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>HTML5学习笔记 📑</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/learn/html5.html#html5新增标签" class="sidebar-link">HTML5新增标签</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#html5新增属性" class="sidebar-link">HTML5新增属性</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#拖放" class="sidebar-link">拖放</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#canvas画布" class="sidebar-link">canvas画布</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#svg矢量图" class="sidebar-link">SVG矢量图</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#audio-音频和video视频" class="sidebar-link">Audio 音频和video视频</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#requestanimationframe" class="sidebar-link">requestAnimationFrame</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#客户端存储" class="sidebar-link">客户端存储</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#历史记录" class="sidebar-link">历史记录</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#worker" class="sidebar-link">worker</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#filereader读取文件" class="sidebar-link">FileReader读取文件</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#websocke" class="sidebar-link">WebSocke</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="html5学习笔记"><a href="#html5学习笔记" aria-hidden="true" class="header-anchor">#</a> HTML5学习笔记 📑</h1> <h2 id="html5新增标签"><a href="#html5新增标签" aria-hidden="true" class="header-anchor">#</a> HTML5新增标签</h2> <p>1.Header、Footer、Article（div）、Section（p）、Nav、Aside这六个标签只是为了语义化更好，功能类似div，Section更像p标签<br>
2.Svg 、Canvas是绘图标签<br>
3.Audio、Video音频与视频标签<br>
4.自定义标签: 行级元素</p> <h2 id="html5新增属性"><a href="#html5新增属性" aria-hidden="true" class="header-anchor">#</a> HTML5新增属性</h2> <p>1.Contenteditable：规定元素内容是否可编辑。如果元素未设置 contenteditable 属性，那么元素会从其父元素继承该属性。</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>div contenteditable<span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">&gt;</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.Draggable ：dom元素是否可拖拽</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>div draggable<span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">&gt;</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.Hidden ：dom元素隐藏，就是靠display：none实现的</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>div hidden<span class="token operator">&gt;</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4.Contextmenu  为元素设定快捷菜单（目前无浏览器支持 contextmenu 属性。 ）
5.data-val 自定义属性:只能通过getAttribute来获取自定义属性</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div data<span class="token operator">-</span>my<span class="token operator">=</span><span class="token string">&quot;asd&quot;</span><span class="token operator">&gt;</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dataval <span class="token operator">=</span> div<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-my'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataval<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="拖放"><a href="#拖放" aria-hidden="true" class="header-anchor">#</a> 拖放</h2> <div class="tip custom-block"><p class="custom-block-title">属性</p> <p>draggable： auto | true | false</p></div> <div class="tip custom-block"><p class="custom-block-title">拖动事件</p> <p>dragstart → 在元素开始被拖动时触发<br>
dragen → 在拖动操作完成时触发<br>
drag → 在元素被拖动时触发</p></div> <div class="tip custom-block"><p class="custom-block-title">释放区事件：</p> <p>dragenter → 被拖动元素进入到释放区所占据得屏幕空间时触发<br>
dragover → 当被拖动元素在释放区内移动时触发（默认事件会阻止drop事件）<br>
dragleave → 当被拖动元素没有放下就离开释放区时触发<br>
drop → 当被拖动元素在释放区里放下时触发</p></div> <p>通过e.target获取被拖拽的dom元素，从而实现对dom的操作</p> <div class="tip custom-block"><p class="custom-block-title">dataTransfer</p> <p>返回用于传输数据到释放区的对象---就是dragstart传出数据，到drop里才能取数据</p></div> <img src="/H5/drag.png" alt="drag" style="margin:10px auto"> <pre><code>①传值
    e.dataTransfer.setData(&quot;data&quot;,e.target.id)
    拖拽事件时，传值第一个参数是“名”，第二个参数是值（可以传id值，从而实现DOM结构的改变）。
②取值
    e.dataTransfer.getData(&quot;data&quot;)
    查看传的值。
</code></pre> <p><strong>使用拖拽上传文件</strong><br>
上传文件</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-js"><code>ele<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'dragover'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//取消默认事件，drop才能触发。</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ele<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'drop'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用 preventDefault() 来避免浏览器对数据的默认处理（drop 事件的默认行为是以链接形式打开）</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">var</span> dt <span class="token operator">=</span> e<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">;</span>
    <span class="token keyword">var</span> files <span class="token operator">=</span> dt<span class="token punctuation">.</span>files<span class="token punctuation">;</span><span class="token comment">//取到被拖拽元素的信息。</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>FileReader 用于读取文件：abort() 终止读取</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token comment">//通过不同的方式读取文件  </span>
<span class="token function">readAsBinaryString</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> 将文件读取为二进制编码
<span class="token function">readAsDataURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> 将文件读取为DataURL编码
<span class="token function">readAsText</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token punctuation">[</span>encoding<span class="token punctuation">]</span><span class="token punctuation">)</span> 将文件读取为文本
<span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> 将文件读取为arraybuffer

<span class="token comment">//读取中的事件</span>
onloadstart 读取开始时触发
onprogress 读取中
onloadend 读取完成触发，无论成功或失败
onload 文件读取成功完成时触发
onabort 中断时触发
onerror 出错时触发
获取读取的结果
fr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
<span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="canvas画布"><a href="#canvas画布" aria-hidden="true" class="header-anchor">#</a> canvas画布</h2> <div class="tip custom-block"><p class="custom-block-title">Canvas应用场景</p> <p>游戏、图表<a href="https://echarts.baidu.com/" target="_blank" rel="noopener noreferrer">https://echarts.baidu.com/)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、动画、HTML5 动效<a href="https://codepen.io/" target="_blank" rel="noopener noreferrer">https://codepen.io/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <p>初始化</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 创建画布 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>canvas id<span class="token operator">=</span><span class="token string">&quot;canv&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;300&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;300&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;border:1px solid black;&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">const</span> oCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canv'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//找到画布</span>
    <span class="token keyword">const</span> oPen <span class="token operator">=</span> oCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//找到画笔 </span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">设置画布宽高注意事项</p> <p>Canvas元素默认宽 300px, 高 150px, 设置其宽高可以使用如下方法：
方法一：</p> <pre><code>&lt;canvas width=&quot;500&quot; height=&quot;500&quot;&gt;&lt;/canvas&gt;
</code></pre> <p>方法二：</p> <pre><code>var canvas = document.getElementById('欲操作canvas的id');
canvas.width = 500;
canvas.height = 500;
</code></pre> <p>若通过如下方法设置宽高，那么Canvas元素将由原来大小被拉伸到所设置的宽高：
方法一：使用CSS 会被拉伸</p> <pre><code>#欲操作canvas的id｛
    width:1000px;
height:1000px;
｝
</code></pre> <p>也包含了行间样式中的 style=&quot;&quot; 。也就是上面的例子，也会产生拉伸的情况。
方法二：使用HTML5 Canvas API操作 会被拉伸</p> <pre><code>var canvas = document.getElementById('欲操作canvas的id');
canvas.style.width = &quot;1000px&quot;;
canvas.style.height = &quot;1000px&quot;;
</code></pre> <p>方法三 ：用jquery的$(&quot;#id&quot;).width(500);会被拉伸
其它：canvas的width和height也不能用百分比表示。canvas会将百分值当成数值显示</p></div> <div class="tip custom-block"><p class="custom-block-title">绘制线段</p> <p>oPen.moveTo(x, y);  移动到 x，y坐标点（画笔的起始点）<br>
oPen.lineTo(x, y); 从当前点绘制直线到x，y点（画笔想移动到哪一点）<br>
oPen.lineWidth  = 20; 设置线段宽度（画笔粗细）<br>
oPen.closePath();  闭合当前路径  和回到起始点的区别<br>
oPen.fill();  填充<br>
oPen.stroke();  描边（按照路径移动画笔，是渲染页面，必须在一段线画完后再写，即上面的方法应该都在这个方法前写）<br>
oPen.beginPath() 完成一条路径后要重新开始另一条路径时必须使用beginPath()方法</p></div> <div class="tip custom-block"><p class="custom-block-title">绘制矩形</p> <p>ctx.rect(x, y, dx, dy) x y 是画矩形的起始点，是矩形的左上角，dx dy是宽高，<br>
ctx.fillRect(x, y, dx, dy) 参数与上面的意义一样，就是这方法直接填充<br>
ctx.strokeRect(x, y, w, h) 参数与上面的意义一样，就是这方法直接描边<br>
ctx.clearRect(x, y, dx, dy) 参数与上面的意义一样，相当于橡皮，擦除矩形;</p></div> <div class="tip custom-block"><p class="custom-block-title">绘制弧形</p> <p>ctx.arc(x, y, r, 起始角度, 结束角度, 弧形的方向 ) x y 是圆心，r是半径，方向是--&gt; 0顺时针 1逆时针 度数使用------&gt;2 * Math.PI = 360度</p></div> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> oCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canv'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//找到画布</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> oCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//找到画笔</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//绘制起始点，便于控制图形闭合</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//绘制100、120至100、200这条线和100、200至200、200这条线的圆角</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//绘制100、200至200、200这条线和200、200至200、100这条线的圆角</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ctx.arcTo(100,200,200,200,20);//如果不用moveto，用这个图形难以闭合 </span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">贝塞尔曲线</p> <p>ctx.quadraticCurveTo(x1, y1,ex,ey ) 二次贝塞尔曲线       x1,y1 控制点       ex,ey 结束点<br>
ctx.bezierCurveTo(x1, y1, x2, y2, ex, ey) 三次贝塞尔曲线      x1,y1，x2,y2 控制点      ex,ey 结束点</p></div> <div class="tip custom-block"><p class="custom-block-title">坐标轴转换</p> <p>ctx.translate(dx, dy)   重新映射画布上的 (0,0)坐标位置<br>
ctx.scale(sx, sy)   缩放当前绘图<br>
ctx. rotate(Math.PI)    旋转当前的绘图<br>
ctx.save() restore()        保存当前图像状态的一份拷贝(保存画布状态）      从栈中弹出存储的图形状态并恢复<br>
ctx. setTransform(a, b, c, d, e, f) 先重置再变换      参数：水平缩放、水平倾斜、垂直倾斜、垂直缩放、水平移动、垂直移动<br>
ctx.transform(a, b, c, d, e, f) 在之前的基础上变换</p></div> <div class="tip custom-block"><p class="custom-block-title">填充图案</p> <p>ctx.createPattern(image,&quot;repeat|repeat-x|repeat-y|no-repeat&quot;) 第一个参数可以填写：img元素（Image对象），canvas元素，video元素(有图形的) 第二个参数关于重复的设置<br>
填充的图案没有定位</p></div> <img src="/H5/canvas1.png" alt="canvas1" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">渐变</p> <p>ctx.createLinearGradient(x1, y1, x2, y2); 线性渐变 必须在填充渐变的区域里定义渐变, 否则 没有效果 x1, y1 起始点 x2, y2终止点<br>
ctx.createRadialGradient(x1, y1, r1, x2, y2, r2); 径向渐变<br>
bg.addColorStop(p, color) 第一个参数是百分比从0 - 1 第二个参数是颜色</p></div> <div class="tip custom-block"><p class="custom-block-title">阴影</p> <p>ctx.shadowColor 阴影颜色<br>
ctx.shadowOffsetX 阴影水平偏移量<br>
ctx.shadowOffsetY 阴影垂直偏移量<br>
ctx.shadowBlur 阴影模糊半径<br>
注：这里的阴影偏移量不受坐标系变换的影响</p></div> <img src="/H5/canvas2.png" alt="canvas2" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">文本</p> <p>ctx.fillText()<br>
ctx.strokeText()<br>
ctx.measureText('hello world') 了解</p></div> <img src="/H5/canvas3.png" alt="canvas3" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">线段样式</p> <p>1.lineCap<br>
2.lineJoin<br>
ctx.miterLimit 当lineJoin是miter时，用于控制斜接部分的长度 如果斜接长度超过 miterLimit 的值，变成bevel 注:实际运算是大于limit*lineWidth/2的值，了解就好</p></div> <img src="/H5/canvas4.png" alt="canvas4" style="margin:10px auto"> <img src="/H5/canvas5.png" alt="canvas5" style="margin:10px auto"> <img src="/H5/canvas6.png" alt="canvas6" style="margin:10px auto"> <img src="/H5/canvas7.png" alt="canvas7" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">裁剪</p> <p>ctx.clip()；当前路径外的区域不再绘制 裁剪的是画布<br>
注：可在clip() 前用 save() 方法保存，后续通过 restore() 方法恢复</p></div> <img src="/H5/canvas8.png" alt="canvas8" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">合成</p> <p>ctx.globalCompositeOperation = 'source-over' 新像素和原像素的合并方式<br>
11种值  默认 source-over w3c标准 常用 source-over, destination-over, copy</p></div> <img src="/H5/canvas9.png" alt="canvas9" style="margin:10px auto"> <img src="/H5/canvas10.png" alt="canvas10" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">全局透明度</p> <p>ctx.globalAlpha = '0.5'; 只能作用到这个方法下面的元素</p></div> <div class="tip custom-block"><p class="custom-block-title">绘制图片</p> <p>ctx.drawImage();   第一个参数是(Image或 canvas) 注：onload注意要全部加载完<br>
写3个参数时  (x, y) 起始点坐标<br>
写5个参数 (x, y, dx, dx)      起始点坐标及图片所存区域的宽高<br>
写9个参数 (x1, y1, dx1, dy1, x2, y2, w2, h2)      前四个为所绘制目标元素<br>
的起始点和宽高（就是截取图片的哪一部分用来展示） 后四个为canvas<br>
绘制的起始点和大小（与5个参数的后四个一样）</p></div> <div class="tip custom-block"><p class="custom-block-title">将canvas内容导出</p> <p>canvas.toDataURL() ; 是canvas自身的方法不是(ctx)上下文对象<br>
将canvas的内容抽取成⼀张图片, base64编码格式<br>
注：同源策略的限制（开启服务器）<br>
将canvas的内容放入img元素里</p></div> <img src="/H5/canvas11.png" alt="canvas11" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">获取canvas像素信息</p> <p>ctx.getImageData(x, y, dx, dy) // 同源策略 取到的data值是数组，是每个像素的信息 注：
每像素由rgba四个参数组成<br>
ctx.createImageData(w, h) 创建新的空白 ImageData 对象 一般不用<br>
ctx.putImageData(imgData, x, y)  将图像数据放回画布上 可以利用ctx.getImageData<br>
取到像素信息进行更改，再用这个方法把新的数据放回画布
上，（就是对图像调色）</p></div> <div class="tip custom-block"><p class="custom-block-title">命中检测（检测点是否在路径内）</p> <p>ctx.isPointInPath(x, y)；检测是否在区域内,chrome 与其他的区别  如果当前路径不是闭合路径谷歌浏览器会返回false<br>
ctx.isPointInStroke(x, y)；检测是否在线上<br>
还可以通过检测当前点的像素值，如果为透明，则该点不再路径上</p></div> <div class="tip custom-block"><p class="custom-block-title">如何解决canvas高分变率的屏幕模糊问题</p> <p>在分辨率比较高的屏幕，例如ip6/6s/mac等机器上，因为canvs绘制的是位图，所以会导致模糊，解决方法是根据屏幕分辨率修改canvas样式代码中的宽和高与canvas的width和height属性的比例</p></div> <h2 id="svg矢量图"><a href="#svg矢量图" aria-hidden="true" class="header-anchor">#</a> SVG矢量图</h2> <div class="tip custom-block"><p class="custom-block-title">应用场景</p> <p>图表、图标 icon（主要实现图标）、动效、矢量图</p></div> <div class="tip custom-block"><p class="custom-block-title">使用</p> <pre><code>&lt;svg width=“500px” height=“500px”&gt; //与canvas一样宽高要定义在行间
</code></pre></div> <p>直线：x1 y1是起始点坐标 x2 y2是终止点坐标 要想看到线要在css里写stroke=“red”</p> <pre><code>&lt;line x1=&quot;100&quot; y1=&quot;100&quot; x2=&quot;200&quot; y2=&quot;100&quot;&gt;&lt;/line&gt;
</code></pre> <p>矩形：x y矩形左上角的坐标 rx ry圆角 封闭路径自动填充</p> <pre><code>&lt;rect x=&quot;50&quot; y=&quot;50&quot; width=&quot;100&quot; height=&quot;100&quot; rx=&quot;10&quot;ry=&quot;20&quot;&gt;&lt;/rect&gt;
</code></pre> <p>圆形：r 半径 cx cy 圆心</p> <pre><code>&lt;circle r=&quot;50&quot; cx=&quot;220&quot; cy=&quot;100&quot;&gt;&lt;/circle&gt;
</code></pre> <p>椭圆：rx ry 半径 cx cy 圆心</p> <pre><code>&lt;ellipse rx=&quot;100&quot; ry=&quot;50&quot; cx=&quot;400&quot; cy=&quot;150&quot;&gt;&lt;/ellipse&gt;
</code></pre> <p>折线：</p> <pre><code>&lt;polyline points=&quot;60 50, 75 35, 100 50, 125 35, 150 50,175 35, 190 50&quot;&gt;&lt;/polyline&gt;
</code></pre> <p>多边形</p> <pre><code>&lt;polygon points=&quot;125 125,130 140,120 140&quot;&gt;&lt;/polygon&gt;
</code></pre> <p>⽂本</p> <pre><code>&lt;text x=&quot;125&quot; y=&quot;220&quot;&gt;hello,world&lt;/text&gt;
</code></pre> <div class="tip custom-block"><p class="custom-block-title">样式：css里的svg标签属性</p> <p>fill 填充<br>
stroke 描边<br>
stroke-width 线宽<br>
stroke-opacity/fill-opacity 透明度<br>
stroke-linecap 线两端的样式<br>
stroke-linejoin 两线之间的连接样式<br>
stroke-miterlimit miter样式中，超过这个值就截断</p></div> <img src="/H5/svg1.png" alt="svg1" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">Path元素</p> <p>M指令和L指令</p> <pre><code>&lt;path d = &quot;M 10 10 L 20 10&quot; /&gt;  
</code></pre> <p>m指令和l指令</p> <pre><code>&lt;path d = &quot;m 10 10 l 20 10&quot; /&gt;  
</code></pre> <p>大写表示绝对定位，小写表示相对定位<br>
绝对坐标和相对坐标  相对于上一个移动距离<br>
H和V命令</p> <pre><code>&lt;path d=&quot;M 100 100 H 200 V 200&quot;/&gt;  
</code></pre> <p>水平（horizontal lineto）竖直（vertical lineto）方向移动距离<br>
Z命令</p> <pre><code>&lt;path d=&quot;M 100 100 H 200 V 200 z&quot;/&gt;  
</code></pre> <p>注：闭合 Z不区分大小写</p></div> <div class="tip custom-block"><p class="custom-block-title">圆弧指令</p> <pre><code>&lt;path d=&quot;M 100 100 A 70 120 90 1 1 150 200&quot;&gt;&lt;/path&gt;
</code></pre> <p>A命令  (elliptical Arc)  七个参数<br>
rx ry x-axis-rotation large-arc-flag sweep-flag x y<br>
rx ry 圆弧的x轴半径和y轴半径<br>
x-axis-rotation 圆弧相对x轴的旋转角度，默认是顺时针，可以设置负值<br>
large-arc-flag 表示圆弧路径是大圆弧还是小圆弧 1大圆弧<br>
sweep-flag 表示从起点到终点是顺时针还是逆时针，1表示顺时针，0表示逆时针<br>
x y 表示终点坐标，绝对或相对</p></div> <div class="tip custom-block"><p class="custom-block-title">贝塞尔曲线：自动生成路径——&gt;http://editor.method.ac/</p> <p>二次贝塞尔: Q x1 y1, x y 关键点 T x y 扩展点<br>
三次贝塞尔曲线：C x1 y1, x2 y2, x y 关键点 S x2 y2, x y 扩展点</p></div> <div class="tip custom-block"><p class="custom-block-title">渐变</p> <p>线性渐变：x1 y1--起始点 x2 y2---终止点 offset到哪个位置style设置为什么颜色<br> <img src="/H5/svg2.png" alt="svg2" style="margin:10px auto"></p> <p>径向渐变
<img src="/H5/svg3.png" alt="svg3" style="margin:10px auto"></p> <p>高斯滤镜</p> <pre><code>&lt;defs&gt;
    &lt;filter id=&quot;Gaussian_Blur&quot;&gt;
        &lt;feGaussianBlur in=&quot;SourceGraphic&quot; stdDeviation=&quot;20&quot;/&gt;
    &lt;/filter&gt;
&lt;/defs&gt;
&lt;rect x=&quot;0&quot; y=&quot;0&quot; width=&quot;500&quot; height=&quot;500&quot; fill=”yellow” style=&quot;filter:url(#Gaussian_Blur)&quot;/&gt;
</code></pre> <p>其他滤镜-----http://www.w3school.com.cn/svg/svg_filters_intro.asp</p></div> <div class="tip custom-block"><p class="custom-block-title">SVG路径动画（结合css3实现动画效果）</p> <p>stroke-dasharray： 10px 20px 30px; 切割线段，按照10px 20px 30px的顺序，显示为
虚线。可写多值
stroke-dashoffset: 15px; 线段偏移效果，</p></div> <div class="tip custom-block"><p class="custom-block-title">Js操作svg</p> <p>getTotalLength（） 获取路径总长度<br>
getPointAtLength(x) 获取路径上距离起始点距离x长度的点的坐标<br>
注：严格来说上面两方法只适用于path元素，但各个浏览器实现起来都会有一点区别。例如<br>
谷歌浏览器也能获取到line元素的路径长度。</p> <pre><code>&lt;svg width=&quot;400&quot; height=&quot;300&quot; viewBox=&quot;0,0,40,30&quot; style=&quot;border:1px solid #cd0000;&quot;&gt;
    &lt;rect x=&quot;10&quot; y=&quot;5&quot; width=&quot;20&quot; height=&quot;15&quot; fill=&quot;#cd0000&quot;/&gt;
&lt;/svg&gt;
</code></pre> <p>viewBox定义了svg图内部的相对像素大小。---相对svg在浏览器上的像素，按比例放大可视区。<br>
preserveAspectRatio(作用的对象都是viewBox)<br>
preserveAspectRatio=&quot;xMidYMid meet&quot;<br>
svg.setAttribute(&quot;preserveAspectRatio&quot;, &quot;xMinYMin meet&quot;);<br>
第1个值表示，viewBox如何与SVG viewport对齐（见下表）；<br>
第2个值表示，如何维持高宽比（如果有）<br>
meet:保持纵横比缩放viewBox适应viewport<br>
slice:保持纵横比同时比例小的方向放大填满viewport(在均匀缩放的同时保持viewbox的宽高比)<br>
none: 扭曲纵横比以充分适应viewport<br>
http://www.zhangxinxu.com/study/201408/svg-preserveaspectratio-meet-slice-none.html</p></div> <img src="/H5/svg4.png" alt="svg4" style="margin:10px auto"> <img src="/H5/svg5.png" alt="svg5" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">JS 生成SVG元素</p> <p>创建SVG元素需要指定命名空间<br>
SVG元素对象必须通过调用setAttribute()方法来设定属性值</p></div> <img src="/H5/svg6.png" alt="svg6" style="margin:10px auto"> <h2 id="audio-音频和video视频"><a href="#audio-音频和video视频" aria-hidden="true" class="header-anchor">#</a> Audio 音频和video视频</h2> <p><a href="http://www.w3school.com.cn/html5/html5_ref_audio_video_dom.asp" target="_blank" rel="noopener noreferrer">w3c教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="tip custom-block"><p class="custom-block-title">添加</p> <pre><code>&lt;audio id=&quot;audio&quot; src=&quot;./成都.mp3&quot;&gt;&lt;/audio&gt;
&lt;video id=&quot;video&quot; src=&quot;./成都.mp4&quot;&gt;&lt;/video&gt;
</code></pre></div> <div class="tip custom-block"><p class="custom-block-title">属性</p> <p>autoplay 自动播放 → 谷歌浏览器不支持本地自动播放，必须放置在服务器上</p> <pre><code>&lt;audio src=&quot;成都.mp3&quot; autoplay&gt;&lt;/audio&gt;  
</code></pre> <p>controls 设置控件 → 必须添加控件，否则音频不显示，视频不播放</p> <pre><code>&lt;audio src=&quot;成都.mp3&quot; autoplay controls&gt;&lt;/audio&gt;  
</code></pre> <p>preload(none/metadata/auto) 预加载，规定是否在页面加载后载入音频<br>
→ none 不需要加载数据，使用时再加载<br>
→ metadata 先加载元数据（如时长、比特率、帧大小这样的原数据），再加载媒体内容<br>
→ auto 浏览器应当加载它认为适量的媒体内容</p> <pre><code>&lt;audio src=&quot;成都.mp3&quot; autoplay controls preload=&quot;auto&quot;&gt;&lt;/audio&gt;
</code></pre> <p>loop 是否循环播放音/视频</p> <pre><code>&lt;audio src=&quot;成都.mp3&quot; autoplay controls loop preload=&quot;auto&quot;&gt;&lt;/audio&gt;
</code></pre> <p>poster (video 独有)  → 当视频不可用时，使用一张图片替代，否则是空白</p> <pre><code>&lt;video src=&quot;成都.mp4&quot; poster=&quot;封面.jpg&quot; controls&gt;&lt;/video&gt;
</code></pre> <p>source多类型资源 → 为了兼容，配置多种格式，浏览器支持哪个用哪个</p> <pre><code>&lt;audio id=&quot;music&quot;&gt; 
        &lt;source src=&quot;成都.mp3&quot; type=&quot;audio/mpeg&quot;&gt;
        &lt;source src=&quot;成都.ogg&quot; type='audio/ogg&quot;'&gt;
    &lt;/audio&gt;
</code></pre></div> <p><strong>脚本化（js控制）</strong></p> <div class="tip custom-block"><p class="custom-block-title">获取、创建标签</p> <pre><code>var audio = document.getElementById('audio'); //video也可以用  
var audio = new Audio('./laojie.mp3');   //video没有构造函数，不可以用这种方法  
var audio = document.createElement('video'); //video也可以用
</code></pre></div> <div class="tip custom-block"><p class="custom-block-title">设置属性</p> <p>可以用setAttribute和. 属性名两种方法
<img src="/H5/video1.png" alt="video1" style="margin:10px auto"></p> <p>audio．volume 表示播放音量，介于0(静音)~1(最大音量)之间，默认1。<br>
audio．muted 将muted属性设置为true则会进入静音模式，设置为false则会恢复之前指定的音量继续播放。
audio．playbackRate 用于指定媒体播放的速度。该属性值为1.0表示正常速度，大于1则表示”快进”，0~1之间表示”慢放&quot;，负值表示回放。每个浏览器实现的会有差别，具体看浏览器实现。（可以实现快进和慢放）<br>
audio．currentTime 设置或返回音频/视频播放的当前位置 单位 秒<br> <img src="/H5/video2.png" alt="video2" style="margin:10px auto"></p> <p>audio．duration 返回当前音频/视频的时长(window.onload) 单位 秒<br> <img src="/H5/video3.png" alt="video3" style="margin:10px auto"></p> <p>audio．played 属性返回已经播放(看过)的时间段，<br>
audio．buffered 属性返回当前已经缓冲的时间段，<br>
audio．seekable 属性则返回用户可以跳转的时间段。<br>
这三个属性都是TimeRanges对象，每个对象都有一个length属性以及start()和end()方法，length属性表示当前的一个时间段，start()与
end()分别返回当前时间段的起始时间点和结束时间点(单位是秒，起始参数是0)应用: 确定当前缓存内容的百分比
<img src="/H5/video4.png" alt="video4" style="margin:10px auto"></p> <p>audio．paused 为true表示播放器暂停。<br>
audio．seeking 为true表示播放器正在调到一个新的播放点，<br>
audio．ended 如果播放器播放完媒体并且停下来，则ended属性为true。<br>
应用: 通过这几个属性可以把播放暂停按钮设置为一个</p></div> <div class="tip custom-block"><p class="custom-block-title">方法</p> <p>audio．play() 方法<br>
audio．pause() 方法<br>
audio．load()方法 重新加载视音频，用于在更改来源或其他设置后对音视频元素进行更新<br>
audio．canPlayType() 判断浏览器是否支持该格式<br> <img src="/H5/video5.png" alt="video5" style="margin:10px auto"></p></div> <div class="tip custom-block"><p class="custom-block-title">常用事件（其它可以看具体教程）</p> <p>play 开始播放触发<br>
pause 暂停触发<br>
loadedmetadata 浏览器获取完媒体的元数据触发<br>
loadeddata 浏览器已经加载完当前帧数据，准备播放时触发，注意IE8<br>
ended 当前播放结束后触发</p></div> <img src="/H5/video6.png" alt="video6" style="margin:10px auto"> <h2 id="requestanimationframe"><a href="#requestanimationframe" aria-hidden="true" class="header-anchor">#</a> requestAnimationFrame</h2> <p>requestAnimationFrame：用法和 setTimeout类似，但是不用设置时间页面刷新前执行一次<br>
1000ms 60fps(1000ms刷新60次) ，即 每16ms刷新一次</p> <pre><code>cancelAnimationFrame（清除requestAnimationFrame）
</code></pre> <img src="/H5/requestAnimationFrame.png" alt="requestAnimationFrame" style="margin:10px auto"> <p>兼容性写法</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code>requestAnimationFrame兼容性写法：
window<span class="token punctuation">.</span>requestAnimFrame <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>requestAnimationFrame <span class="token operator">||</span>
  window<span class="token punctuation">.</span>webkitRequestAnimationFrame <span class="token operator">||</span>
  window<span class="token punctuation">.</span>mozRequestAnimationFrame <span class="token operator">||</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span> callback <span class="token punctuation">)</span><span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cancelAnimationFrame兼容性写法：
window<span class="token punctuation">.</span>cancelAnimFrame <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>cancelAnimationFrame <span class="token operator">||</span>
  window<span class="token punctuation">.</span>webkitCancelAnimationFrame <span class="token operator">||</span>
  window<span class="token punctuation">.</span>mozCancelAnimationFrame <span class="token operator">||</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="客户端存储"><a href="#客户端存储" aria-hidden="true" class="header-anchor">#</a> 客户端存储</h2> <div class="tip custom-block"><p class="custom-block-title">客户端存储方法</p> <p>Storage： 不会传到服务器<br>
Cookie：存储量小4k，每次网络请求都要将cookie发送后台影响性能，</p></div> <p><strong>storage</strong>
用法：localStroage、sessionStroage用法一样<br>
存储方式:</p> <pre><code>localStorage.name = 'aimee'
localStorage自动调用tostring方法，所以传数组直接变成字符串，不能传对象，要传对象就要转成json格式。
localStorage.info = JSON.stringify({name:'aimee,company: 'duyi’})
</code></pre> <p>读取方式：</p> <pre><code>localStrorage.name
JSON.parse(localStorage.info)
</code></pre> <p>存储有效期</p> <pre><code>localStorage-&gt;永久的，除非手动删除
sessionStorage-&gt;临时，窗口关闭就没有了
</code></pre> <p>存储作用域</p> <pre><code>localStorage-&gt;文档源限制
sessionStorage-&gt;文档源限制+窗口
</code></pre> <p>属性</p> <pre><code>localStorage. setItem(name,val) 设置属性值
localStorage. getItem(name) 获得属性值
localStorage. removeItem(name) 移除属性
localStorage. clear() 清除属性
</code></pre> <p>Cookie和storage的区别<br> <img src="/H5/Storage.png" alt="Storage" style="margin:10px auto"></p> <h2 id="历史记录"><a href="#历史记录" aria-hidden="true" class="header-anchor">#</a> 历史记录</h2> <div class="tip custom-block"><p class="custom-block-title">History老对象方法：</p> <p>history.back() 回退到上一次历史记录<br>
history.forward() 前进一次历史记录<br>
history.go(n) 去到一次历史记录 n可以是正 负</p></div> <div class="tip custom-block"><p class="custom-block-title">History新的方法：</p> <p>pushState → history.pushState(state, title, url); 添加一条历史记录<br>
replaceState → history.replaceState(state, title, url); 替换当前的历史记录<br>
→ state：一个与指定网址相关的状态对象，popstate事件触发时，该对象会传入回调函数中。如果不需要这个对象，此处可以填null。<br>
→ title：新页面的标题，但是所有浏览器目前都忽略这个值，因此这里可以填null。<br>
→ url：新的网址，必须与当前页面处在同一个域。浏览器的地址栏将显示这个网址。</p></div> <div class="tip custom-block"><p class="custom-block-title">History新增的事件</p> <p>popstate 事件 → 历史记录发生改变时触发<br>
调用history.pushState()或者history.replaceState()不会触发popstate事件<br>
hashchange事件 → 当页面的hash值改变的时候触发，常用于构建单页面应用</p></div> <h2 id="worker"><a href="#worker" aria-hidden="true" class="header-anchor">#</a> worker</h2> <ol><li><p>Worker是一种异步执行js的方式</p></li> <li><p>应用<br> <img src="/H5/worker.png" alt="worker" style="margin:10px auto"></p></li> <li><p>结束worker<br>
close() 在worker作用域中调用(worker.js) 副线程上调用<br>
terminate() 在worker对象上调用(主进程的worker对象上 worker.terminate)</p></li> <li><p>importScripts('./math1.js','./math2.js')<br>
worker只是window的子集，只能实现部分功能，不能获取到window, document，所以这里不要引juery zepto。可以引入一些计算类的库。</p></li> <li><p>postMessage跨域<br>
Window.postMessage<br>
Iframe 子页面传递数据给父页面</p></li></ol> <h2 id="filereader读取文件"><a href="#filereader读取文件" aria-hidden="true" class="header-anchor">#</a> FileReader读取文件</h2> <p><em>前言：FileReader是一种异步文件读取机制，结合input:file可以很方便的读取本地文件。</em></p> <div class="tip custom-block"><p class="custom-block-title">input:file</p> <p>input的file类型会渲染为一个按钮和一段文字。点击按钮可打开文件选择窗口，文字表示对文件的描述（大部分情况下为文件名）；file类型的input会有files属性，保存着文件的相关信息。</p></div> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;inputBox&quot;</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>点击按钮上传一个文件后，在控制台打印input.files，如下：<br> <img src="/H5/FileReader2.png" alt="FileReader2" style="margin:10px auto"><br> <img src="/H5/FileReader3.png" alt="FileReader3" style="margin:10px auto"><br>
可以发现input.files是一个数组，由传入的file对象组成。每个file对象包含以下属性：<br>
lastModified：数值，表示最近一次修改时间的毫秒数；<br>
lastModifiedDate：对象，表示最后一次表示最近一次修改时间的Date对象（高程中说是字符串，根据上图可看出应该为对象，为了层级清晰未对其展开，大家可自行查看，其可调用Date对象的有关方法，例如getDay方法）；<br>
name：本地文件系统中的文件名；<br>
size：文件的字节大小；<br>
type：字符串，文件的MIME类型；<br>
weblitRelativePath：此处为空；当在input上加上webkitdirectory属性时，用户可选择文件夹，此时weblitRelativePath表示文件夹中文件的相对路径。比如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;inputBox&quot;</span> webkitdirectory<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>点击按钮添加一个包含3个文件的名为php的文件夹后，控制台打印inputBox.files，如下：
<img src="/H5/FileReader4.png" alt="FileReader4" style="margin:10px auto"> <img src="/H5/FileReader5.png" alt="FileReader5" style="margin:10px auto"><br>
可看出，此时weblitRelativePath表示当前file对象的文件在文件夹中的路径。<br>
以上file对象只获取到了对文件的描述信息，但没有获得文件中的数据，而inputBox.value也只是保存的是文件的绝对路径（这里就不展示了，大家可以自己试一试）。我们可以通过html5提供的FileReader读取到文件中的数据。<br>
首先创建一个FileReader实例：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">方法</p> <p>readAsArrayBuffer(file)	按字节读取文件内容，结果用ArrayBuffer对象表示<br>
readAsBinaryString(file)	按字节读取文件内容，结果为文件的二进制串<br>
readAsDataURL(file)	    读取文件内容，结果用data:url的字符串形式表示<br>
readAsText(file,encoding)	按字符读取文件内容，结果用字符串形式表示<br>
abort()	终止文件读取操作</p></div> <p>readAsDataURL和readAsText较为常用，这里只对这两者进行说明。<br>
readAsDataURL会将文件内容进行base64编码后输出：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> inputBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;inputBox&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
inputBox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>inputBox<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//发起异步请求</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//读取完成后，数据保存在对象的result属性中</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>控制台为当前所传文件的base64编码表示。由于媒体文件的src属性，可以通过采用网络地址或base64的方式显示，因此我们可以利用readAsDataURL实现对图片的预览。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;inputBox&quot;</span> <span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;img&quot;</span><span class="token operator">&gt;</span>


<span class="token keyword">var</span> inputBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;inputBox&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
inputBox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>inputBox<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//发起异步请求</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//读取完成后，将结果赋值给img的src</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>如上，只需将读取的结果赋给图片的src属性，即可预览图片：<br> <img src="/H5/FileReader6.png" alt="FileReader6" style="margin:10px auto"><br>
readAsText(file,encoding)可按指定编码方式读取文件，但读取文件的单位是字符，故对于文本文件，只要按规定的编码方式读取即可；而对于媒体文件（图片、音频、视频），其内部组成并不是按字符排列，故采用readAsText读取，会产生乱码，因此不是最理想的读取文件的方式。</p> <div class="tip custom-block"><p class="custom-block-title">事件</p> <p>onabort	当读取操作被中止时调用
onerror	当读取操作发生错误时调用
onload	当读取操作成功完成时调用
onloadend	当读取操作完成时调用，无论成功或失败
onloadstart	当读取操作开始时调用
onprogress	在读取数据过程中周期性调用</p></div> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> inputBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;inputBox&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
inputBox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>inputBox<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//发起异步请求</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;加载成功&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onloadstart</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;开始加载&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onloadend</span><span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;加载结束&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onprogress</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    count<span class="token operator">++</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;加载中&quot;</span><span class="token operator">+</span>count<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><img src="/H5/FileReader7.png" alt="FileReader7" style="margin:10px auto"> <p>每过50ms左右，就会触发一次progress事件，对于较大的文件可以利用progress实现进度条；onload事件在onloadend之前触发。<br>
由于种种原因无法读取文件时，会触发error事件。触发error事件时，相关信息保存在FileReader对象的error属性中，这个属性将保存一个对象，此对象只有一个属性code，即错误码。1表示未找到文件，2表示安全性错误，3表示读取中断，4表示文件不可读，5表示编码错误。<br>
如果想中断读取过程，可以调用abort方法，就会触发abort事件。<br>
无论触发load，error，abort事件中哪一个，最终都会触发loadend事件。</p> <blockquote><p>file分割文件方法slice<br>
实现分段读取</p></blockquote> <h2 id="websocke"><a href="#websocke" aria-hidden="true" class="header-anchor">#</a> WebSocke</h2> <div class="tip custom-block"><p class="custom-block-title">WebSocket 是什么？</p> <p>WebSocket 是一种网络通信协议。RFC6455 定义了它的通信标准。<br>
WebSocket 是 HTML5 开始提供的一种在单个 TCP 连接上进行全双工通讯的协议。</p></div> <div class="tip custom-block"><p class="custom-block-title">为什么需要 WebSocket ？</p> <p>了解计算机网络协议的人，应该都知道：HTTP 协议是一种无状态的、无连接的、单向的应用层协议。它采用了请求/响应模型。通信请求只能由客户端发起，服务端对请求做出应答处理。<br>
这种通信模型有一个弊端：HTTP 协议无法实现服务器主动向客户端发起消息。<br>
这种单向请求的特点，注定了如果服务器有连续的状态变化，客户端要获知就非常麻烦。大多数 Web 应用程序将通过频繁的异步JavaScript和XML（AJAX）请求实现长轮询。轮询的效率低，非常浪费资源（因为必须不停连接，或者 HTTP 连接始终打开）。<br>
因此，工程师们一直在思考，有没有更好的方法。WebSocket 就是这样发明的。WebSocket 连接允许客户端和服务器之间进行全双工通信，以便任一方都可以通过建立的连接将数据推送到另一端。WebSocket 只需要建立一次连接，就可以一直保持连接状态。这相比于轮询方式的不停建立连接显然效率要大大提高。</p></div> <img src="/H5/websocket1.png" alt="websocket1" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">WebSocket 如何工作？</p> <p>Web浏览器和服务器都必须实现 WebSockets 协议来建立和维护连接。由于 WebSockets 连接长期存在，与典型的HTTP连接不同，对服务器有重要的影响。基于多线程或多进程的服务器无法适用于 WebSockets，因为它旨在打开连接，尽可能快地处理请求，然后关闭连接。任何实际的 WebSockets 服务器端实现都需要一个异步服务器。</p></div> <p><em>在客户端，没有必要为 WebSockets 使用 JavaScript 库。实现 WebSockets 的 Web 浏览器将通过 WebSockets 对象公开所有必需的客户端功能（主要指支持 Html5 的浏览器）。</em><br> <strong>客户端 API</strong><br>
以下 API 用于创建 WebSocket 对象。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> Socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>protocol<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以上代码中的第一个参数 url, 指定连接的 URL。第二个参数 protocol 是可选的，指定了可接受的子协议。</p> <div class="tip custom-block"><p class="custom-block-title">WebSocket 属性</p> <p><em>Socket.readyState</em><br>
只读属性 readyState 表示连接状态，可以是以下值：0 - 表示连接尚未建立。1 - 表示连接已建立，可以进行通信。2 - 表示连接正在进行关闭。3 - 表示连接已经关闭或者连接不能打开。<br> <em>Socket.bufferedAmount</em><br>
只读属性 bufferedAmount 已被 send() 放入正在队列中等待传输，但是还没有发出的 UTF-8 文本字节数。</p></div> <div class="tip custom-block"><p class="custom-block-title">WebSocket 事件</p> <p>open-------Socket.onopen------连接建立时触发<br>
message---Socket.onmessage--客户端接收服务端数据时触发<br>
error-------Socket.onerror-------通信发生错误时触发<br>
close-------Socket.onclose-------连接关闭时触发</p></div> <div class="tip custom-block"><p class="custom-block-title">WebSocket 方法</p> <p>Socket.send()------使用连接发送数据<br>
Socket.close()------关闭连接</p></div> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 初始化一个 WebSocket 对象</span>
<span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;ws://localhost:9998/echo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 建立 web socket 连接成功触发事件</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用 send() 方法发送数据</span>
  ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;发送数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;数据发送中...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 接收服务端数据时触发事件</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> received_msg <span class="token operator">=</span> evt<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;数据已接收...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 断开 web socket 连接成功触发事件</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;连接已关闭...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">WebSocket 服务端</p> <p>WebSocket 在服务端的实现非常丰富。Node.js、Java、C++、Python 等多种语言都有自己的解决方案。<br>
学习node时补充此部分</p></div> <div class="danger custom-block"><p class="custom-block-title">学习移动端时再补充</p> <p>geolocation
devicemotion
deviceorientation</p></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.6a253733.js" defer></script><script src="/assets/js/14.ef8b2dda.js" defer></script>
  </body>
</html>
