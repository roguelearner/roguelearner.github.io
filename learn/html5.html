<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTML5å­¦ä¹ ç¬”è®° ğŸ“‘ | Make Innovations</title>
    <meta name="description" content=" ">
    <link rel="icon" href="/bob.png">
    
    <link rel="preload" href="/assets/css/0.styles.522f73f5.css" as="style"><link rel="preload" href="/assets/js/app.6a253733.js" as="script"><link rel="preload" href="/assets/js/14.ef8b2dda.js" as="script"><link rel="prefetch" href="/assets/js/10.e3b3ae83.js"><link rel="prefetch" href="/assets/js/11.1743e1e9.js"><link rel="prefetch" href="/assets/js/12.e2a2f476.js"><link rel="prefetch" href="/assets/js/13.8cab6c69.js"><link rel="prefetch" href="/assets/js/15.fb2d2713.js"><link rel="prefetch" href="/assets/js/16.7983a61f.js"><link rel="prefetch" href="/assets/js/17.dec508bf.js"><link rel="prefetch" href="/assets/js/18.db1c2439.js"><link rel="prefetch" href="/assets/js/19.5aa44128.js"><link rel="prefetch" href="/assets/js/2.f32d8142.js"><link rel="prefetch" href="/assets/js/20.b6a814c1.js"><link rel="prefetch" href="/assets/js/21.4f2dad75.js"><link rel="prefetch" href="/assets/js/3.ab30b814.js"><link rel="prefetch" href="/assets/js/4.99255317.js"><link rel="prefetch" href="/assets/js/5.871beb45.js"><link rel="prefetch" href="/assets/js/6.dd899a8f.js"><link rel="prefetch" href="/assets/js/7.ca4fe73c.js"><link rel="prefetch" href="/assets/js/8.7399e17f.js"><link rel="prefetch" href="/assets/js/9.3dabbb14.js">
    <link rel="stylesheet" href="/assets/css/0.styles.522f73f5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Make Innovations</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">ä¸»é¡µ</a></div><div class="nav-item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">åˆ†äº«</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fenxiang/blog.html" class="nav-link">å¤§ç¥åšå®¢</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/wenzhang.html" class="nav-link">æŠ€æœ¯æ–‡ç« </a></li><li class="dropdown-item"><!----> <a href="/fenxiang/gistfile.html" class="nav-link">Emojiè¡¨æƒ…</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/ziyuan.html" class="nav-link">èµ„æº</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">å­¦ä¹ </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å‰ç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/html5.html" class="nav-link router-link-exact-active router-link-active">HTML5</a></li><li class="dropdown-subitem"><a href="/learn/css3.html" class="nav-link">CSS3</a></li><li class="dropdown-subitem"><a href="/learn/js.html" class="nav-link">js</a></li><li class="dropdown-subitem"><a href="/learn/jQuery.html" class="nav-link">jQuery</a></li><li class="dropdown-subitem"><a href="/learn/ES6.html" class="nav-link">ES6</a></li><li class="dropdown-subitem"><a href="/learn/webpack.html" class="nav-link">webpack</a></li><li class="dropdown-subitem"><a href="/learn/wangluo.html" class="nav-link">ç½‘ç»œ</a></li><li class="dropdown-subitem"><a href="/learn/git.html" class="nav-link">git</a></li><li class="dropdown-subitem"><a href="/learn/vue.html" class="nav-link">vue</a></li></ul></li><li class="dropdown-item"><h4>åç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/node.html" class="nav-link">node</a></li><li class="dropdown-subitem"><a href="/learn/MySQL.html" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/learn/MongoDB.html" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">å…³äº</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">ä¸»é¡µ</a></div><div class="nav-item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">åˆ†äº«</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fenxiang/blog.html" class="nav-link">å¤§ç¥åšå®¢</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/wenzhang.html" class="nav-link">æŠ€æœ¯æ–‡ç« </a></li><li class="dropdown-item"><!----> <a href="/fenxiang/gistfile.html" class="nav-link">Emojiè¡¨æƒ…</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/ziyuan.html" class="nav-link">èµ„æº</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">å­¦ä¹ </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å‰ç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/html5.html" class="nav-link router-link-exact-active router-link-active">HTML5</a></li><li class="dropdown-subitem"><a href="/learn/css3.html" class="nav-link">CSS3</a></li><li class="dropdown-subitem"><a href="/learn/js.html" class="nav-link">js</a></li><li class="dropdown-subitem"><a href="/learn/jQuery.html" class="nav-link">jQuery</a></li><li class="dropdown-subitem"><a href="/learn/ES6.html" class="nav-link">ES6</a></li><li class="dropdown-subitem"><a href="/learn/webpack.html" class="nav-link">webpack</a></li><li class="dropdown-subitem"><a href="/learn/wangluo.html" class="nav-link">ç½‘ç»œ</a></li><li class="dropdown-subitem"><a href="/learn/git.html" class="nav-link">git</a></li><li class="dropdown-subitem"><a href="/learn/vue.html" class="nav-link">vue</a></li></ul></li><li class="dropdown-item"><h4>åç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/node.html" class="nav-link">node</a></li><li class="dropdown-subitem"><a href="/learn/MySQL.html" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/learn/MongoDB.html" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">å…³äº</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>HTML5å­¦ä¹ ç¬”è®° ğŸ“‘</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/learn/html5.html#html5æ–°å¢æ ‡ç­¾" class="sidebar-link">HTML5æ–°å¢æ ‡ç­¾</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#html5æ–°å¢å±æ€§" class="sidebar-link">HTML5æ–°å¢å±æ€§</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#æ‹–æ”¾" class="sidebar-link">æ‹–æ”¾</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#canvasç”»å¸ƒ" class="sidebar-link">canvasç”»å¸ƒ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#svgçŸ¢é‡å›¾" class="sidebar-link">SVGçŸ¢é‡å›¾</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#audio-éŸ³é¢‘å’Œvideoè§†é¢‘" class="sidebar-link">Audio éŸ³é¢‘å’Œvideoè§†é¢‘</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#requestanimationframe" class="sidebar-link">requestAnimationFrame</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#å®¢æˆ·ç«¯å­˜å‚¨" class="sidebar-link">å®¢æˆ·ç«¯å­˜å‚¨</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#å†å²è®°å½•" class="sidebar-link">å†å²è®°å½•</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#worker" class="sidebar-link">worker</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#filereaderè¯»å–æ–‡ä»¶" class="sidebar-link">FileReaderè¯»å–æ–‡ä»¶</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/html5.html#websocke" class="sidebar-link">WebSocke</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="html5å­¦ä¹ ç¬”è®°"><a href="#html5å­¦ä¹ ç¬”è®°" aria-hidden="true" class="header-anchor">#</a> HTML5å­¦ä¹ ç¬”è®° ğŸ“‘</h1> <h2 id="html5æ–°å¢æ ‡ç­¾"><a href="#html5æ–°å¢æ ‡ç­¾" aria-hidden="true" class="header-anchor">#</a> HTML5æ–°å¢æ ‡ç­¾</h2> <p>1.Headerã€Footerã€Articleï¼ˆdivï¼‰ã€Sectionï¼ˆpï¼‰ã€Navã€Asideè¿™å…­ä¸ªæ ‡ç­¾åªæ˜¯ä¸ºäº†è¯­ä¹‰åŒ–æ›´å¥½ï¼ŒåŠŸèƒ½ç±»ä¼¼divï¼ŒSectionæ›´åƒpæ ‡ç­¾<br>
2.Svg ã€Canvasæ˜¯ç»˜å›¾æ ‡ç­¾<br>
3.Audioã€VideoéŸ³é¢‘ä¸è§†é¢‘æ ‡ç­¾<br>
4.è‡ªå®šä¹‰æ ‡ç­¾: è¡Œçº§å…ƒç´ </p> <h2 id="html5æ–°å¢å±æ€§"><a href="#html5æ–°å¢å±æ€§" aria-hidden="true" class="header-anchor">#</a> HTML5æ–°å¢å±æ€§</h2> <p>1.Contenteditableï¼šè§„å®šå…ƒç´ å†…å®¹æ˜¯å¦å¯ç¼–è¾‘ã€‚å¦‚æœå…ƒç´ æœªè®¾ç½® contenteditable å±æ€§ï¼Œé‚£ä¹ˆå…ƒç´ ä¼šä»å…¶çˆ¶å…ƒç´ ç»§æ‰¿è¯¥å±æ€§ã€‚</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>div contenteditable<span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">&gt;</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.Draggable ï¼šdomå…ƒç´ æ˜¯å¦å¯æ‹–æ‹½</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>div draggable<span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">&gt;</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.Hidden ï¼šdomå…ƒç´ éšè—ï¼Œå°±æ˜¯é displayï¼šnoneå®ç°çš„</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>div hidden<span class="token operator">&gt;</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4.Contextmenu  ä¸ºå…ƒç´ è®¾å®šå¿«æ·èœå•ï¼ˆç›®å‰æ— æµè§ˆå™¨æ”¯æŒ contextmenu å±æ€§ã€‚ ï¼‰
5.data-val è‡ªå®šä¹‰å±æ€§:åªèƒ½é€šè¿‡getAttributeæ¥è·å–è‡ªå®šä¹‰å±æ€§</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div data<span class="token operator">-</span>my<span class="token operator">=</span><span class="token string">&quot;asd&quot;</span><span class="token operator">&gt;</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dataval <span class="token operator">=</span> div<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-my'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataval<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="æ‹–æ”¾"><a href="#æ‹–æ”¾" aria-hidden="true" class="header-anchor">#</a> æ‹–æ”¾</h2> <div class="tip custom-block"><p class="custom-block-title">å±æ€§</p> <p>draggableï¼š auto | true | false</p></div> <div class="tip custom-block"><p class="custom-block-title">æ‹–åŠ¨äº‹ä»¶</p> <p>dragstart â†’ åœ¨å…ƒç´ å¼€å§‹è¢«æ‹–åŠ¨æ—¶è§¦å‘<br>
dragen â†’ åœ¨æ‹–åŠ¨æ“ä½œå®Œæˆæ—¶è§¦å‘<br>
drag â†’ åœ¨å…ƒç´ è¢«æ‹–åŠ¨æ—¶è§¦å‘</p></div> <div class="tip custom-block"><p class="custom-block-title">é‡Šæ”¾åŒºäº‹ä»¶ï¼š</p> <p>dragenter â†’ è¢«æ‹–åŠ¨å…ƒç´ è¿›å…¥åˆ°é‡Šæ”¾åŒºæ‰€å æ®å¾—å±å¹•ç©ºé—´æ—¶è§¦å‘<br>
dragover â†’ å½“è¢«æ‹–åŠ¨å…ƒç´ åœ¨é‡Šæ”¾åŒºå†…ç§»åŠ¨æ—¶è§¦å‘ï¼ˆé»˜è®¤äº‹ä»¶ä¼šé˜»æ­¢dropäº‹ä»¶ï¼‰<br>
dragleave â†’ å½“è¢«æ‹–åŠ¨å…ƒç´ æ²¡æœ‰æ”¾ä¸‹å°±ç¦»å¼€é‡Šæ”¾åŒºæ—¶è§¦å‘<br>
drop â†’ å½“è¢«æ‹–åŠ¨å…ƒç´ åœ¨é‡Šæ”¾åŒºé‡Œæ”¾ä¸‹æ—¶è§¦å‘</p></div> <p>é€šè¿‡e.targetè·å–è¢«æ‹–æ‹½çš„domå…ƒç´ ï¼Œä»è€Œå®ç°å¯¹domçš„æ“ä½œ</p> <div class="tip custom-block"><p class="custom-block-title">dataTransfer</p> <p>è¿”å›ç”¨äºä¼ è¾“æ•°æ®åˆ°é‡Šæ”¾åŒºçš„å¯¹è±¡---å°±æ˜¯dragstartä¼ å‡ºæ•°æ®ï¼Œåˆ°dropé‡Œæ‰èƒ½å–æ•°æ®</p></div> <img src="/H5/drag.png" alt="drag" style="margin:10px auto"> <pre><code>â‘ ä¼ å€¼
    e.dataTransfer.setData(&quot;data&quot;,e.target.id)
    æ‹–æ‹½äº‹ä»¶æ—¶ï¼Œä¼ å€¼ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯â€œåâ€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å€¼ï¼ˆå¯ä»¥ä¼ idå€¼ï¼Œä»è€Œå®ç°DOMç»“æ„çš„æ”¹å˜ï¼‰ã€‚
â‘¡å–å€¼
    e.dataTransfer.getData(&quot;data&quot;)
    æŸ¥çœ‹ä¼ çš„å€¼ã€‚
</code></pre> <p><strong>ä½¿ç”¨æ‹–æ‹½ä¸Šä¼ æ–‡ä»¶</strong><br>
ä¸Šä¼ æ–‡ä»¶</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br><br></div><pre class="language-js"><code>ele<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'dragover'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å–æ¶ˆé»˜è®¤äº‹ä»¶ï¼Œdropæ‰èƒ½è§¦å‘ã€‚</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ele<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'drop'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è°ƒç”¨ preventDefault() æ¥é¿å…æµè§ˆå™¨å¯¹æ•°æ®çš„é»˜è®¤å¤„ç†ï¼ˆdrop äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºæ˜¯ä»¥é“¾æ¥å½¢å¼æ‰“å¼€ï¼‰</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">var</span> dt <span class="token operator">=</span> e<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">;</span>
    <span class="token keyword">var</span> files <span class="token operator">=</span> dt<span class="token punctuation">.</span>files<span class="token punctuation">;</span><span class="token comment">//å–åˆ°è¢«æ‹–æ‹½å…ƒç´ çš„ä¿¡æ¯ã€‚</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>FileReader ç”¨äºè¯»å–æ–‡ä»¶ï¼šabort() ç»ˆæ­¢è¯»å–</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token comment">//é€šè¿‡ä¸åŒçš„æ–¹å¼è¯»å–æ–‡ä»¶  </span>
<span class="token function">readAsBinaryString</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶ç¼–ç 
<span class="token function">readAsDataURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> å°†æ–‡ä»¶è¯»å–ä¸ºDataURLç¼–ç 
<span class="token function">readAsText</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token punctuation">[</span>encoding<span class="token punctuation">]</span><span class="token punctuation">)</span> å°†æ–‡ä»¶è¯»å–ä¸ºæ–‡æœ¬
<span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> å°†æ–‡ä»¶è¯»å–ä¸ºarraybuffer

<span class="token comment">//è¯»å–ä¸­çš„äº‹ä»¶</span>
onloadstart è¯»å–å¼€å§‹æ—¶è§¦å‘
onprogress è¯»å–ä¸­
onloadend è¯»å–å®Œæˆè§¦å‘ï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥
onload æ–‡ä»¶è¯»å–æˆåŠŸå®Œæˆæ—¶è§¦å‘
onabort ä¸­æ–­æ—¶è§¦å‘
onerror å‡ºé”™æ—¶è§¦å‘
è·å–è¯»å–çš„ç»“æœ
fr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
<span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="canvasç”»å¸ƒ"><a href="#canvasç”»å¸ƒ" aria-hidden="true" class="header-anchor">#</a> canvasç”»å¸ƒ</h2> <div class="tip custom-block"><p class="custom-block-title">Canvasåº”ç”¨åœºæ™¯</p> <p>æ¸¸æˆã€å›¾è¡¨<a href="https://echarts.baidu.com/" target="_blank" rel="noopener noreferrer">https://echarts.baidu.com/)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€åŠ¨ç”»ã€HTML5 åŠ¨æ•ˆ<a href="https://codepen.io/" target="_blank" rel="noopener noreferrer">https://codepen.io/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <p>åˆå§‹åŒ–</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> åˆ›å»ºç”»å¸ƒ <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>canvas id<span class="token operator">=</span><span class="token string">&quot;canv&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;300&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;300&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;border:1px solid black;&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">const</span> oCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canv'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°ç”»å¸ƒ</span>
    <span class="token keyword">const</span> oPen <span class="token operator">=</span> oCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°ç”»ç¬” </span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">è®¾ç½®ç”»å¸ƒå®½é«˜æ³¨æ„äº‹é¡¹</p> <p>Canvaså…ƒç´ é»˜è®¤å®½ 300px, é«˜ 150px, è®¾ç½®å…¶å®½é«˜å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š
æ–¹æ³•ä¸€ï¼š</p> <pre><code>&lt;canvas width=&quot;500&quot; height=&quot;500&quot;&gt;&lt;/canvas&gt;
</code></pre> <p>æ–¹æ³•äºŒï¼š</p> <pre><code>var canvas = document.getElementById('æ¬²æ“ä½œcanvasçš„id');
canvas.width = 500;
canvas.height = 500;
</code></pre> <p>è‹¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•è®¾ç½®å®½é«˜ï¼Œé‚£ä¹ˆCanvaså…ƒç´ å°†ç”±åŸæ¥å¤§å°è¢«æ‹‰ä¼¸åˆ°æ‰€è®¾ç½®çš„å®½é«˜ï¼š
æ–¹æ³•ä¸€ï¼šä½¿ç”¨CSS ä¼šè¢«æ‹‰ä¼¸</p> <pre><code>#æ¬²æ“ä½œcanvasçš„idï½›
    width:1000px;
height:1000px;
ï½
</code></pre> <p>ä¹ŸåŒ…å«äº†è¡Œé—´æ ·å¼ä¸­çš„ style=&quot;&quot; ã€‚ä¹Ÿå°±æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œä¹Ÿä¼šäº§ç”Ÿæ‹‰ä¼¸çš„æƒ…å†µã€‚
æ–¹æ³•äºŒï¼šä½¿ç”¨HTML5 Canvas APIæ“ä½œ ä¼šè¢«æ‹‰ä¼¸</p> <pre><code>var canvas = document.getElementById('æ¬²æ“ä½œcanvasçš„id');
canvas.style.width = &quot;1000px&quot;;
canvas.style.height = &quot;1000px&quot;;
</code></pre> <p>æ–¹æ³•ä¸‰ ï¼šç”¨jqueryçš„$(&quot;#id&quot;).width(500);ä¼šè¢«æ‹‰ä¼¸
å…¶å®ƒï¼šcanvasçš„widthå’Œheightä¹Ÿä¸èƒ½ç”¨ç™¾åˆ†æ¯”è¡¨ç¤ºã€‚canvasä¼šå°†ç™¾åˆ†å€¼å½“æˆæ•°å€¼æ˜¾ç¤º</p></div> <div class="tip custom-block"><p class="custom-block-title">ç»˜åˆ¶çº¿æ®µ</p> <p>oPen.moveTo(x, y);  ç§»åŠ¨åˆ° xï¼Œyåæ ‡ç‚¹ï¼ˆç”»ç¬”çš„èµ·å§‹ç‚¹ï¼‰<br>
oPen.lineTo(x, y); ä»å½“å‰ç‚¹ç»˜åˆ¶ç›´çº¿åˆ°xï¼Œyç‚¹ï¼ˆç”»ç¬”æƒ³ç§»åŠ¨åˆ°å“ªä¸€ç‚¹ï¼‰<br>
oPen.lineWidth  = 20; è®¾ç½®çº¿æ®µå®½åº¦ï¼ˆç”»ç¬”ç²—ç»†ï¼‰<br>
oPen.closePath();  é—­åˆå½“å‰è·¯å¾„  å’Œå›åˆ°èµ·å§‹ç‚¹çš„åŒºåˆ«<br>
oPen.fill();  å¡«å……<br>
oPen.stroke();  æè¾¹ï¼ˆæŒ‰ç…§è·¯å¾„ç§»åŠ¨ç”»ç¬”ï¼Œæ˜¯æ¸²æŸ“é¡µé¢ï¼Œå¿…é¡»åœ¨ä¸€æ®µçº¿ç”»å®Œåå†å†™ï¼Œå³ä¸Šé¢çš„æ–¹æ³•åº”è¯¥éƒ½åœ¨è¿™ä¸ªæ–¹æ³•å‰å†™ï¼‰<br>
oPen.beginPath() å®Œæˆä¸€æ¡è·¯å¾„åè¦é‡æ–°å¼€å§‹å¦ä¸€æ¡è·¯å¾„æ—¶å¿…é¡»ä½¿ç”¨beginPath()æ–¹æ³•</p></div> <div class="tip custom-block"><p class="custom-block-title">ç»˜åˆ¶çŸ©å½¢</p> <p>ctx.rect(x, y, dx, dy) x y æ˜¯ç”»çŸ©å½¢çš„èµ·å§‹ç‚¹ï¼Œæ˜¯çŸ©å½¢çš„å·¦ä¸Šè§’ï¼Œdx dyæ˜¯å®½é«˜ï¼Œ<br>
ctx.fillRect(x, y, dx, dy) å‚æ•°ä¸ä¸Šé¢çš„æ„ä¹‰ä¸€æ ·ï¼Œå°±æ˜¯è¿™æ–¹æ³•ç›´æ¥å¡«å……<br>
ctx.strokeRect(x, y, w, h) å‚æ•°ä¸ä¸Šé¢çš„æ„ä¹‰ä¸€æ ·ï¼Œå°±æ˜¯è¿™æ–¹æ³•ç›´æ¥æè¾¹<br>
ctx.clearRect(x, y, dx, dy) å‚æ•°ä¸ä¸Šé¢çš„æ„ä¹‰ä¸€æ ·ï¼Œç›¸å½“äºæ©¡çš®ï¼Œæ“¦é™¤çŸ©å½¢;</p></div> <div class="tip custom-block"><p class="custom-block-title">ç»˜åˆ¶å¼§å½¢</p> <p>ctx.arc(x, y, r, èµ·å§‹è§’åº¦, ç»“æŸè§’åº¦, å¼§å½¢çš„æ–¹å‘ ) x y æ˜¯åœ†å¿ƒï¼Œræ˜¯åŠå¾„ï¼Œæ–¹å‘æ˜¯--&gt; 0é¡ºæ—¶é’ˆ 1é€†æ—¶é’ˆ åº¦æ•°ä½¿ç”¨------&gt;2 * Math.PI = 360åº¦</p></div> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> oCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canv'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°ç”»å¸ƒ</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> oCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°ç”»ç¬”</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»˜åˆ¶èµ·å§‹ç‚¹ï¼Œä¾¿äºæ§åˆ¶å›¾å½¢é—­åˆ</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»˜åˆ¶100ã€120è‡³100ã€200è¿™æ¡çº¿å’Œ100ã€200è‡³200ã€200è¿™æ¡çº¿çš„åœ†è§’</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»˜åˆ¶100ã€200è‡³200ã€200è¿™æ¡çº¿å’Œ200ã€200è‡³200ã€100è¿™æ¡çº¿çš„åœ†è§’</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ctx.arcTo(100,200,200,200,20);//å¦‚æœä¸ç”¨movetoï¼Œç”¨è¿™ä¸ªå›¾å½¢éš¾ä»¥é—­åˆ </span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">è´å¡å°”æ›²çº¿</p> <p>ctx.quadraticCurveTo(x1, y1,ex,ey ) äºŒæ¬¡è´å¡å°”æ›²çº¿       x1,y1 æ§åˆ¶ç‚¹       ex,ey ç»“æŸç‚¹<br>
ctx.bezierCurveTo(x1, y1, x2, y2, ex, ey) ä¸‰æ¬¡è´å¡å°”æ›²çº¿      x1,y1ï¼Œx2,y2 æ§åˆ¶ç‚¹      ex,ey ç»“æŸç‚¹</p></div> <div class="tip custom-block"><p class="custom-block-title">åæ ‡è½´è½¬æ¢</p> <p>ctx.translate(dx, dy)   é‡æ–°æ˜ å°„ç”»å¸ƒä¸Šçš„ (0,0)åæ ‡ä½ç½®<br>
ctx.scale(sx, sy)   ç¼©æ”¾å½“å‰ç»˜å›¾<br>
ctx. rotate(Math.PI)    æ—‹è½¬å½“å‰çš„ç»˜å›¾<br>
ctx.save() restore()        ä¿å­˜å½“å‰å›¾åƒçŠ¶æ€çš„ä¸€ä»½æ‹·è´(ä¿å­˜ç”»å¸ƒçŠ¶æ€ï¼‰      ä»æ ˆä¸­å¼¹å‡ºå­˜å‚¨çš„å›¾å½¢çŠ¶æ€å¹¶æ¢å¤<br>
ctx. setTransform(a, b, c, d, e, f) å…ˆé‡ç½®å†å˜æ¢      å‚æ•°ï¼šæ°´å¹³ç¼©æ”¾ã€æ°´å¹³å€¾æ–œã€å‚ç›´å€¾æ–œã€å‚ç›´ç¼©æ”¾ã€æ°´å¹³ç§»åŠ¨ã€å‚ç›´ç§»åŠ¨<br>
ctx.transform(a, b, c, d, e, f) åœ¨ä¹‹å‰çš„åŸºç¡€ä¸Šå˜æ¢</p></div> <div class="tip custom-block"><p class="custom-block-title">å¡«å……å›¾æ¡ˆ</p> <p>ctx.createPattern(image,&quot;repeat|repeat-x|repeat-y|no-repeat&quot;) ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥å¡«å†™ï¼šimgå…ƒç´ ï¼ˆImageå¯¹è±¡ï¼‰ï¼Œcanvaså…ƒç´ ï¼Œvideoå…ƒç´ (æœ‰å›¾å½¢çš„) ç¬¬äºŒä¸ªå‚æ•°å…³äºé‡å¤çš„è®¾ç½®<br>
å¡«å……çš„å›¾æ¡ˆæ²¡æœ‰å®šä½</p></div> <img src="/H5/canvas1.png" alt="canvas1" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">æ¸å˜</p> <p>ctx.createLinearGradient(x1, y1, x2, y2); çº¿æ€§æ¸å˜ å¿…é¡»åœ¨å¡«å……æ¸å˜çš„åŒºåŸŸï§©å®šä¹‰æ¸å˜, å¦åˆ™ æ²¡æœ‰æ•ˆæœ x1, y1 èµ·å§‹ç‚¹ x2, y2ç»ˆæ­¢ç‚¹<br>
ctx.createRadialGradient(x1, y1, r1, x2, y2, r2); å¾„å‘æ¸å˜<br>
bg.addColorStop(p, color) ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç™¾åˆ†æ¯”ä»0 - 1 ç¬¬äºŒä¸ªå‚æ•°æ˜¯é¢œè‰²</p></div> <div class="tip custom-block"><p class="custom-block-title">é˜´å½±</p> <p>ctx.shadowColor é˜´å½±é¢œè‰²<br>
ctx.shadowOffsetX é˜´å½±æ°´å¹³åç§»é‡<br>
ctx.shadowOffsetY é˜´å½±å‚ç›´åç§»é‡<br>
ctx.shadowBlur é˜´å½±æ¨¡ç³ŠåŠå¾„<br>
æ³¨ï¼šè¿™é‡Œçš„é˜´å½±åç§»é‡ä¸å—åæ ‡ç³»å˜æ¢çš„å½±å“</p></div> <img src="/H5/canvas2.png" alt="canvas2" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">æ–‡æœ¬</p> <p>ctx.fillText()<br>
ctx.strokeText()<br>
ctx.measureText('hello world') äº†è§£</p></div> <img src="/H5/canvas3.png" alt="canvas3" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">çº¿æ®µæ ·å¼</p> <p>1.lineCap<br>
2.lineJoin<br>
ctx.miterLimit å½“lineJoinæ˜¯miteræ—¶ï¼Œç”¨äºæ§åˆ¶æ–œæ¥éƒ¨åˆ†çš„é•¿åº¦ å¦‚æœæ–œæ¥é•¿åº¦è¶…è¿‡ miterLimit çš„å€¼ï¼Œå˜æˆbevel æ³¨:å®é™…è¿ç®—æ˜¯å¤§äºlimit*lineWidth/2çš„å€¼ï¼Œï¦ºè§£å°±å¥½</p></div> <img src="/H5/canvas4.png" alt="canvas4" style="margin:10px auto"> <img src="/H5/canvas5.png" alt="canvas5" style="margin:10px auto"> <img src="/H5/canvas6.png" alt="canvas6" style="margin:10px auto"> <img src="/H5/canvas7.png" alt="canvas7" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">è£å‰ª</p> <p>ctx.clip()ï¼›å½“å‰è·¯å¾„å¤–çš„åŒºåŸŸä¸å†ç»˜åˆ¶ è£å‰ªçš„æ˜¯ç”»å¸ƒ<br>
æ³¨ï¼šå¯åœ¨clip() å‰ç”¨ save() æ–¹æ³•ä¿å­˜ï¼Œåç»­é€šè¿‡ restore() æ–¹æ³•æ¢å¤</p></div> <img src="/H5/canvas8.png" alt="canvas8" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">åˆæˆ</p> <p>ctx.globalCompositeOperation = 'source-over' æ–°åƒç´ å’ŒåŸåƒç´ çš„åˆå¹¶æ–¹å¼<br>
11ç§å€¼  é»˜è®¤ source-over w3cæ ‡å‡† å¸¸ç”¨ source-over, destination-over, copy</p></div> <img src="/H5/canvas9.png" alt="canvas9" style="margin:10px auto"> <img src="/H5/canvas10.png" alt="canvas10" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">å…¨å±€é€æ˜åº¦</p> <p>ctx.globalAlpha = '0.5'; åªèƒ½ä½œç”¨åˆ°è¿™ä¸ªæ–¹æ³•ä¸‹é¢çš„å…ƒç´ </p></div> <div class="tip custom-block"><p class="custom-block-title">ç»˜åˆ¶å›¾ç‰‡</p> <p>ctx.drawImage();   ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯(Imageæˆ– canvas) æ³¨ï¼šonloadæ³¨æ„è¦å…¨éƒ¨åŠ è½½å®Œ<br>
å†™3ä¸ªå‚æ•°æ—¶  (x, y) èµ·å§‹ç‚¹åæ ‡<br>
å†™5ä¸ªå‚æ•° (x, y, dx, dx)      èµ·å§‹ç‚¹åæ ‡åŠå›¾ç‰‡æ‰€å­˜åŒºåŸŸçš„å®½é«˜<br>
å†™9ä¸ªå‚æ•° (x1, y1, dx1, dy1, x2, y2, w2, h2)      å‰å››ä¸ªä¸ºæ‰€ç»˜åˆ¶ç›®æ ‡å…ƒç´ <br>
çš„èµ·å§‹ç‚¹å’Œå®½é«˜ï¼ˆå°±æ˜¯æˆªå–å›¾ç‰‡çš„å“ªä¸€éƒ¨åˆ†ç”¨æ¥å±•ç¤ºï¼‰ åå››ä¸ªä¸ºcanvas<br>
ç»˜åˆ¶çš„èµ·å§‹ç‚¹å’Œå¤§å°ï¼ˆä¸5ä¸ªå‚æ•°çš„åå››ä¸ªä¸€æ ·ï¼‰</p></div> <div class="tip custom-block"><p class="custom-block-title">å°†canvaså†…å®¹å¯¼å‡º</p> <p>canvas.toDataURL() ; æ˜¯canvasè‡ªèº«çš„æ–¹æ³•ä¸æ˜¯(ctx)ä¸Šä¸‹æ–‡å¯¹è±¡<br>
å°†canvasçš„å†…å®¹æŠ½å–æˆâ¼€å¼ å›¾ç‰‡, base64ç¼–ç æ ¼å¼<br>
æ³¨ï¼šåŒæºç­–ç•¥çš„é™åˆ¶ï¼ˆå¼€å¯æœåŠ¡å™¨ï¼‰<br>
å°†canvasçš„å†…å®¹æ”¾å…¥imgå…ƒç´ é‡Œ</p></div> <img src="/H5/canvas11.png" alt="canvas11" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">è·å–canvasåƒç´ ä¿¡æ¯</p> <p>ctx.getImageData(x, y, dx, dy) // åŒæºç­–ç•¥ å–åˆ°çš„dataå€¼æ˜¯æ•°ç»„ï¼Œæ˜¯æ¯ä¸ªåƒç´ çš„ä¿¡æ¯ æ³¨ï¼š
æ¯åƒç´ ç”±rgbaå››ä¸ªå‚æ•°ç»„æˆ<br>
ctx.createImageData(w, h) åˆ›å»ºæ–°çš„ç©ºç™½ ImageData å¯¹è±¡ ä¸€èˆ¬ä¸ç”¨<br>
ctx.putImageData(imgData, x, y)  å°†å›¾åƒæ•°æ®æ”¾å›ç”»å¸ƒä¸Š å¯ä»¥åˆ©ç”¨ctx.getImageData<br>
å–åˆ°åƒç´ ä¿¡æ¯è¿›è¡Œæ›´æ”¹ï¼Œå†ç”¨è¿™ä¸ªæ–¹æ³•æŠŠæ–°çš„æ•°æ®æ”¾å›ç”»å¸ƒ
ä¸Šï¼Œï¼ˆå°±æ˜¯å¯¹å›¾åƒè°ƒè‰²ï¼‰</p></div> <div class="tip custom-block"><p class="custom-block-title">å‘½ä¸­æ£€æµ‹ï¼ˆæ£€æµ‹ç‚¹æ˜¯å¦åœ¨è·¯å¾„å†…ï¼‰</p> <p>ctx.isPointInPath(x, y)ï¼›æ£€æµ‹æ˜¯å¦åœ¨åŒºåŸŸå†…,chrome ä¸å…¶ä»–çš„åŒºåˆ«  å¦‚æœå½“å‰è·¯å¾„ä¸æ˜¯é—­åˆè·¯å¾„è°·æ­Œæµè§ˆå™¨ä¼šè¿”å›false<br>
ctx.isPointInStroke(x, y)ï¼›æ£€æµ‹æ˜¯å¦åœ¨çº¿ä¸Š<br>
è¿˜å¯ä»¥é€šè¿‡æ£€æµ‹å½“å‰ç‚¹çš„åƒç´ å€¼ï¼Œå¦‚æœä¸ºé€æ˜ï¼Œåˆ™è¯¥ç‚¹ä¸å†è·¯å¾„ä¸Š</p></div> <div class="tip custom-block"><p class="custom-block-title">å¦‚ä½•è§£å†³canvasé«˜åˆ†å˜ç‡çš„å±å¹•æ¨¡ç³Šé—®é¢˜</p> <p>åœ¨åˆ†è¾¨ç‡æ¯”è¾ƒé«˜çš„å±å¹•ï¼Œä¾‹å¦‚ip6/6s/macç­‰æœºå™¨ä¸Šï¼Œå› ä¸ºcanvsç»˜åˆ¶çš„æ˜¯ä½å›¾ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ¨¡ç³Šï¼Œè§£å†³æ–¹æ³•æ˜¯æ ¹æ®å±å¹•åˆ†è¾¨ç‡ä¿®æ”¹canvasæ ·å¼ä»£ç ä¸­çš„å®½å’Œé«˜ä¸canvasçš„widthå’Œheightå±æ€§çš„æ¯”ä¾‹</p></div> <h2 id="svgçŸ¢é‡å›¾"><a href="#svgçŸ¢é‡å›¾" aria-hidden="true" class="header-anchor">#</a> SVGçŸ¢é‡å›¾</h2> <div class="tip custom-block"><p class="custom-block-title">åº”ç”¨åœºæ™¯</p> <p>å›¾è¡¨ã€å›¾æ ‡ iconï¼ˆä¸»è¦å®ç°å›¾æ ‡ï¼‰ã€åŠ¨æ•ˆã€çŸ¢é‡å›¾</p></div> <div class="tip custom-block"><p class="custom-block-title">ä½¿ç”¨</p> <pre><code>&lt;svg width=â€œ500pxâ€ height=â€œ500pxâ€&gt; //ä¸canvasä¸€æ ·å®½é«˜è¦å®šä¹‰åœ¨è¡Œé—´
</code></pre></div> <p>ç›´çº¿ï¼šx1 y1æ˜¯èµ·å§‹ç‚¹åæ ‡ x2 y2æ˜¯ç»ˆæ­¢ç‚¹åæ ‡ è¦æƒ³çœ‹åˆ°çº¿è¦åœ¨cssé‡Œå†™stroke=â€œredâ€</p> <pre><code>&lt;line x1=&quot;100&quot; y1=&quot;100&quot; x2=&quot;200&quot; y2=&quot;100&quot;&gt;&lt;/line&gt;
</code></pre> <p>çŸ©å½¢ï¼šx yçŸ©å½¢å·¦ä¸Šè§’çš„åæ ‡ rx ryåœ†è§’ å°é—­è·¯å¾„è‡ªåŠ¨å¡«å……</p> <pre><code>&lt;rect x=&quot;50&quot; y=&quot;50&quot; width=&quot;100&quot; height=&quot;100&quot; rx=&quot;10&quot;ry=&quot;20&quot;&gt;&lt;/rect&gt;
</code></pre> <p>åœ†å½¢ï¼šr åŠå¾„ cx cy åœ†å¿ƒ</p> <pre><code>&lt;circle r=&quot;50&quot; cx=&quot;220&quot; cy=&quot;100&quot;&gt;&lt;/circle&gt;
</code></pre> <p>æ¤­åœ†ï¼šrx ry åŠå¾„ cx cy åœ†å¿ƒ</p> <pre><code>&lt;ellipse rx=&quot;100&quot; ry=&quot;50&quot; cx=&quot;400&quot; cy=&quot;150&quot;&gt;&lt;/ellipse&gt;
</code></pre> <p>æŠ˜çº¿ï¼š</p> <pre><code>&lt;polyline points=&quot;60 50, 75 35, 100 50, 125 35, 150 50,175 35, 190 50&quot;&gt;&lt;/polyline&gt;
</code></pre> <p>å¤šè¾¹å½¢</p> <pre><code>&lt;polygon points=&quot;125 125,130 140,120 140&quot;&gt;&lt;/polygon&gt;
</code></pre> <p>â½‚æœ¬</p> <pre><code>&lt;text x=&quot;125&quot; y=&quot;220&quot;&gt;hello,world&lt;/text&gt;
</code></pre> <div class="tip custom-block"><p class="custom-block-title">æ ·å¼ï¼šcssé‡Œçš„svgæ ‡ç­¾å±æ€§</p> <p>fill å¡«å……<br>
stroke æè¾¹<br>
stroke-width çº¿å®½<br>
stroke-opacity/fill-opacity é€æ˜åº¦<br>
stroke-linecap çº¿ä¸¤ç«¯çš„æ ·å¼<br>
stroke-linejoin ä¸¤çº¿ä¹‹é—´çš„è¿æ¥æ ·å¼<br>
stroke-miterlimit miteræ ·å¼ä¸­ï¼Œè¶…è¿‡è¿™ä¸ªå€¼å°±æˆªæ–­</p></div> <img src="/H5/svg1.png" alt="svg1" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">Pathå…ƒç´ </p> <p>MæŒ‡ä»¤å’ŒLæŒ‡ä»¤</p> <pre><code>&lt;path d = &quot;M 10 10 L 20 10&quot; /&gt;  
</code></pre> <p>mæŒ‡ä»¤å’ŒlæŒ‡ä»¤</p> <pre><code>&lt;path d = &quot;m 10 10 l 20 10&quot; /&gt;  
</code></pre> <p>å¤§å†™è¡¨ç¤ºç»å¯¹å®šä½ï¼Œå°å†™è¡¨ç¤ºç›¸å¯¹å®šä½<br>
ç»å¯¹åæ ‡å’Œç›¸å¯¹åæ ‡  ç›¸å¯¹äºä¸Šä¸€ä¸ªç§»åŠ¨è·ç¦»<br>
Hå’ŒVå‘½ä»¤</p> <pre><code>&lt;path d=&quot;M 100 100 H 200 V 200&quot;/&gt;  
</code></pre> <p>æ°´å¹³ï¼ˆhorizontal linetoï¼‰ç«–ç›´ï¼ˆvertical linetoï¼‰æ–¹å‘ç§»åŠ¨è·ç¦»<br>
Zå‘½ä»¤</p> <pre><code>&lt;path d=&quot;M 100 100 H 200 V 200 z&quot;/&gt;  
</code></pre> <p>æ³¨ï¼šé—­åˆ Zä¸åŒºåˆ†å¤§å°å†™</p></div> <div class="tip custom-block"><p class="custom-block-title">åœ†å¼§æŒ‡ä»¤</p> <pre><code>&lt;path d=&quot;M 100 100 A 70 120 90 1 1 150 200&quot;&gt;&lt;/path&gt;
</code></pre> <p>Aå‘½ä»¤  (elliptical Arc)  ä¸ƒä¸ªå‚æ•°<br>
rx ry x-axis-rotation large-arc-flag sweep-flag x y<br>
rx ry åœ†å¼§çš„xè½´åŠå¾„å’Œyè½´åŠå¾„<br>
x-axis-rotation åœ†å¼§ç›¸å¯¹xè½´çš„æ—‹è½¬è§’åº¦ï¼Œé»˜è®¤æ˜¯é¡ºæ—¶é’ˆï¼Œå¯ä»¥è®¾ç½®è´Ÿå€¼<br>
large-arc-flag è¡¨ç¤ºåœ†å¼§è·¯å¾„æ˜¯å¤§åœ†å¼§è¿˜æ˜¯å°åœ†å¼§ 1å¤§åœ†å¼§<br>
sweep-flag è¡¨ç¤ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹æ˜¯é¡ºæ—¶é’ˆè¿˜æ˜¯é€†æ—¶é’ˆï¼Œ1è¡¨ç¤ºé¡ºæ—¶é’ˆï¼Œ0è¡¨ç¤ºé€†æ—¶é’ˆ<br>
x y è¡¨ç¤ºç»ˆç‚¹åæ ‡ï¼Œç»å¯¹æˆ–ç›¸å¯¹</p></div> <div class="tip custom-block"><p class="custom-block-title">è´å¡å°”æ›²çº¿ï¼šè‡ªåŠ¨ç”Ÿæˆè·¯å¾„â€”â€”&gt;http://editor.method.ac/</p> <p>äºŒæ¬¡è´å¡å°”: Q x1 y1, x y å…³é”®ç‚¹ T x y æ‰©å±•ç‚¹<br>
ä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼šC x1 y1, x2 y2, x y å…³é”®ç‚¹ S x2 y2, x y æ‰©å±•ç‚¹</p></div> <div class="tip custom-block"><p class="custom-block-title">æ¸å˜</p> <p>çº¿æ€§æ¸å˜ï¼šx1 y1--èµ·å§‹ç‚¹ x2 y2---ç»ˆæ­¢ç‚¹ offsetåˆ°å“ªä¸ªä½ç½®styleè®¾ç½®ä¸ºä»€ä¹ˆé¢œè‰²<br> <img src="/H5/svg2.png" alt="svg2" style="margin:10px auto"></p> <p>å¾„å‘æ¸å˜
<img src="/H5/svg3.png" alt="svg3" style="margin:10px auto"></p> <p>é«˜æ–¯æ»¤é•œ</p> <pre><code>&lt;defs&gt;
    &lt;filter id=&quot;Gaussian_Blur&quot;&gt;
        &lt;feGaussianBlur in=&quot;SourceGraphic&quot; stdDeviation=&quot;20&quot;/&gt;
    &lt;/filter&gt;
&lt;/defs&gt;
&lt;rect x=&quot;0&quot; y=&quot;0&quot; width=&quot;500&quot; height=&quot;500&quot; fill=â€yellowâ€ style=&quot;filter:url(#Gaussian_Blur)&quot;/&gt;
</code></pre> <p>å…¶ä»–æ»¤é•œ-----http://www.w3school.com.cn/svg/svg_filters_intro.asp</p></div> <div class="tip custom-block"><p class="custom-block-title">SVGè·¯å¾„åŠ¨ç”»ï¼ˆç»“åˆcss3å®ç°åŠ¨ç”»æ•ˆæœï¼‰</p> <p>stroke-dasharrayï¼š 10px 20px 30px; åˆ‡å‰²çº¿æ®µï¼ŒæŒ‰ç…§10px 20px 30pxçš„é¡ºåºï¼Œæ˜¾ç¤ºä¸º
è™šçº¿ã€‚å¯å†™å¤šå€¼
stroke-dashoffset: 15px; çº¿æ®µåç§»æ•ˆæœï¼Œ</p></div> <div class="tip custom-block"><p class="custom-block-title">Jsæ“ä½œsvg</p> <p>getTotalLengthï¼ˆï¼‰ è·å–è·¯å¾„æ€»é•¿åº¦<br>
getPointAtLength(x) è·å–è·¯å¾„ä¸Šè·ç¦»èµ·å§‹ç‚¹è·ç¦»xé•¿åº¦çš„ç‚¹çš„åæ ‡<br>
æ³¨ï¼šä¸¥æ ¼æ¥è¯´ä¸Šé¢ä¸¤æ–¹æ³•åªé€‚ç”¨äºpathå…ƒç´ ï¼Œä½†å„ä¸ªæµè§ˆå™¨å®ç°èµ·æ¥éƒ½ä¼šæœ‰ä¸€ç‚¹åŒºåˆ«ã€‚ä¾‹å¦‚<br>
è°·æ­Œæµè§ˆå™¨ä¹Ÿèƒ½è·å–åˆ°lineå…ƒç´ çš„è·¯å¾„é•¿åº¦ã€‚</p> <pre><code>&lt;svg width=&quot;400&quot; height=&quot;300&quot; viewBox=&quot;0,0,40,30&quot; style=&quot;border:1px solid #cd0000;&quot;&gt;
    &lt;rect x=&quot;10&quot; y=&quot;5&quot; width=&quot;20&quot; height=&quot;15&quot; fill=&quot;#cd0000&quot;/&gt;
&lt;/svg&gt;
</code></pre> <p>viewBoxå®šä¹‰äº†svgå›¾å†…éƒ¨çš„ç›¸å¯¹åƒç´ å¤§å°ã€‚---ç›¸å¯¹svgåœ¨æµè§ˆå™¨ä¸Šçš„åƒç´ ï¼ŒæŒ‰æ¯”ä¾‹æ”¾å¤§å¯è§†åŒºã€‚<br>
preserveAspectRatio(ä½œç”¨çš„å¯¹è±¡éƒ½æ˜¯viewBox)<br>
preserveAspectRatio=&quot;xMidYMid meet&quot;<br>
svg.setAttribute(&quot;preserveAspectRatio&quot;, &quot;xMinYMin meet&quot;);<br>
ç¬¬1ä¸ªå€¼è¡¨ç¤ºï¼ŒviewBoxå¦‚ä½•ä¸SVG viewportå¯¹é½ï¼ˆè§ä¸‹è¡¨ï¼‰ï¼›<br>
ç¬¬2ä¸ªå€¼è¡¨ç¤ºï¼Œå¦‚ä½•ç»´æŒé«˜å®½æ¯”ï¼ˆå¦‚æœæœ‰ï¼‰<br>
meet:ä¿æŒçºµæ¨ªæ¯”ç¼©æ”¾viewBoxé€‚åº”viewport<br>
slice:ä¿æŒçºµæ¨ªæ¯”åŒæ—¶æ¯”ä¾‹å°çš„æ–¹å‘æ”¾å¤§å¡«æ»¡viewport(åœ¨å‡åŒ€ç¼©æ”¾çš„åŒæ—¶ä¿æŒviewboxçš„å®½é«˜æ¯”)<br>
none: æ‰­æ›²çºµæ¨ªæ¯”ä»¥å……åˆ†é€‚åº”viewport<br>
http://www.zhangxinxu.com/study/201408/svg-preserveaspectratio-meet-slice-none.html</p></div> <img src="/H5/svg4.png" alt="svg4" style="margin:10px auto"> <img src="/H5/svg5.png" alt="svg5" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">JS ç”ŸæˆSVGå…ƒç´ </p> <p>åˆ›å»ºSVGå…ƒç´ éœ€è¦æŒ‡å®šå‘½åç©ºé—´<br>
SVGå…ƒç´ å¯¹è±¡å¿…é¡»é€šè¿‡è°ƒç”¨setAttribute()æ–¹æ³•æ¥è®¾å®šå±æ€§å€¼</p></div> <img src="/H5/svg6.png" alt="svg6" style="margin:10px auto"> <h2 id="audio-éŸ³é¢‘å’Œvideoè§†é¢‘"><a href="#audio-éŸ³é¢‘å’Œvideoè§†é¢‘" aria-hidden="true" class="header-anchor">#</a> Audio éŸ³é¢‘å’Œvideoè§†é¢‘</h2> <p><a href="http://www.w3school.com.cn/html5/html5_ref_audio_video_dom.asp" target="_blank" rel="noopener noreferrer">w3cæ•™ç¨‹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="tip custom-block"><p class="custom-block-title">æ·»åŠ </p> <pre><code>&lt;audio id=&quot;audio&quot; src=&quot;./æˆéƒ½.mp3&quot;&gt;&lt;/audio&gt;
&lt;video id=&quot;video&quot; src=&quot;./æˆéƒ½.mp4&quot;&gt;&lt;/video&gt;
</code></pre></div> <div class="tip custom-block"><p class="custom-block-title">å±æ€§</p> <p>autoplay è‡ªåŠ¨æ’­æ”¾ â†’ è°·æ­Œæµè§ˆå™¨ä¸æ”¯æŒæœ¬åœ°è‡ªåŠ¨æ’­æ”¾ï¼Œå¿…é¡»æ”¾ç½®åœ¨æœåŠ¡å™¨ä¸Š</p> <pre><code>&lt;audio src=&quot;æˆéƒ½.mp3&quot; autoplay&gt;&lt;/audio&gt;  
</code></pre> <p>controls è®¾ç½®æ§ä»¶ â†’ å¿…é¡»æ·»åŠ æ§ä»¶ï¼Œå¦åˆ™éŸ³é¢‘ä¸æ˜¾ç¤ºï¼Œè§†é¢‘ä¸æ’­æ”¾</p> <pre><code>&lt;audio src=&quot;æˆéƒ½.mp3&quot; autoplay controls&gt;&lt;/audio&gt;  
</code></pre> <p>preload(none/metadata/auto) é¢„åŠ è½½ï¼Œè§„å®šæ˜¯å¦åœ¨é¡µé¢åŠ è½½åè½½å…¥éŸ³é¢‘<br>
â†’ none ä¸éœ€è¦åŠ è½½æ•°æ®ï¼Œä½¿ç”¨æ—¶å†åŠ è½½<br>
â†’ metadata å…ˆåŠ è½½å…ƒæ•°æ®ï¼ˆå¦‚æ—¶é•¿ã€æ¯”ç‰¹ç‡ã€å¸§å¤§å°è¿™æ ·çš„åŸæ•°æ®ï¼‰ï¼Œå†åŠ è½½åª’ä½“å†…å®¹<br>
â†’ auto æµè§ˆå™¨åº”å½“åŠ è½½å®ƒè®¤ä¸ºé€‚é‡çš„åª’ä½“å†…å®¹</p> <pre><code>&lt;audio src=&quot;æˆéƒ½.mp3&quot; autoplay controls preload=&quot;auto&quot;&gt;&lt;/audio&gt;
</code></pre> <p>loop æ˜¯å¦å¾ªç¯æ’­æ”¾éŸ³/è§†é¢‘</p> <pre><code>&lt;audio src=&quot;æˆéƒ½.mp3&quot; autoplay controls loop preload=&quot;auto&quot;&gt;&lt;/audio&gt;
</code></pre> <p>poster (video ç‹¬æœ‰)  â†’ å½“è§†é¢‘ä¸å¯ç”¨æ—¶ï¼Œä½¿ç”¨ä¸€å¼ å›¾ç‰‡æ›¿ä»£ï¼Œå¦åˆ™æ˜¯ç©ºç™½</p> <pre><code>&lt;video src=&quot;æˆéƒ½.mp4&quot; poster=&quot;å°é¢.jpg&quot; controls&gt;&lt;/video&gt;
</code></pre> <p>sourceå¤šç±»å‹èµ„æº â†’ ä¸ºäº†å…¼å®¹ï¼Œé…ç½®å¤šç§æ ¼å¼ï¼Œæµè§ˆå™¨æ”¯æŒå“ªä¸ªç”¨å“ªä¸ª</p> <pre><code>&lt;audio id=&quot;music&quot;&gt; 
        &lt;source src=&quot;æˆéƒ½.mp3&quot; type=&quot;audio/mpeg&quot;&gt;
        &lt;source src=&quot;æˆéƒ½.ogg&quot; type='audio/ogg&quot;'&gt;
    &lt;/audio&gt;
</code></pre></div> <p><strong>è„šæœ¬åŒ–ï¼ˆjsæ§åˆ¶ï¼‰</strong></p> <div class="tip custom-block"><p class="custom-block-title">è·å–ã€åˆ›å»ºæ ‡ç­¾</p> <pre><code>var audio = document.getElementById('audio'); //videoä¹Ÿå¯ä»¥ç”¨  
var audio = new Audio('./laojie.mp3');   //videoæ²¡æœ‰æ„é€ å‡½æ•°ï¼Œä¸å¯ä»¥ç”¨è¿™ç§æ–¹æ³•  
var audio = document.createElement('video'); //videoä¹Ÿå¯ä»¥ç”¨
</code></pre></div> <div class="tip custom-block"><p class="custom-block-title">è®¾ç½®å±æ€§</p> <p>å¯ä»¥ç”¨setAttributeå’Œ. å±æ€§åä¸¤ç§æ–¹æ³•
<img src="/H5/video1.png" alt="video1" style="margin:10px auto"></p> <p>audioï¼volume è¡¨ç¤ºæ’­æ”¾éŸ³é‡ï¼Œä»‹äº0(é™éŸ³)~1(æœ€å¤§éŸ³é‡)ä¹‹é—´ï¼Œé»˜è®¤1ã€‚<br>
audioï¼muted å°†mutedå±æ€§è®¾ç½®ä¸ºtrueåˆ™ä¼šè¿›å…¥é™éŸ³æ¨¡å¼ï¼Œè®¾ç½®ä¸ºfalseåˆ™ä¼šæ¢å¤ä¹‹å‰æŒ‡å®šçš„éŸ³é‡ç»§ç»­æ’­æ”¾ã€‚
audioï¼playbackRate ç”¨äºæŒ‡å®šåª’ä½“æ’­æ”¾çš„é€Ÿåº¦ã€‚è¯¥å±æ€§å€¼ä¸º1.0è¡¨ç¤ºæ­£å¸¸é€Ÿåº¦ï¼Œå¤§äº1åˆ™è¡¨ç¤ºâ€å¿«è¿›â€ï¼Œ0~1ä¹‹é—´è¡¨ç¤ºâ€æ…¢æ”¾&quot;ï¼Œè´Ÿå€¼è¡¨ç¤ºå›æ”¾ã€‚æ¯ä¸ªæµè§ˆå™¨å®ç°çš„ä¼šæœ‰å·®åˆ«ï¼Œå…·ä½“çœ‹æµè§ˆå™¨å®ç°ã€‚ï¼ˆå¯ä»¥å®ç°å¿«è¿›å’Œæ…¢æ”¾ï¼‰<br>
audioï¼currentTime è®¾ç½®æˆ–è¿”å›éŸ³é¢‘/è§†é¢‘æ’­æ”¾çš„å½“å‰ä½ç½® å•ä½ ç§’<br> <img src="/H5/video2.png" alt="video2" style="margin:10px auto"></p> <p>audioï¼duration è¿”å›å½“å‰éŸ³é¢‘/è§†é¢‘çš„æ—¶é•¿(window.onload) å•ä½ ç§’<br> <img src="/H5/video3.png" alt="video3" style="margin:10px auto"></p> <p>audioï¼played å±æ€§è¿”å›å·²ç»æ’­æ”¾(çœ‹è¿‡)çš„æ—¶é—´æ®µï¼Œ<br>
audioï¼buffered å±æ€§è¿”å›å½“å‰å·²ç»ç¼“å†²çš„æ—¶é—´æ®µï¼Œ<br>
audioï¼seekable å±æ€§åˆ™è¿”å›ç”¨æˆ·å¯ä»¥è·³è½¬çš„æ—¶é—´æ®µã€‚<br>
è¿™ä¸‰ä¸ªå±æ€§éƒ½æ˜¯TimeRangeså¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªlengthå±æ€§ä»¥åŠstart()å’Œend()æ–¹æ³•ï¼Œlengthå±æ€§è¡¨ç¤ºå½“å‰çš„ä¸€ä¸ªæ—¶é—´æ®µï¼Œstart()ä¸
end()åˆ†åˆ«è¿”å›å½“å‰æ—¶é—´æ®µçš„èµ·å§‹æ—¶é—´ç‚¹å’Œç»“æŸæ—¶é—´ç‚¹(å•ä½æ˜¯ç§’ï¼Œèµ·å§‹å‚æ•°æ˜¯0)åº”ç”¨: ç¡®å®šå½“å‰ç¼“å­˜å†…å®¹çš„ç™¾åˆ†æ¯”
<img src="/H5/video4.png" alt="video4" style="margin:10px auto"></p> <p>audioï¼paused ä¸ºtrueè¡¨ç¤ºæ’­æ”¾å™¨æš‚åœã€‚<br>
audioï¼seeking ä¸ºtrueè¡¨ç¤ºæ’­æ”¾å™¨æ­£åœ¨è°ƒåˆ°ä¸€ä¸ªæ–°çš„æ’­æ”¾ç‚¹ï¼Œ<br>
audioï¼ended å¦‚æœæ’­æ”¾å™¨æ’­æ”¾å®Œåª’ä½“å¹¶ä¸”åœä¸‹æ¥ï¼Œåˆ™endedå±æ€§ä¸ºtrueã€‚<br>
åº”ç”¨: é€šè¿‡è¿™å‡ ä¸ªå±æ€§å¯ä»¥æŠŠæ’­æ”¾æš‚åœæŒ‰é’®è®¾ç½®ä¸ºä¸€ä¸ª</p></div> <div class="tip custom-block"><p class="custom-block-title">æ–¹æ³•</p> <p>audioï¼play() æ–¹æ³•<br>
audioï¼pause() æ–¹æ³•<br>
audioï¼load()æ–¹æ³• é‡æ–°åŠ è½½è§†éŸ³é¢‘ï¼Œç”¨äºåœ¨æ›´æ”¹æ¥æºæˆ–å…¶ä»–è®¾ç½®åå¯¹éŸ³è§†é¢‘å…ƒç´ è¿›è¡Œæ›´æ–°<br>
audioï¼canPlayType() åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒè¯¥æ ¼å¼<br> <img src="/H5/video5.png" alt="video5" style="margin:10px auto"></p></div> <div class="tip custom-block"><p class="custom-block-title">å¸¸ç”¨äº‹ä»¶ï¼ˆå…¶å®ƒå¯ä»¥çœ‹å…·ä½“æ•™ç¨‹ï¼‰</p> <p>play å¼€å§‹æ’­æ”¾è§¦å‘<br>
pause æš‚åœè§¦å‘<br>
loadedmetadata æµè§ˆå™¨è·å–å®Œåª’ä½“çš„å…ƒæ•°æ®è§¦å‘<br>
loadeddata æµè§ˆå™¨å·²ç»åŠ è½½å®Œå½“å‰å¸§æ•°æ®ï¼Œå‡†å¤‡æ’­æ”¾æ—¶è§¦å‘ï¼Œæ³¨æ„IE8<br>
ended å½“å‰æ’­æ”¾ç»“æŸåè§¦å‘</p></div> <img src="/H5/video6.png" alt="video6" style="margin:10px auto"> <h2 id="requestanimationframe"><a href="#requestanimationframe" aria-hidden="true" class="header-anchor">#</a> requestAnimationFrame</h2> <p>requestAnimationFrameï¼šç”¨æ³•å’Œ setTimeoutç±»ä¼¼ï¼Œä½†æ˜¯ä¸ç”¨è®¾ç½®æ—¶é—´é¡µé¢åˆ·æ–°å‰æ‰§è¡Œä¸€æ¬¡<br>
1000ms 60fps(1000msåˆ·æ–°60æ¬¡) ï¼Œå³ æ¯16msåˆ·æ–°ä¸€æ¬¡</p> <pre><code>cancelAnimationFrameï¼ˆæ¸…é™¤requestAnimationFrameï¼‰
</code></pre> <img src="/H5/requestAnimationFrame.png" alt="requestAnimationFrame" style="margin:10px auto"> <p>å…¼å®¹æ€§å†™æ³•</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code>requestAnimationFrameå…¼å®¹æ€§å†™æ³•ï¼š
window<span class="token punctuation">.</span>requestAnimFrame <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>requestAnimationFrame <span class="token operator">||</span>
  window<span class="token punctuation">.</span>webkitRequestAnimationFrame <span class="token operator">||</span>
  window<span class="token punctuation">.</span>mozRequestAnimationFrame <span class="token operator">||</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span> callback <span class="token punctuation">)</span><span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cancelAnimationFrameå…¼å®¹æ€§å†™æ³•ï¼š
window<span class="token punctuation">.</span>cancelAnimFrame <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> window<span class="token punctuation">.</span>cancelAnimationFrame <span class="token operator">||</span>
  window<span class="token punctuation">.</span>webkitCancelAnimationFrame <span class="token operator">||</span>
  window<span class="token punctuation">.</span>mozCancelAnimationFrame <span class="token operator">||</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">clearTimeout</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="å®¢æˆ·ç«¯å­˜å‚¨"><a href="#å®¢æˆ·ç«¯å­˜å‚¨" aria-hidden="true" class="header-anchor">#</a> å®¢æˆ·ç«¯å­˜å‚¨</h2> <div class="tip custom-block"><p class="custom-block-title">å®¢æˆ·ç«¯å­˜å‚¨æ–¹æ³•</p> <p>Storageï¼š ä¸ä¼šä¼ åˆ°æœåŠ¡å™¨<br>
Cookieï¼šå­˜å‚¨é‡å°4kï¼Œæ¯æ¬¡ç½‘ç»œè¯·æ±‚éƒ½è¦å°†cookieå‘é€åå°å½±å“æ€§èƒ½ï¼Œ</p></div> <p><strong>storage</strong>
ç”¨æ³•ï¼šlocalStroageã€sessionStroageç”¨æ³•ä¸€æ ·<br>
å­˜å‚¨æ–¹å¼:</p> <pre><code>localStorage.name = 'aimee'
localStorageè‡ªåŠ¨è°ƒç”¨tostringæ–¹æ³•ï¼Œæ‰€ä»¥ä¼ æ•°ç»„ç›´æ¥å˜æˆå­—ç¬¦ä¸²ï¼Œä¸èƒ½ä¼ å¯¹è±¡ï¼Œè¦ä¼ å¯¹è±¡å°±è¦è½¬æˆjsonæ ¼å¼ã€‚
localStorage.info = JSON.stringify({name:'aimee,company: 'duyiâ€™})
</code></pre> <p>è¯»å–æ–¹å¼ï¼š</p> <pre><code>localStrorage.name
JSON.parse(localStorage.info)
</code></pre> <p>å­˜å‚¨æœ‰æ•ˆæœŸ</p> <pre><code>localStorage-&gt;æ°¸ä¹…çš„ï¼Œé™¤éæ‰‹åŠ¨åˆ é™¤
sessionStorage-&gt;ä¸´æ—¶ï¼Œçª—å£å…³é—­å°±æ²¡æœ‰ï¦º
</code></pre> <p>å­˜å‚¨ä½œç”¨åŸŸ</p> <pre><code>localStorage-&gt;æ–‡æ¡£æºé™åˆ¶
sessionStorage-&gt;æ–‡æ¡£æºé™åˆ¶+çª—å£
</code></pre> <p>å±æ€§</p> <pre><code>localStorage. setItem(name,val) è®¾ç½®å±æ€§å€¼
localStorage. getItem(name) è·å¾—å±æ€§å€¼
localStorage. removeItem(name) ç§»é™¤å±æ€§
localStorage. clear() æ¸…é™¤å±æ€§
</code></pre> <p>Cookieå’Œstorageçš„åŒºåˆ«<br> <img src="/H5/Storage.png" alt="Storage" style="margin:10px auto"></p> <h2 id="å†å²è®°å½•"><a href="#å†å²è®°å½•" aria-hidden="true" class="header-anchor">#</a> å†å²è®°å½•</h2> <div class="tip custom-block"><p class="custom-block-title">Historyè€å¯¹è±¡æ–¹æ³•ï¼š</p> <p>history.back() å›é€€åˆ°ä¸Šä¸€æ¬¡å†å²è®°å½•<br>
history.forward() å‰è¿›ä¸€æ¬¡å†å²è®°å½•<br>
history.go(n) å»åˆ°ä¸€æ¬¡å†å²è®°å½• nå¯ä»¥æ˜¯æ­£ è´Ÿ</p></div> <div class="tip custom-block"><p class="custom-block-title">Historyæ–°çš„æ–¹æ³•ï¼š</p> <p>pushState â†’ history.pushState(state, title, url); æ·»åŠ ä¸€æ¡å†å²è®°å½•<br>
replaceState â†’ history.replaceState(state, title, url); æ›¿æ¢å½“å‰çš„å†å²è®°å½•<br>
â†’ stateï¼šä¸€ä¸ªä¸æŒ‡å®šç½‘å€ç›¸å…³çš„çŠ¶æ€å¯¹è±¡ï¼Œpopstateäº‹ä»¶è§¦å‘æ—¶ï¼Œè¯¥å¯¹è±¡ä¼šä¼ å…¥å›è°ƒå‡½æ•°ä¸­ã€‚å¦‚æœä¸éœ€è¦è¿™ä¸ªå¯¹è±¡ï¼Œæ­¤å¤„å¯ä»¥å¡«nullã€‚<br>
â†’ titleï¼šæ–°é¡µé¢çš„æ ‡é¢˜ï¼Œä½†æ˜¯æ‰€æœ‰æµè§ˆå™¨ç›®å‰éƒ½å¿½ç•¥è¿™ä¸ªå€¼ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥å¡«nullã€‚<br>
â†’ urlï¼šæ–°çš„ç½‘å€ï¼Œå¿…é¡»ä¸å½“å‰é¡µé¢å¤„åœ¨åŒä¸€ä¸ªåŸŸã€‚æµè§ˆå™¨çš„åœ°å€æ å°†æ˜¾ç¤ºè¿™ä¸ªç½‘å€ã€‚</p></div> <div class="tip custom-block"><p class="custom-block-title">Historyæ–°å¢çš„äº‹ä»¶</p> <p>popstate äº‹ä»¶ â†’ å†å²è®°å½•å‘ç”Ÿæ”¹å˜æ—¶è§¦å‘<br>
è°ƒç”¨history.pushState()æˆ–è€…history.replaceState()ï¥§ä¼šè§¦å‘popstateäº‹ä»¶<br>
hashchangeäº‹ä»¶ â†’ å½“é¡µé¢çš„hashå€¼æ”¹å˜çš„æ—¶å€™è§¦å‘ï¼Œå¸¸ç”¨äºæ„å»ºå•é¡µé¢åº”ç”¨</p></div> <h2 id="worker"><a href="#worker" aria-hidden="true" class="header-anchor">#</a> worker</h2> <ol><li><p>Workeræ˜¯ä¸€ç§å¼‚æ­¥æ‰§è¡Œjsçš„æ–¹å¼</p></li> <li><p>åº”ç”¨<br> <img src="/H5/worker.png" alt="worker" style="margin:10px auto"></p></li> <li><p>ç»“æŸworker<br>
close() åœ¨workerä½œç”¨åŸŸä¸­è°ƒç”¨(worker.js) å‰¯çº¿ç¨‹ä¸Šè°ƒç”¨<br>
terminate() åœ¨workerå¯¹è±¡ä¸Šè°ƒç”¨(ä¸»è¿›ç¨‹çš„workerå¯¹è±¡ä¸Š worker.terminate)</p></li> <li><p>importScripts('./math1.js','./math2.js')<br>
workeråªæ˜¯windowçš„å­é›†ï¼Œåªèƒ½å®ç°éƒ¨åˆ†åŠŸèƒ½ï¼Œä¸èƒ½è·å–åˆ°window, documentï¼Œæ‰€ä»¥è¿™é‡Œä¸è¦å¼•juery zeptoã€‚å¯ä»¥å¼•å…¥ä¸€äº›è®¡ç®—ç±»çš„åº“ã€‚</p></li> <li><p>postMessageè·¨åŸŸ<br>
Window.postMessage<br>
Iframe å­é¡µé¢ä¼ é€’æ•°æ®ç»™çˆ¶é¡µé¢</p></li></ol> <h2 id="filereaderè¯»å–æ–‡ä»¶"><a href="#filereaderè¯»å–æ–‡ä»¶" aria-hidden="true" class="header-anchor">#</a> FileReaderè¯»å–æ–‡ä»¶</h2> <p><em>å‰è¨€ï¼šFileReaderæ˜¯ä¸€ç§å¼‚æ­¥æ–‡ä»¶è¯»å–æœºåˆ¶ï¼Œç»“åˆinput:fileå¯ä»¥å¾ˆæ–¹ä¾¿çš„è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚</em></p> <div class="tip custom-block"><p class="custom-block-title">input:file</p> <p>inputçš„fileç±»å‹ä¼šæ¸²æŸ“ä¸ºä¸€ä¸ªæŒ‰é’®å’Œä¸€æ®µæ–‡å­—ã€‚ç‚¹å‡»æŒ‰é’®å¯æ‰“å¼€æ–‡ä»¶é€‰æ‹©çª—å£ï¼Œæ–‡å­—è¡¨ç¤ºå¯¹æ–‡ä»¶çš„æè¿°ï¼ˆå¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¸ºæ–‡ä»¶åï¼‰ï¼›fileç±»å‹çš„inputä¼šæœ‰fileså±æ€§ï¼Œä¿å­˜ç€æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ã€‚</p></div> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;inputBox&quot;</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç‚¹å‡»æŒ‰é’®ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åï¼Œåœ¨æ§åˆ¶å°æ‰“å°input.filesï¼Œå¦‚ä¸‹ï¼š<br> <img src="/H5/FileReader2.png" alt="FileReader2" style="margin:10px auto"><br> <img src="/H5/FileReader3.png" alt="FileReader3" style="margin:10px auto"><br>
å¯ä»¥å‘ç°input.filesæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç”±ä¼ å…¥çš„fileå¯¹è±¡ç»„æˆã€‚æ¯ä¸ªfileå¯¹è±¡åŒ…å«ä»¥ä¸‹å±æ€§ï¼š<br>
lastModifiedï¼šæ•°å€¼ï¼Œè¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡ä¿®æ”¹æ—¶é—´çš„æ¯«ç§’æ•°ï¼›<br>
lastModifiedDateï¼šå¯¹è±¡ï¼Œè¡¨ç¤ºæœ€åä¸€æ¬¡è¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡ä¿®æ”¹æ—¶é—´çš„Dateå¯¹è±¡ï¼ˆé«˜ç¨‹ä¸­è¯´æ˜¯å­—ç¬¦ä¸²ï¼Œæ ¹æ®ä¸Šå›¾å¯çœ‹å‡ºåº”è¯¥ä¸ºå¯¹è±¡ï¼Œä¸ºäº†å±‚çº§æ¸…æ™°æœªå¯¹å…¶å±•å¼€ï¼Œå¤§å®¶å¯è‡ªè¡ŒæŸ¥çœ‹ï¼Œå…¶å¯è°ƒç”¨Dateå¯¹è±¡çš„æœ‰å…³æ–¹æ³•ï¼Œä¾‹å¦‚getDayæ–¹æ³•ï¼‰ï¼›<br>
nameï¼šæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶åï¼›<br>
sizeï¼šæ–‡ä»¶çš„å­—èŠ‚å¤§å°ï¼›<br>
typeï¼šå­—ç¬¦ä¸²ï¼Œæ–‡ä»¶çš„MIMEç±»å‹ï¼›<br>
weblitRelativePathï¼šæ­¤å¤„ä¸ºç©ºï¼›å½“åœ¨inputä¸ŠåŠ ä¸Šwebkitdirectoryå±æ€§æ—¶ï¼Œç”¨æˆ·å¯é€‰æ‹©æ–‡ä»¶å¤¹ï¼Œæ­¤æ—¶weblitRelativePathè¡¨ç¤ºæ–‡ä»¶å¤¹ä¸­æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚æ¯”å¦‚ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;inputBox&quot;</span> webkitdirectory<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç‚¹å‡»æŒ‰é’®æ·»åŠ ä¸€ä¸ªåŒ…å«3ä¸ªæ–‡ä»¶çš„åä¸ºphpçš„æ–‡ä»¶å¤¹åï¼Œæ§åˆ¶å°æ‰“å°inputBox.filesï¼Œå¦‚ä¸‹ï¼š
<img src="/H5/FileReader4.png" alt="FileReader4" style="margin:10px auto"> <img src="/H5/FileReader5.png" alt="FileReader5" style="margin:10px auto"><br>
å¯çœ‹å‡ºï¼Œæ­¤æ—¶weblitRelativePathè¡¨ç¤ºå½“å‰fileå¯¹è±¡çš„æ–‡ä»¶åœ¨æ–‡ä»¶å¤¹ä¸­çš„è·¯å¾„ã€‚<br>
ä»¥ä¸Šfileå¯¹è±¡åªè·å–åˆ°äº†å¯¹æ–‡ä»¶çš„æè¿°ä¿¡æ¯ï¼Œä½†æ²¡æœ‰è·å¾—æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œè€ŒinputBox.valueä¹Ÿåªæ˜¯ä¿å­˜çš„æ˜¯æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼ˆè¿™é‡Œå°±ä¸å±•ç¤ºäº†ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±è¯•ä¸€è¯•ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡html5æä¾›çš„FileReaderè¯»å–åˆ°æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚<br>
é¦–å…ˆåˆ›å»ºä¸€ä¸ªFileReaderå®ä¾‹ï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">æ–¹æ³•</p> <p>readAsArrayBuffer(file)	æŒ‰å­—èŠ‚è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç»“æœç”¨ArrayBufferå¯¹è±¡è¡¨ç¤º<br>
readAsBinaryString(file)	æŒ‰å­—èŠ‚è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç»“æœä¸ºæ–‡ä»¶çš„äºŒè¿›åˆ¶ä¸²<br>
readAsDataURL(file)	    è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç»“æœç”¨data:urlçš„å­—ç¬¦ä¸²å½¢å¼è¡¨ç¤º<br>
readAsText(file,encoding)	æŒ‰å­—ç¬¦è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç»“æœç”¨å­—ç¬¦ä¸²å½¢å¼è¡¨ç¤º<br>
abort()	ç»ˆæ­¢æ–‡ä»¶è¯»å–æ“ä½œ</p></div> <p>readAsDataURLå’ŒreadAsTextè¾ƒä¸ºå¸¸ç”¨ï¼Œè¿™é‡Œåªå¯¹è¿™ä¸¤è€…è¿›è¡Œè¯´æ˜ã€‚<br>
readAsDataURLä¼šå°†æ–‡ä»¶å†…å®¹è¿›è¡Œbase64ç¼–ç åè¾“å‡ºï¼š</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> inputBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;inputBox&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
inputBox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>inputBox<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘èµ·å¼‚æ­¥è¯·æ±‚</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//è¯»å–å®Œæˆåï¼Œæ•°æ®ä¿å­˜åœ¨å¯¹è±¡çš„resultå±æ€§ä¸­</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>æ§åˆ¶å°ä¸ºå½“å‰æ‰€ä¼ æ–‡ä»¶çš„base64ç¼–ç è¡¨ç¤ºã€‚ç”±äºåª’ä½“æ–‡ä»¶çš„srcå±æ€§ï¼Œå¯ä»¥é€šè¿‡é‡‡ç”¨ç½‘ç»œåœ°å€æˆ–base64çš„æ–¹å¼æ˜¾ç¤ºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨readAsDataURLå®ç°å¯¹å›¾ç‰‡çš„é¢„è§ˆã€‚</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;inputBox&quot;</span> <span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;img&quot;</span><span class="token operator">&gt;</span>


<span class="token keyword">var</span> inputBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;inputBox&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
inputBox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>inputBox<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘èµ·å¼‚æ­¥è¯·æ±‚</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//è¯»å–å®Œæˆåï¼Œå°†ç»“æœèµ‹å€¼ç»™imgçš„src</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>result
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>å¦‚ä¸Šï¼Œåªéœ€å°†è¯»å–çš„ç»“æœèµ‹ç»™å›¾ç‰‡çš„srcå±æ€§ï¼Œå³å¯é¢„è§ˆå›¾ç‰‡ï¼š<br> <img src="/H5/FileReader6.png" alt="FileReader6" style="margin:10px auto"><br>
readAsText(file,encoding)å¯æŒ‰æŒ‡å®šç¼–ç æ–¹å¼è¯»å–æ–‡ä»¶ï¼Œä½†è¯»å–æ–‡ä»¶çš„å•ä½æ˜¯å­—ç¬¦ï¼Œæ•…å¯¹äºæ–‡æœ¬æ–‡ä»¶ï¼Œåªè¦æŒ‰è§„å®šçš„ç¼–ç æ–¹å¼è¯»å–å³å¯ï¼›è€Œå¯¹äºåª’ä½“æ–‡ä»¶ï¼ˆå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ï¼‰ï¼Œå…¶å†…éƒ¨ç»„æˆå¹¶ä¸æ˜¯æŒ‰å­—ç¬¦æ’åˆ—ï¼Œæ•…é‡‡ç”¨readAsTextè¯»å–ï¼Œä¼šäº§ç”Ÿä¹±ç ï¼Œå› æ­¤ä¸æ˜¯æœ€ç†æƒ³çš„è¯»å–æ–‡ä»¶çš„æ–¹å¼ã€‚</p> <div class="tip custom-block"><p class="custom-block-title">äº‹ä»¶</p> <p>onabort	å½“è¯»å–æ“ä½œè¢«ä¸­æ­¢æ—¶è°ƒç”¨
onerror	å½“è¯»å–æ“ä½œå‘ç”Ÿé”™è¯¯æ—¶è°ƒç”¨
onload	å½“è¯»å–æ“ä½œæˆåŠŸå®Œæˆæ—¶è°ƒç”¨
onloadend	å½“è¯»å–æ“ä½œå®Œæˆæ—¶è°ƒç”¨ï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥
onloadstart	å½“è¯»å–æ“ä½œå¼€å§‹æ—¶è°ƒç”¨
onprogress	åœ¨è¯»å–æ•°æ®è¿‡ç¨‹ä¸­å‘¨æœŸæ€§è°ƒç”¨</p></div> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> inputBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;inputBox&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
inputBox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>inputBox<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘èµ·å¼‚æ­¥è¯·æ±‚</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;åŠ è½½æˆåŠŸ&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onloadstart</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;å¼€å§‹åŠ è½½&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onloadend</span><span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;åŠ è½½ç»“æŸ&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onprogress</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    count<span class="token operator">++</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;åŠ è½½ä¸­&quot;</span><span class="token operator">+</span>count<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><img src="/H5/FileReader7.png" alt="FileReader7" style="margin:10px auto"> <p>æ¯è¿‡50mså·¦å³ï¼Œå°±ä¼šè§¦å‘ä¸€æ¬¡progressäº‹ä»¶ï¼Œå¯¹äºè¾ƒå¤§çš„æ–‡ä»¶å¯ä»¥åˆ©ç”¨progresså®ç°è¿›åº¦æ¡ï¼›onloadäº‹ä»¶åœ¨onloadendä¹‹å‰è§¦å‘ã€‚<br>
ç”±äºç§ç§åŸå› æ— æ³•è¯»å–æ–‡ä»¶æ—¶ï¼Œä¼šè§¦å‘erroräº‹ä»¶ã€‚è§¦å‘erroräº‹ä»¶æ—¶ï¼Œç›¸å…³ä¿¡æ¯ä¿å­˜åœ¨FileReaderå¯¹è±¡çš„errorå±æ€§ä¸­ï¼Œè¿™ä¸ªå±æ€§å°†ä¿å­˜ä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤å¯¹è±¡åªæœ‰ä¸€ä¸ªå±æ€§codeï¼Œå³é”™è¯¯ç ã€‚1è¡¨ç¤ºæœªæ‰¾åˆ°æ–‡ä»¶ï¼Œ2è¡¨ç¤ºå®‰å…¨æ€§é”™è¯¯ï¼Œ3è¡¨ç¤ºè¯»å–ä¸­æ–­ï¼Œ4è¡¨ç¤ºæ–‡ä»¶ä¸å¯è¯»ï¼Œ5è¡¨ç¤ºç¼–ç é”™è¯¯ã€‚<br>
å¦‚æœæƒ³ä¸­æ–­è¯»å–è¿‡ç¨‹ï¼Œå¯ä»¥è°ƒç”¨abortæ–¹æ³•ï¼Œå°±ä¼šè§¦å‘abortäº‹ä»¶ã€‚<br>
æ— è®ºè§¦å‘loadï¼Œerrorï¼Œabortäº‹ä»¶ä¸­å“ªä¸€ä¸ªï¼Œæœ€ç»ˆéƒ½ä¼šè§¦å‘loadendäº‹ä»¶ã€‚</p> <blockquote><p>fileåˆ†å‰²æ–‡ä»¶æ–¹æ³•slice<br>
å®ç°åˆ†æ®µè¯»å–</p></blockquote> <h2 id="websocke"><a href="#websocke" aria-hidden="true" class="header-anchor">#</a> WebSocke</h2> <div class="tip custom-block"><p class="custom-block-title">WebSocket æ˜¯ä»€ä¹ˆï¼Ÿ</p> <p>WebSocket æ˜¯ä¸€ç§ç½‘ç»œé€šä¿¡åè®®ã€‚RFC6455 å®šä¹‰äº†å®ƒçš„é€šä¿¡æ ‡å‡†ã€‚<br>
WebSocket æ˜¯ HTML5 å¼€å§‹æä¾›çš„ä¸€ç§åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®®ã€‚</p></div> <div class="tip custom-block"><p class="custom-block-title">ä¸ºä»€ä¹ˆéœ€è¦ WebSocket ï¼Ÿ</p> <p>äº†è§£è®¡ç®—æœºç½‘ç»œåè®®çš„äººï¼Œåº”è¯¥éƒ½çŸ¥é“ï¼šHTTP åè®®æ˜¯ä¸€ç§æ— çŠ¶æ€çš„ã€æ— è¿æ¥çš„ã€å•å‘çš„åº”ç”¨å±‚åè®®ã€‚å®ƒé‡‡ç”¨äº†è¯·æ±‚/å“åº”æ¨¡å‹ã€‚é€šä¿¡è¯·æ±‚åªèƒ½ç”±å®¢æˆ·ç«¯å‘èµ·ï¼ŒæœåŠ¡ç«¯å¯¹è¯·æ±‚åšå‡ºåº”ç­”å¤„ç†ã€‚<br>
è¿™ç§é€šä¿¡æ¨¡å‹æœ‰ä¸€ä¸ªå¼Šç«¯ï¼šHTTP åè®®æ— æ³•å®ç°æœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘èµ·æ¶ˆæ¯ã€‚<br>
è¿™ç§å•å‘è¯·æ±‚çš„ç‰¹ç‚¹ï¼Œæ³¨å®šäº†å¦‚æœæœåŠ¡å™¨æœ‰è¿ç»­çš„çŠ¶æ€å˜åŒ–ï¼Œå®¢æˆ·ç«¯è¦è·çŸ¥å°±éå¸¸éº»çƒ¦ã€‚å¤§å¤šæ•° Web åº”ç”¨ç¨‹åºå°†é€šè¿‡é¢‘ç¹çš„å¼‚æ­¥JavaScriptå’ŒXMLï¼ˆAJAXï¼‰è¯·æ±‚å®ç°é•¿è½®è¯¢ã€‚è½®è¯¢çš„æ•ˆç‡ä½ï¼Œéå¸¸æµªè´¹èµ„æºï¼ˆå› ä¸ºå¿…é¡»ä¸åœè¿æ¥ï¼Œæˆ–è€… HTTP è¿æ¥å§‹ç»ˆæ‰“å¼€ï¼‰ã€‚<br>
å› æ­¤ï¼Œå·¥ç¨‹å¸ˆä»¬ä¸€ç›´åœ¨æ€è€ƒï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚WebSocket å°±æ˜¯è¿™æ ·å‘æ˜çš„ã€‚WebSocket è¿æ¥å…è®¸å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œå…¨åŒå·¥é€šä¿¡ï¼Œä»¥ä¾¿ä»»ä¸€æ–¹éƒ½å¯ä»¥é€šè¿‡å»ºç«‹çš„è¿æ¥å°†æ•°æ®æ¨é€åˆ°å¦ä¸€ç«¯ã€‚WebSocket åªéœ€è¦å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œå°±å¯ä»¥ä¸€ç›´ä¿æŒè¿æ¥çŠ¶æ€ã€‚è¿™ç›¸æ¯”äºè½®è¯¢æ–¹å¼çš„ä¸åœå»ºç«‹è¿æ¥æ˜¾ç„¶æ•ˆç‡è¦å¤§å¤§æé«˜ã€‚</p></div> <img src="/H5/websocket1.png" alt="websocket1" style="margin:10px auto"> <div class="tip custom-block"><p class="custom-block-title">WebSocket å¦‚ä½•å·¥ä½œï¼Ÿ</p> <p>Webæµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½å¿…é¡»å®ç° WebSockets åè®®æ¥å»ºç«‹å’Œç»´æŠ¤è¿æ¥ã€‚ç”±äº WebSockets è¿æ¥é•¿æœŸå­˜åœ¨ï¼Œä¸å…¸å‹çš„HTTPè¿æ¥ä¸åŒï¼Œå¯¹æœåŠ¡å™¨æœ‰é‡è¦çš„å½±å“ã€‚åŸºäºå¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹çš„æœåŠ¡å™¨æ— æ³•é€‚ç”¨äº WebSocketsï¼Œå› ä¸ºå®ƒæ—¨åœ¨æ‰“å¼€è¿æ¥ï¼Œå°½å¯èƒ½å¿«åœ°å¤„ç†è¯·æ±‚ï¼Œç„¶åå…³é—­è¿æ¥ã€‚ä»»ä½•å®é™…çš„ WebSockets æœåŠ¡å™¨ç«¯å®ç°éƒ½éœ€è¦ä¸€ä¸ªå¼‚æ­¥æœåŠ¡å™¨ã€‚</p></div> <p><em>åœ¨å®¢æˆ·ç«¯ï¼Œæ²¡æœ‰å¿…è¦ä¸º WebSockets ä½¿ç”¨ JavaScript åº“ã€‚å®ç° WebSockets çš„ Web æµè§ˆå™¨å°†é€šè¿‡ WebSockets å¯¹è±¡å…¬å¼€æ‰€æœ‰å¿…éœ€çš„å®¢æˆ·ç«¯åŠŸèƒ½ï¼ˆä¸»è¦æŒ‡æ”¯æŒ Html5 çš„æµè§ˆå™¨ï¼‰ã€‚</em><br> <strong>å®¢æˆ·ç«¯ API</strong><br>
ä»¥ä¸‹ API ç”¨äºåˆ›å»º WebSocket å¯¹è±¡ã€‚</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> Socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>protocol<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä»¥ä¸Šä»£ç ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•° url, æŒ‡å®šè¿æ¥çš„ URLã€‚ç¬¬äºŒä¸ªå‚æ•° protocol æ˜¯å¯é€‰çš„ï¼ŒæŒ‡å®šäº†å¯æ¥å—çš„å­åè®®ã€‚</p> <div class="tip custom-block"><p class="custom-block-title">WebSocket å±æ€§</p> <p><em>Socket.readyState</em><br>
åªè¯»å±æ€§ readyState è¡¨ç¤ºè¿æ¥çŠ¶æ€ï¼Œå¯ä»¥æ˜¯ä»¥ä¸‹å€¼ï¼š0 - è¡¨ç¤ºè¿æ¥å°šæœªå»ºç«‹ã€‚1 - è¡¨ç¤ºè¿æ¥å·²å»ºç«‹ï¼Œå¯ä»¥è¿›è¡Œé€šä¿¡ã€‚2 - è¡¨ç¤ºè¿æ¥æ­£åœ¨è¿›è¡Œå…³é—­ã€‚3 - è¡¨ç¤ºè¿æ¥å·²ç»å…³é—­æˆ–è€…è¿æ¥ä¸èƒ½æ‰“å¼€ã€‚<br> <em>Socket.bufferedAmount</em><br>
åªè¯»å±æ€§ bufferedAmount å·²è¢« send() æ”¾å…¥æ­£åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ä¼ è¾“ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å‘å‡ºçš„ UTF-8 æ–‡æœ¬å­—èŠ‚æ•°ã€‚</p></div> <div class="tip custom-block"><p class="custom-block-title">WebSocket äº‹ä»¶</p> <p>open-------Socket.onopen------è¿æ¥å»ºç«‹æ—¶è§¦å‘<br>
message---Socket.onmessage--å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡ç«¯æ•°æ®æ—¶è§¦å‘<br>
error-------Socket.onerror-------é€šä¿¡å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘<br>
close-------Socket.onclose-------è¿æ¥å…³é—­æ—¶è§¦å‘</p></div> <div class="tip custom-block"><p class="custom-block-title">WebSocket æ–¹æ³•</p> <p>Socket.send()------ä½¿ç”¨è¿æ¥å‘é€æ•°æ®<br>
Socket.close()------å…³é—­è¿æ¥</p></div> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// åˆå§‹åŒ–ä¸€ä¸ª WebSocket å¯¹è±¡</span>
<span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;ws://localhost:9998/echo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å»ºç«‹ web socket è¿æ¥æˆåŠŸè§¦å‘äº‹ä»¶</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä½¿ç”¨ send() æ–¹æ³•å‘é€æ•°æ®</span>
  ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;å‘é€æ•°æ®&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;æ•°æ®å‘é€ä¸­...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æ¥æ”¶æœåŠ¡ç«¯æ•°æ®æ—¶è§¦å‘äº‹ä»¶</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> received_msg <span class="token operator">=</span> evt<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;æ•°æ®å·²æ¥æ”¶...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æ–­å¼€ web socket è¿æ¥æˆåŠŸè§¦å‘äº‹ä»¶</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;è¿æ¥å·²å…³é—­...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">WebSocket æœåŠ¡ç«¯</p> <p>WebSocket åœ¨æœåŠ¡ç«¯çš„å®ç°éå¸¸ä¸°å¯Œã€‚Node.jsã€Javaã€C++ã€Python ç­‰å¤šç§è¯­è¨€éƒ½æœ‰è‡ªå·±çš„è§£å†³æ–¹æ¡ˆã€‚<br>
å­¦ä¹ nodeæ—¶è¡¥å……æ­¤éƒ¨åˆ†</p></div> <div class="danger custom-block"><p class="custom-block-title">å­¦ä¹ ç§»åŠ¨ç«¯æ—¶å†è¡¥å……</p> <p>geolocation
devicemotion
deviceorientation</p></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.6a253733.js" defer></script><script src="/assets/js/14.ef8b2dda.js" defer></script>
  </body>
</html>
