<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES6å­¦ä¹ ç¬”è®° ğŸ“‘ | Make Innovations</title>
    <meta name="description" content=" ">
    <link rel="icon" href="/bob.png">
    
    <link rel="preload" href="/assets/css/0.styles.522f73f5.css" as="style"><link rel="preload" href="/assets/js/app.6a253733.js" as="script"><link rel="preload" href="/assets/js/9.3dabbb14.js" as="script"><link rel="prefetch" href="/assets/js/10.e3b3ae83.js"><link rel="prefetch" href="/assets/js/11.1743e1e9.js"><link rel="prefetch" href="/assets/js/12.e2a2f476.js"><link rel="prefetch" href="/assets/js/13.8cab6c69.js"><link rel="prefetch" href="/assets/js/14.ef8b2dda.js"><link rel="prefetch" href="/assets/js/15.fb2d2713.js"><link rel="prefetch" href="/assets/js/16.7983a61f.js"><link rel="prefetch" href="/assets/js/17.dec508bf.js"><link rel="prefetch" href="/assets/js/18.db1c2439.js"><link rel="prefetch" href="/assets/js/19.5aa44128.js"><link rel="prefetch" href="/assets/js/2.f32d8142.js"><link rel="prefetch" href="/assets/js/20.b6a814c1.js"><link rel="prefetch" href="/assets/js/21.4f2dad75.js"><link rel="prefetch" href="/assets/js/3.ab30b814.js"><link rel="prefetch" href="/assets/js/4.99255317.js"><link rel="prefetch" href="/assets/js/5.871beb45.js"><link rel="prefetch" href="/assets/js/6.dd899a8f.js"><link rel="prefetch" href="/assets/js/7.ca4fe73c.js"><link rel="prefetch" href="/assets/js/8.7399e17f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.522f73f5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Make Innovations</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">ä¸»é¡µ</a></div><div class="nav-item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">åˆ†äº«</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fenxiang/blog.html" class="nav-link">å¤§ç¥åšå®¢</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/wenzhang.html" class="nav-link">æŠ€æœ¯æ–‡ç« </a></li><li class="dropdown-item"><!----> <a href="/fenxiang/gistfile.html" class="nav-link">Emojiè¡¨æƒ…</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/ziyuan.html" class="nav-link">èµ„æº</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">å­¦ä¹ </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å‰ç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/html5.html" class="nav-link">HTML5</a></li><li class="dropdown-subitem"><a href="/learn/css3.html" class="nav-link">CSS3</a></li><li class="dropdown-subitem"><a href="/learn/js.html" class="nav-link">js</a></li><li class="dropdown-subitem"><a href="/learn/jQuery.html" class="nav-link">jQuery</a></li><li class="dropdown-subitem"><a href="/learn/ES6.html" class="nav-link router-link-exact-active router-link-active">ES6</a></li><li class="dropdown-subitem"><a href="/learn/webpack.html" class="nav-link">webpack</a></li><li class="dropdown-subitem"><a href="/learn/wangluo.html" class="nav-link">ç½‘ç»œ</a></li><li class="dropdown-subitem"><a href="/learn/git.html" class="nav-link">git</a></li><li class="dropdown-subitem"><a href="/learn/vue.html" class="nav-link">vue</a></li></ul></li><li class="dropdown-item"><h4>åç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/node.html" class="nav-link">node</a></li><li class="dropdown-subitem"><a href="/learn/MySQL.html" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/learn/MongoDB.html" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">å…³äº</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">ä¸»é¡µ</a></div><div class="nav-item"><a href="https://github.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">åˆ†äº«</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fenxiang/blog.html" class="nav-link">å¤§ç¥åšå®¢</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/wenzhang.html" class="nav-link">æŠ€æœ¯æ–‡ç« </a></li><li class="dropdown-item"><!----> <a href="/fenxiang/gistfile.html" class="nav-link">Emojiè¡¨æƒ…</a></li><li class="dropdown-item"><!----> <a href="/fenxiang/ziyuan.html" class="nav-link">èµ„æº</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">å­¦ä¹ </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å‰ç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/html5.html" class="nav-link">HTML5</a></li><li class="dropdown-subitem"><a href="/learn/css3.html" class="nav-link">CSS3</a></li><li class="dropdown-subitem"><a href="/learn/js.html" class="nav-link">js</a></li><li class="dropdown-subitem"><a href="/learn/jQuery.html" class="nav-link">jQuery</a></li><li class="dropdown-subitem"><a href="/learn/ES6.html" class="nav-link router-link-exact-active router-link-active">ES6</a></li><li class="dropdown-subitem"><a href="/learn/webpack.html" class="nav-link">webpack</a></li><li class="dropdown-subitem"><a href="/learn/wangluo.html" class="nav-link">ç½‘ç»œ</a></li><li class="dropdown-subitem"><a href="/learn/git.html" class="nav-link">git</a></li><li class="dropdown-subitem"><a href="/learn/vue.html" class="nav-link">vue</a></li></ul></li><li class="dropdown-item"><h4>åç«¯</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/learn/node.html" class="nav-link">node</a></li><li class="dropdown-subitem"><a href="/learn/MySQL.html" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/learn/MongoDB.html" class="nav-link">MongoDB</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">å…³äº</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>ES6å­¦ä¹ ç¬”è®° ğŸ“‘</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/learn/ES6.html#babelå·¥å…·æœ¬åœ°ä½¿ç”¨" class="sidebar-link">babelå·¥å…·æœ¬åœ°ä½¿ç”¨</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹let" class="sidebar-link">å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹let</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹const" class="sidebar-link">å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹const</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#spreed-restå³-ï¼ˆes6ï¼‰" class="sidebar-link">spreed&amp;restå³ ...ï¼ˆES6ï¼‰</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#spreed-restï¼ˆes7ï¼‰" class="sidebar-link">spreed&amp;restï¼ˆES7ï¼‰</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#destructuringè§£æ„" class="sidebar-link">destructuringè§£æ„</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#ç®­å¤´å‡½æ•°" class="sidebar-link">ç®­å¤´å‡½æ•°</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es5ä¹‹object-defineproperty" class="sidebar-link">ES5ä¹‹Object.defineProperty</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#æ•°æ®åŠ«æŒ" class="sidebar-link">æ•°æ®åŠ«æŒ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6ä¹‹proxyå’Œreflect" class="sidebar-link">ES6ä¹‹Proxyå’ŒReflect</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6ä¹‹class" class="sidebar-link">ES6ä¹‹class</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es7ä¹‹classææ¡ˆå±æ€§-è£…é¥°å™¨" class="sidebar-link">ES7ä¹‹classææ¡ˆå±æ€§-----è£…é¥°å™¨</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6ä¹‹set" class="sidebar-link">ES6ä¹‹set</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6ä¹‹map" class="sidebar-link">ES6ä¹‹map</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6ä¹‹promiseä½¿ç”¨" class="sidebar-link">ES6ä¹‹promiseä½¿ç”¨</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6ä¹‹promise-ç”¨es5æ¨¡æ‹Ÿå®ç°" class="sidebar-link">ES6ä¹‹promise----ç”¨ES5æ¨¡æ‹Ÿå®ç°</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6ä¹‹iterator" class="sidebar-link">ES6ä¹‹Iterator</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6ä¹‹generator" class="sidebar-link">ES6ä¹‹Generator</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es7ä¹‹async-await" class="sidebar-link">ES7ä¹‹async + await</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/learn/ES6.html#es6å…¶å®ƒå†…å®¹æ‰©å±•-ä¸è€å¸ˆ" class="sidebar-link">ES6å…¶å®ƒå†…å®¹æ‰©å±•(ä¸è€å¸ˆ)</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="es6å­¦ä¹ ç¬”è®°"><a href="#es6å­¦ä¹ ç¬”è®°" aria-hidden="true" class="header-anchor">#</a> ES6å­¦ä¹ ç¬”è®° ğŸ“‘</h1> <h2 id="babelå·¥å…·æœ¬åœ°ä½¿ç”¨"><a href="#babelå·¥å…·æœ¬åœ°ä½¿ç”¨" aria-hidden="true" class="header-anchor">#</a> babelå·¥å…·æœ¬åœ°ä½¿ç”¨</h2> <ol><li><p>åœ¨çº¿:<br> <img src="/ES6/babel1.jpg" alt="babel1" style="margin:10px auto"></p></li> <li><p>ä¸‹è½½åˆ°æœ¬åœ°(ä¸‹è½½åˆ°é¡¹ç›®é‡Œ):npm init -y(åˆå§‹åŒ–,ä¸”ä¸ä¼šå‡ºç°è¯¢é—®ï¼Œä¹‹åç”Ÿæˆ.jsonæ–‡ä»¶)npm install @babel/core(å®‰è£…babelæ ¸å¿ƒâ€“â€“æŠ½è±¡è¯­æ³•æ ‘)npm install  @babel/preset-env(æ‰€æœ‰æ’ä»¶)npm install @babel/cli(è„šæ‰‹æ¶)</p></li> <li><p>ç¼–å†™.babelrcæ–‡ä»¶(jsonå†™æ³•):<br> <img src="/ES6/babel2.jpg" alt="babel2" style="margin:10px auto"></p></li> <li><p>ES6è½¬æ¢ä¸ºES5çš„æ–¹æ³•<br> <img src="/ES6/babel3.jpg" alt="babel3" style="margin:10px auto"><br>
åé¢åŠ â€“â€“watchå°±å¯ä»¥å®æ—¶è½¬æ¢</p></li></ol> <h2 id="å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹let"><a href="#å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹let" aria-hidden="true" class="header-anchor">#</a> å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹let</h2> <ol><li>let ä¸ä¼šå£°æ˜æå‡<strong>ä¸å¯ä»¥é‡å¤å£°æ˜</strong>åŒä¸€å˜é‡</li> <li>let a=10ï¼›æ—¶window.aé‡Œæ²¡æœ‰    var a=10ï¼›æ—¶window.a ==10</li> <li>letæœ‰å…·<strong>æœ‰å—çº§ä½œç”¨åŸŸ</strong>{ è¿™é‡Œçš„letåªèƒ½åœ¨è¿™é‡Œç”¨ }</li> <li>æš‚æ—¶æ€§æ­»åŒºï¼šä¼šå…ˆæ‰«æä½œç”¨åŸŸå†…çš„å˜é‡ï¼Œä½†ä¸å£°æ˜æå‡ï¼Œå¦‚æœå…ˆç”¨å˜é‡å†å£°æ˜ï¼Œå°±ä¼šæŠ¥é”™</li> <li>å¯ä»¥<strong>è§£å†³forå¾ªç¯çš„é—­åŒ…é—®é¢˜</strong></li></ol> <h2 id="å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹const"><a href="#å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹const" aria-hidden="true" class="header-anchor">#</a> å˜é‡å£°æ˜æ–°å½¢å¼ä¹‹const</h2> <ol><li>constå£°æ˜çš„æ˜¯å¸¸é‡ const a = 10    aé‡Œçš„å€¼ä¸èƒ½è¢«æ”¹å˜;  å¦‚æœ const aï¼›    a = 10ï¼›ä¼šæŠ¥é”™ï¼›</li> <li>åœ¨ç¼–å†™æ—¶å…ˆç”¨const   å¦‚æœæœ‰å¿…è¦æ‰ç”¨letã€</li> <li>å­˜å‚¨å¸¸é‡çš„ç©ºé—´é‡Œçš„å€¼ä¸èƒ½å‘ç”Ÿæ”¹å˜ ä¾‹å¦‚ä¸Šé¢1é‡Œçš„ä¾‹å­ï¼›ä½†æ˜¯const p = {  }ï¼› p.a = 10;è¿™æ—¶å¯¹è±¡é‡Œçš„å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œå› ä¸ºpç©ºé—´é‡Œå­˜çš„æ˜¯å¯¹è±¡çš„åœ°å€ï¼Œåªè¦ä¸ç»™pé‡æ–°èµ‹å€¼å°±è¡Œ</li></ol> <h2 id="spreed-restå³-ï¼ˆes6ï¼‰"><a href="#spreed-restå³-ï¼ˆes6ï¼‰" aria-hidden="true" class="header-anchor">#</a> spreed&amp;restå³ ...ï¼ˆES6ï¼‰</h2> <ol><li>...å±•å¼€å’Œæ”¶é›†è¿ç®—ç¬¦ï¼šæ­¤è¿ç®—ç¬¦åœ¨ä¸åŒåœ°æ–¹ä½¿ç”¨æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œå¯ä»¥ä»å†™å’Œåº¦ä¸¤ä¸ªè§’åº¦åˆ†æã€‚å†™ï¼šæ”¶é›†ä½œç”¨ï¼Œæ”¶é›†åˆ°æ•°ç»„é‡Œ</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¯»ï¼šè¾“å‡ºï¼š1ï¼Œ2ï¼Œ3    å±•å¼€ä½œç”¨  å±•æˆæ•£åˆ—</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span>  arg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>å†™ï¼šå‡½æ•°ä¼ å‚æ—¶ï¼Œå‰é¢å¯ä»¥å†™å‚æ•°ï¼Œæœ€åå†™æ‰©å±•è¿ç®—ç¬¦çš„å‚æ•°ï¼Œæ‰©å±•è¿ç®—ç¬¦çš„å‚æ•°åä¸èƒ½å†å†™å‚æ•°ï¼Œå³æ‰©å±•è¿ç®—ç¬¦çš„å‚æ•°åªèƒ½ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ï¼›</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token operator">...</span>arg<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="spreed-restï¼ˆes7ï¼‰"><a href="#spreed-restï¼ˆes7ï¼‰" aria-hidden="true" class="header-anchor">#</a> spreed&amp;restï¼ˆES7ï¼‰</h2> <ol><li>ä¸‹é¢çš„ä¾‹å­æ˜¯æµ…å…‹éš†<br> <img src="/ES6/spreed&amp;rest1.jpg" alt="spreed&rest1" style="margin:10px auto"></li> <li>ä¸‹é¢ä¾‹å­æ¨¡ä»¿æ·±å…‹éš†ï¼Œä½†æ˜¯å¦‚æœè¢«å…‹éš†å¯¹è±¡å±‚çº§è¿‡å¤šï¼Œç¼–å†™ä¼šç‰¹åˆ«å¤æ‚<br> <img src="/ES6/spreed&amp;rest2.jpg" alt="spreed&rest2" style="margin:10px auto"></li> <li>æ•°ç»„çš„æ·±å…‹éš†æ–¹æ³•<br> <img src="/ES6/spreed&amp;rest3.jpg" alt="spreed&rest3" style="margin:10px auto"></li> <li>æ·±å…‹éš†æœ€å¥½è¿˜æ˜¯åŸç”ŸJavaScriptå†™çš„å…‹éš†å‡½æ•°</li> <li>ES6æ–°çš„æµ…å…‹éš†æ–¹æ³•<br> <img src="/ES6/spreed&amp;rest4.jpg" alt="spreed&rest4" style="margin:10px auto"></li></ol> <h2 id="destructuringè§£æ„"><a href="#destructuringè§£æ„" aria-hidden="true" class="header-anchor">#</a> destructuringè§£æ„</h2> <ol><li>å¯¹è±¡çš„è§£æ„</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>    name<span class="token punctuation">:</span><span class="token string">'lxl'</span><span class="token punctuation">,</span>    age<span class="token punctuation">:</span> <span class="token string">'18'</span>   <span class="token punctuation">}</span><span class="token punctuation">;</span>      
<span class="token keyword">const</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> nameO<span class="token punctuation">,</span> age<span class="token punctuation">:</span> ageO<span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>é»˜è®¤èµ‹å€¼ï¼š</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> nameO<span class="token punctuation">,</span> age<span class="token punctuation">:</span> ageO<span class="token punctuation">,</span> sex <span class="token operator">=</span> <span class="token string">'male'</span><span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="3"><li>è§£æ„æ•°ç»„ï¼š</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>å¯ä»¥     <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">]</span> <span class="token operator">=</span> arr    	
è¿˜å¯ä»¥ <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span> x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> z<span class="token punctuation">}</span> <span class="token operator">=</span> arr
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="4"><li>è§£æ„èµ‹å€¼æ—¶ï¼ŒæŸäº›å‚æ•°ä¸è¦å¯ä»¥ä¸å†™ï¼Œä½†ç»“æ„ä¸èƒ½çœç•¥</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'lxl'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>	<span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="5"><li>è§£æ„èµ‹å€¼ä¸»è¦æ˜¯è§£å†³å¤æ‚æ•°æ®æ“ä½œæ—¶çš„ç®€åŒ–ã€‚</li></ol> <h2 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" aria-hidden="true" class="header-anchor">#</a> ç®­å¤´å‡½æ•°</h2> <ol><li>ç®­å¤´å‡½æ•°çš„ç‰¹ç‚¹ï¼šä¸ç”¨å†™functionå…³é”®å­—ï¼›<strong>åªèƒ½ä½œä¸ºå‡½æ•°</strong>ä½¿ç”¨ä¸èƒ½newï¼Œ<strong>æ²¡æœ‰åŸå‹</strong>ï¼›å‚æ•°ä¸èƒ½é‡å¤å‘½åï¼›è¿”å›å€¼å¯ä»¥ä¸å†™returnï¼Œä½†æ˜¯æœ‰æ—¶éœ€è¦é…åˆ{}ï¼›<strong>å†…éƒ¨arguments  thisç”±å®šä¹‰æ—¶å¤–å›´æœ€æ¥è¿‘ä¸€å±‚çš„éç®­å¤´å‡½æ•°çš„arguments  thiså†³å®šå…¶å€¼ã€‚</strong></li> <li>å£°æ˜ç®­å¤´å‡½æ•°å¿…é¡»è¦æœ‰å˜é‡ã€å¯¹è±¡æˆ–æ•°ç»„ç­‰å»å­˜ç®­å¤´å‡½æ•°ã€‚<br> <img src="/ES6/arrow1.jpg" alt="arrow1" style="margin:10px auto"> <img src="/ES6/arrow2.jpg" alt="arrow2" style="margin:10px auto"><br>
å¯¹è±¡ä¸å¯ä»¥ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œåº”è¯¥åœ¨å¯¹è±¡å¤–é¢åŠ ä¸Š()å˜æˆè¡¨è¾¾å¼:<br> <img src="/ES6/arrow3.jpg" alt="arrow3" style="margin:10px auto"></li> <li>ç®€å†™åµŒå¥—å‡½æ•°ï¼šç®­å¤´å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå‚æ•°å¤–é¢çš„æ‹¬å·å¯ä»¥çœç•¥;  ç®­å¤´å‡½æ•°é‡Œå½¢å‚ä¸èƒ½ç›¸åŒ(a, a)æ˜¯é”™çš„ã€‚<br> <img src="/ES6/arrow4.jpg" alt="arrow4" style="margin:10px auto"> <img src="/ES6/arrow5.jpg" alt="arrow5" style="margin:10px auto"><br>
ä¸Šé¢æ˜¯ç®­å¤´å‡½æ•°ç®€å†™çš„ï¼ŒåŸç†å¦‚ä¸‹<br> <img src="/ES6/arrow6.jpg" alt="arrow6" style="margin:10px auto"></li> <li>argumentsçš„ç‰¹ç‚¹<br> <img src="/ES6/arrow7.png" alt="arrow7" style="margin:10px auto"> <img src="/ES6/arrow8.png" alt="arrow8" style="margin:10px auto"></li> <li>thisçš„è¯´æ˜<br> <img src="/ES6/arrow9.png" alt="arrow9" style="margin:10px auto"><br> <img src="/ES6/arrow10.png" alt="arrow10" style="margin:10px auto"><br> <img src="/ES6/arrow11.png" alt="arrow11" style="margin:10px auto"> <img src="/ES6/arrow12.png" alt="arrow12" style="margin:10px auto"> <img src="/ES6/arrow13.png" alt="arrow13" style="margin:10px auto"> <img src="/ES6/arrow14.png" alt="arrow14" style="margin:10px auto"> <img src="/ES6/arrow15.png" alt="arrow15" style="margin:10px auto"></li></ol> <h2 id="es5ä¹‹object-defineproperty"><a href="#es5ä¹‹object-defineproperty" aria-hidden="true" class="header-anchor">#</a> ES5ä¹‹Object.defineProperty</h2> <ol><li><p>Object.definePropertyæ¦‚å¿µ
<img src="/ES6/defineProperty1.png" alt="defineProperty1" style="margin:10px auto"> <img src="/ES6/defineProperty2.png" alt="defineProperty2" style="margin:10px auto"></p></li> <li><p>æœ‰value  å’Œ writableå°±ä¸èƒ½æœ‰setï¼ˆï¼‰å’Œgetï¼ˆï¼‰ï¼Œæœ‰setï¼ˆï¼‰å’Œgetï¼ˆï¼‰å°±ä¸èƒ½æœ‰value  å’Œ writable
<img src="/ES6/defineProperty3.png" alt="defineProperty3" style="margin:10px auto"> <img src="/ES6/defineProperty4.png" alt="defineProperty4" style="margin:10px auto"> <img src="/ES6/defineProperty5.png" alt="defineProperty5" style="margin:10px auto"></p></li></ol> <h2 id="æ•°æ®åŠ«æŒ"><a href="#æ•°æ®åŠ«æŒ" aria-hidden="true" class="header-anchor">#</a> æ•°æ®åŠ«æŒ</h2> <ol><li>åŸç”Ÿjsæ•°æ®åŠ«æŒå†™æ³•</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;ie=edge&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> id<span class="token operator">=</span><span class="token string">'demo'</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;show&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
        <span class="token comment">//é’ˆå¯¹å¯¹è±¡çš„æ•°æ®ç›‘æµ‹</span>
    <span class="token keyword">var</span> oDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'show'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–div</span>
    <span class="token keyword">var</span> oInput <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'demo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–input</span>

    <span class="token keyword">var</span> oData <span class="token operator">=</span> <span class="token punctuation">{</span>
        valueObj<span class="token punctuation">:</span><span class="token punctuation">{</span>
            value<span class="token punctuation">:</span> <span class="token string">'duyi'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    oInput<span class="token punctuation">.</span><span class="token function-variable function">oninput</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//é€šè¿‡oninputäº‹ä»¶ç›‘æµ‹inputé‡Œçš„å€¼æ˜¯å¦æœ‰å˜åŒ–</span>
        oData<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span><span class="token comment">//å¦‚æœæœ‰å˜åŒ–å°±æŠŠå€¼èµ‹ç»™æ•°æ®æ± oData</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">upDate</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        oDiv<span class="token punctuation">.</span>innerText <span class="token operator">=</span> oData<span class="token punctuation">.</span>valueObj<span class="token punctuation">.</span>value<span class="token punctuation">;</span><span class="token comment">//å°†æ•°æ®èµ‹å€¼ç»™div</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// upDate ();</span>
    <span class="token comment">//ç›‘æµ‹ æ•°æ®æ± æ•°æ®oDataçš„æŸä¸ªå±æ€§æ˜¯å¦æœ‰å˜åŒ–</span>
    <span class="token keyword">function</span> <span class="token function">Observer</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data <span class="token operator">||</span> <span class="token keyword">typeof</span> data <span class="token operator">!=</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœæ²¡ä¼ æ¥æ•°æ®å¯¹è±¡æˆ–è€…ä¼ æ¥çš„æ˜¯undefinedå°±ç›´æ¥è¿”å›å‡ºå»</span>
            <span class="token keyword">return</span> data<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//éå†dataé‡Œæ‰€æœ‰å±æ€§</span>
            <span class="token function">definedRective</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">//ç›‘æµ‹æ–¹æ³•</span>
    <span class="token keyword">function</span> <span class="token function">definedRective</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//åˆ©ç”¨é€’å½’çš„æ–¹æ³•åˆ¤æ–­valæ˜¯ä¸æ˜¯å¯¹è±¡</span>
        <span class="token function">Observer</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ›´æ”¹å¯¹è±¡å±æ€§æ—¶ï¼Œå°±ä¼šè§¦å‘getå’Œsetæ–¹æ³•ï¼Œå°±èƒ½å®ç°ç›‘æµ‹å±æ€§å€¼çš„ç›®çš„</span>
        object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token keyword">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//è¯»æ—¶è§¦å‘</span>
                <span class="token keyword">return</span> val<span class="token punctuation">;</span><span class="token comment">//è¿™é‡Œå½¢æˆäº†é—­åŒ…</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">set</span> <span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å†™æ—¶è§¦å‘</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>newVal <span class="token operator">==</span> val<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœä¼ è¿›æ¥çš„å€¼å’ŒåŸæ¥å€¼ä¸€æ ·å°±ä¸éœ€è¦æ”¹å˜</span>
                val <span class="token operator">==</span> newVal<span class="token punctuation">;</span><span class="token comment">//å°†æ”¹å˜å€¼èµ‹å€¼ç»™æ•°æ®æ± val</span>
                <span class="token function">upDate</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">Observer</span><span class="token punctuation">(</span>oData<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//é’ˆå¯¹æ•°ç»„çš„æ•°æ®ç›‘æµ‹</span>
    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>push<span class="token punctuation">}</span> <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">upData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ›´æ–°'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">'push'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        value<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                push<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">upData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><ol start="2"><li>é’ˆå¯¹å¯¹è±¡ã€æ•°ç»„çš„æ•°æ®å˜åŒ–è¿›è¡Œç›‘æµ‹ï¼Œå¹¶èµ‹å€¼ç»™é¡µé¢</li></ol> <h2 id="es6ä¹‹proxyå’Œreflect"><a href="#es6ä¹‹proxyå’Œreflect" aria-hidden="true" class="header-anchor">#</a> ES6ä¹‹Proxyå’ŒReflect</h2> <ol><li>Proxyå’ŒReflectæš‚æ—¶å…¼å®¹æ€§è¾ƒå·®ï¼Œä½¿ç”¨çš„åœ°æ–¹å¾ˆå°‘</li> <li>å¯¹è¦è®¿é—®çš„å¯¹è±¡ã€æ•°ç»„çš„æ–¹æ³•è¿›è¡Œæ”¹å†™ï¼Œ</li> <li>æ¯”æ•°æ®åŠ«æŒçš„å†™æ³•è¦ç®€åŒ–å¾ˆå¤šï¼Œä¸‹é¢çš„æ²¡æœ‰å¯¹å¤šå±‚å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œè¿˜åº”è¯¥å†™é€’å½’
å›¾ç‰‡</li></ol> <h2 id="es6ä¹‹class"><a href="#es6ä¹‹class" aria-hidden="true" class="header-anchor">#</a> ES6ä¹‹class</h2> <ol><li>ç›¸å½“ä¸ES5é‡Œçš„æ„é€ å‡½æ•°ï¼Œä½†è§£å†³äº†åŸæ¥æ„é€ å‡½æ•°çš„ç»§æ‰¿ç­‰é—®é¢˜ã€‚æœ¬è´¨è¿˜æ˜¯å‡½æ•°ã€‚</li> <li>classç”¨æ³•</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Plane</span> <span class="token punctuation">{</span><span class="token comment">//å®šä¹‰classç±»</span>
    <span class="token comment">//ES6ä¸Šåªèƒ½å®šä¹‰é™æ€æ–¹æ³•ï¼Œä¸èƒ½å®šä¹‰é™æ€å±æ€§  static alive = 11ï¼›æ˜¯é”™çš„   ä½†åœ¨ES7ä¸Šæ˜¯å¯ä»¥çš„</span>
    <span class="token keyword">static</span> <span class="token function">alive</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè¿™ä¸ªæ˜¯planeçš„æ–¹æ³•ï¼Œé€šè¿‡Plane.aliveï¼ˆï¼‰è¿›è¡Œè°ƒç”¨ï¼Œä¸æ˜¯åŸå‹ä¸Šçš„æ–¹æ³•</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">constructor</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å®šä¹‰ç§æœ‰å±æ€§</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token operator">||</span> <span class="token string">'æ™®é€šé£æœº'</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>blood <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">fly</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å®šä¹‰åŸå‹ä¸Šçš„æ–¹æ³•</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fly'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//ES6ä¸Šä¸èƒ½åœ¨åŸå‹ä¸ŠåŠ å±æ€§ï¼šnb = 10ï¼›æ˜¯é”™çš„   ä½†åœ¨ES7ä¸Šæ˜¯å¯ä»¥è¿™æ ·å†™ï¼Œä½†æ˜¯æ˜¯ç§æœ‰å±æ€§</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AttackPlane</span> <span class="token keyword">extends</span> <span class="token class-name">Plane</span> <span class="token punctuation">{</span><span class="token comment">//ç»§æ‰¿PlaneåŸå‹å±æ€§</span>
    <span class="token comment">//é™æ€å±æ€§ç»§æ‰¿åï¼Œä¹Ÿæ˜¯ç»§æ‰¿åˆ°AttackPlaneä¸Šçš„</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//ä¼ å‚</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åªæœ‰ç¬¬ä¸€è¡Œå†™è¿™ä¸ªï¼Œæ‰èƒ½ç»§æ‰¿ç§æœ‰å±æ€§ï¼Œå¯ä»¥ä¼ å‚</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>logo <span class="token operator">=</span> <span class="token string">'bob'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">dan</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'biubiu'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> oPa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AttackPlane</span><span class="token punctuation">(</span><span class="token string">'æ”»å‡»'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// var oP = new Plane();//åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¿…é¡»newæ‰èƒ½ç”¨</span>
<span class="token comment">// oP.fly();</span>
<span class="token comment">//classå‡ºæ¥çš„ç±»çš„åŸå‹ï¼Œä¸èƒ½è¢«æšä¸¾</span>
<span class="token comment">//</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><ol start="3"><li>ä¸å­˜åœ¨å£°æ˜æå‡ï¼›æœ‰å–å€¼å‡½æ•°getï¼ˆï¼‰å’Œå­˜å€¼å‡½æ•°setï¼ˆï¼‰æ–¹æ³•ï¼š</li> <li>classçš„ç»§æ‰¿ï¼Œæ³¨æ„äº‹é¡¹ç”¨åˆ°å†çœ‹</li></ol> <h2 id="es7ä¹‹classææ¡ˆå±æ€§-è£…é¥°å™¨"><a href="#es7ä¹‹classææ¡ˆå±æ€§-è£…é¥°å™¨" aria-hidden="true" class="header-anchor">#</a> ES7ä¹‹classææ¡ˆå±æ€§-----è£…é¥°å™¨</h2> <ol><li>å¯¹ç±»ã€ç±»é‡Œçš„ç§æœ‰å±æ€§ã€åŸå‹å±æ€§è¿›è¡Œè£…é¥°ï¼Œæ”¹å˜å…¶åŸæœ‰çš„åŠŸèƒ½</li> <li>ç°é˜¶æ®µä¸»è¦æ˜¯ç”¨äºæ¡†æ¶å¼€å‘ç”¨</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// å¼ ä¸‰</span>
<span class="token keyword">let</span> oInput <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'inp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> oBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

@Skin<span class="token comment">//ä¿®é¥°ä¸€ä¸ªç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Search</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyValue <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    @myReadOnly
    url <span class="token operator">=</span> <span class="token string">'urlA-'</span><span class="token punctuation">;</span><span class="token comment">//è¦è£…é¥°çš„ç§æœ‰å±æ€§ä¸Šä¸€è¡Œï¼Œå†™@+åå­—ï¼Œåœ¨ç±»å¤–é¢å†™å‡½æ•°å¯¹å±æ€§è¿›è¡Œè£…é¥°</span>

    @<span class="token function">dealData</span><span class="token punctuation">(</span><span class="token string">'å¼ ä¸‰'</span><span class="token punctuation">)</span><span class="token comment">//å¯ä»¥ä¼ å‚</span>
    <span class="token function">getContent</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å‘'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">'å‘é€ç½‘ç»œè¯·æ±‚, æ•°æ®:'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyValue<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
è£…é¥°ç±»
<span class="token keyword">function</span> <span class="token function">Skin</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//targetæ˜¯ç±»æœ¬èº«  </span>
    target<span class="token punctuation">.</span>aaa <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span><span class="token comment">//ç»™ç±»æ·»åŠ ä¸€ä¸ªé™æ€å±æ€§</span>
<span class="token punctuation">}</span>


<span class="token keyword">let</span> oS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Search</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// oS.url = 20;</span>

oInput<span class="token punctuation">.</span><span class="token function-variable function">oninput</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    oS<span class="token punctuation">.</span>keyValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

oBtn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    oS<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æå›› </span>

è£…é¥°ç§æœ‰å±æ€§ 
<span class="token keyword">function</span> <span class="token function">myReadOnly</span> <span class="token punctuation">(</span>proto<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//PROTOæ˜¯åŸå‹ï¼Œkeyæ˜¯è¦è£…é¥°çš„ç§æœ‰å±æ€§åï¼Œdescriptoræ˜¯è£…é¥°æ–¹æ³•çš„å¯¹è±¡ï¼Œ</span>
    <span class="token comment">// console.log(proto, key, descriptor);</span>
    descriptor<span class="token punctuation">.</span>writable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    descriptor<span class="token punctuation">.</span><span class="token function-variable function">initializer</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//initializeræ˜¯descriptorä¸Šçš„æ–¹æ³•ï¼Œå¯ä»¥å–åˆ°å±æ€§å€¼ï¼Œå¹¶é€šè¿‡èµ‹å€¼å‡½æ•°è¿›è¡Œæ“ä½œ</span>
        <span class="token keyword">return</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

åŸå‹ä¸Šçš„æ–¹æ³•çš„è¯
<span class="token comment">//protoæ˜¯è¦ä¿®é¥°çš„å¯¹è±¡, keyè¦ä¿®é¥°çš„å±æ€§å, descriptoè¯¥å±æ€§çš„æè¿°å¯¹è±¡</span>
<span class="token keyword">function</span> <span class="token function">dealData</span> <span class="token punctuation">(</span>proto<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//è£…é¥°åŸå‹ä¸Šçš„å±æ€§æ—¶ï¼Œæ²¡æœ‰initializerï¼Œæœ‰value</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>proto<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> oldValue <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span><span class="token comment">//descriptor.valueå°±æ˜¯è¦è£…é¥°çš„æ–¹æ³•getContent (a, b) {</span>
    <span class="token comment">// ä»£ç†æ€æƒ³</span>
    descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">var</span> urlB <span class="token operator">=</span> <span class="token string">'urlB-'</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å‘'</span> <span class="token operator">+</span> urlB <span class="token operator">+</span> <span class="token string">'å‘é€ç½‘ç»œè¯·æ±‚, æ•°æ®:'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¤„ç†ä¸€ä¸ªæ–°åŠŸèƒ½</span>

        <span class="token keyword">return</span> oldValue<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŸæ¥çš„åŠŸèƒ½ç»§ç»­æ‰§è¡Œ</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function">dealData</span> <span class="token punctuation">(</span>ms<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//ä¼ å‚</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>proto<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>proto<span class="token punctuation">,</span> key<span class="token punctuation">,</span> descriptor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> oldValue <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token comment">// ä»£ç†æ€æƒ³</span>
        descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
            <span class="token keyword">var</span> urlB <span class="token operator">=</span> <span class="token string">'urlB-'</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å‘'</span> <span class="token operator">+</span> urlB <span class="token operator">+</span> <span class="token string">'å‘é€ç½‘ç»œè¯·æ±‚, æ•°æ®:'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyValue <span class="token operator">+</span> ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
            <span class="token keyword">return</span> oldValue<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><h2 id="es6ä¹‹set"><a href="#es6ä¹‹set" aria-hidden="true" class="header-anchor">#</a> ES6ä¹‹set</h2> <ol><li>setå’Œmapçš„å…¼å®¹æ€§ä¸å¥½ï¼Œåº”ç”¨åœºæ™¯å¾ˆå°‘ï¼Œä¸æ€ä¹ˆç”¨</li> <li>setæ˜¯æ„é€ å‡½æ•°ï¼Œç”¨æ¥å­˜å‚¨æ•°æ®
<img src="/ES6/set1.jpg" alt="set1" style="margin:10px auto"></li> <li>setä¸Šçš„æ–¹æ³• os.add(æ•°æ®)æ·»åŠ æ•°æ®; os.delete(æ•°æ®)åˆ é™¤æ•°æ®ï¼Œè¦åˆ é™¤æ•°ç»„ï¼Œæ•°ç»„å…ˆæ‹¿å˜é‡æ¥æ”¶;os.clear()æ¸…ç©º;os.has(æ•°æ®)æ˜¯å¦æœ‰è¿™ä¸ªæ•°æ®;</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> oS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'cst'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰ä¸€ä¸ªsetï¼Œå¹¶ä¼ å…¥æ•°æ®</span>
<span class="token keyword">let</span> oS2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡º&quot;a&quot;   &quot;b&quot; &quot;c&quot;</span>
oS2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¾€os2é‡Œå­˜å…¥æ•°æ®</span>

<span class="token comment">// api </span>
<span class="token keyword">let</span> oS3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
oS3<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
oS3<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">delete</span><span class="token comment">//åˆ é™¤æŸæ•°æ®</span>
clear<span class="token comment">//æ¸…ç©ºæ•°æ®</span>
has<span class="token comment">//å­˜åœ¨æŸæ•°æ®</span>
å…·å¤‡Iteratoræ¥å£çš„å€¼ arr <span class="token keyword">set</span> map string

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> val <span class="token keyword">of</span> oS2<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//åˆ©ç”¨for   oféå†setï¼Œåˆ©ç”¨for of  å˜é‡çš„å¿…é¡»å…·å¤‡è¿­ä»£æ¥å£</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

oS2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>val <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//éå†set   </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


Setä¸arrä¹‹é—´çš„è½¬æ¢
<span class="token comment">//è½¬æ¢ä¸ºæ•°ç»„æ›´å®¹æ˜“æ“ä½œ</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> oS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†æ•°ç»„è½¬æ¢ä¸ºset</span>
<span class="token comment">// ä¸¤ç§æ–¹å¼å¯ä»¥å°†setè½¬æ¢ä¸ºæ•°ç»„</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>oS<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//éœ€è¦æœ‰è¿­ä»£æ¥å£</span>
Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>oS<span class="token punctuation">)</span><span class="token comment">//å°†ç±»æ•°ç»„ã€å…·æœ‰è¿­ä»£å™¨çš„è½¬æ¢ä¸ºæ•°ç»„ </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ol start="5"><li>setçš„åº”ç”¨
åº”ç”¨ä¸€</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//åº”ç”¨ä¸€ï¼šæ•°ç»„å»é‡</span>
<span class="token keyword">let</span> o2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'cst'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> o2<span class="token punctuation">,</span> o2<span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'cg'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// Set</span>
<span class="token keyword">let</span> oS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'cst'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> o<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> o<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'cg'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//åˆ©ç”¨forå¾ªç¯è¿›è¡Œå»é‡æ—¶ï¼Œå¯¹æ•°ç»„é‡Œçš„å¯¹è±¡ä¸èƒ½å»é‡ï¼Œæ•°ç»„é‡Œæ‰€æœ‰çš„å¯¹è±¡ä¼šåªç•™ä¸‹ä¸€ä¸ª</span>
<span class="token comment">//å¯¹è±¡åœ¨æ•°ç»„é‡Œä¼šè°ƒç”¨tostringæ–¹æ³•ï¼Œä¹‹åè¾“å‡º[object Object],å› æ­¤åªä¼šç•™ä¸‹ä¸€ä¸ª</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>obj<span class="token punctuation">[</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        obj<span class="token punctuation">[</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> newArr <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//åˆ©ç”¨Setè¿›è¡Œæ•°ç»„å»é‡</span>
<span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'cst'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> o<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> o<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'cg'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> oS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è‡ªåŠ¨å»é‡äº†</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>åº”ç”¨äºŒ</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//åº”ç”¨äºŒï¼šå¹¶é›† äº¤é›†å’Œå·®é›†ï¼ˆä¸åœ¨å‰ç«¯æï¼Œåå°ï¼‰</span>

<span class="token comment">//å¹¶é›†ï¼šä¸¤ä¸ªæ•°ç»„åˆå¹¶å¹¶å»é‡</span>
<span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

Set
<span class="token keyword">let</span> oS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">,</span> <span class="token operator">...</span>arr2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆå¹¶å»é‡</span>


<span class="token comment">//äº¤é›†ï¼šä¸¤ä¸ªæ•°ç»„å…±æœ‰çš„éƒ¨åˆ†å¹¶å»é‡</span>
<span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> oS1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é‡</span>
<span class="token keyword">let</span> oS2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é‡</span>

<span class="token keyword">let</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>oS1<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span> ele <span class="token operator">=&gt;</span> oS2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœoS2é‡Œæœ‰eleå°±è¿”å›ç»™ä¸€ä¸ªæ–°æ•°ç»„</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//å·®é›†ï¼šä¸¤ä¸ªæ•°ç»„ä¸å…±æœ‰çš„éƒ¨åˆ†å¹¶å»é‡</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> oS1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é‡</span>
<span class="token keyword">let</span> oS2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å»é‡</span>

<span class="token keyword">let</span> newArr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>oS1<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>ele <span class="token operator">=&gt;</span><span class="token operator">!</span>oS2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœoS2é‡Œæ²¡æœ‰eleå°±è¿”å›ç»™ä¸€ä¸ªæ–°æ•°ç»„</span>

<span class="token keyword">let</span> newArr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>oS2<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>ele <span class="token operator">=&gt;</span><span class="token operator">!</span>oS1<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœoS1é‡Œæ²¡æœ‰eleå°±è¿”å›ç»™ä¸€ä¸ªæ–°æ•°ç»„</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token operator">...</span>newArr1<span class="token punctuation">,</span> <span class="token operator">...</span>newArr2<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†ä¸¤ä¸ªæ–°æ•°ç»„åˆå¹¶</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="es6ä¹‹map"><a href="#es6ä¹‹map" aria-hidden="true" class="header-anchor">#</a> ES6ä¹‹map</h2> <ol><li>åŸºæœ¬ç”¨æ³•ï¼š</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>åˆå§‹åŒ–
<span class="token keyword">let</span> oMp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'cst'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'sex'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'----'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//mapçš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œæ¯ä¸ªå…ƒç´ éƒ½è¦æ”¾åˆ°æ•°ç»„é‡Œï¼Œæ¯ä¸ªå…ƒç´ ä»¥é”®å€¼å¯¹å½¢å¼å­˜åœ¨</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>oMp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡ºè·Ÿå¯¹è±¡ç±»ä¼¼ï¼Œä½†ä¸æ˜¯å¯¹è±¡ï¼Œæ˜¯ä¸€ç§æ–°çš„å­˜å‚¨å½¢å¼</span>

api
<span class="token keyword">let</span> oMp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'cst'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”¨setå¾€mapé‡Œå­˜å€¼ï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'----'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'+++++'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

oMp<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å–å€¼</span>
oMp<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å–å¼•ç”¨å€¼æ˜¯å–ä¸åˆ°çš„ï¼Œæ ¹æœ¬å°±ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡</span>
oMp<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å–å¯¹è±¡å°±è¦æŠŠå¯¹è±¡å­˜åœ¨å˜é‡é‡Œï¼Œå†å–å€¼</span>

Map<span class="token punctuation">.</span>prototype<span class="token comment">//å¯ä»¥æŸ¥çœ‹åŸå‹ä¸Šæœ‰å“ªäº›æ–¹æ³•</span>
<span class="token comment">//æœ‰deleteã€clearã€size(é•¿åº¦)ã€keys(æ‰€æœ‰å±æ€§åå–å‡ºæ¥)ã€entries(å–é”®å€¼å¯¹)ã€hasï¼ˆæœ‰å“ªäº›å±æ€§ï¼‰</span>


forEach<span class="token comment">//éå†map</span>
oMp<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ele<span class="token punctuation">,</span> key<span class="token punctuation">,</span> self<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//eleï¼šå±æ€§å€¼  keyï¼šå±æ€§å   selfï¼šå®ƒè‡ªå·±</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ele<span class="token punctuation">,</span> key<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> val <span class="token keyword">of</span> oMp<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//for oféå†å¤„ç†çš„æ˜¯é”®å€¼å¯¹å½¢å¼çš„æ•°ç»„</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> val<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> val <span class="token keyword">of</span> oMp<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡ºæ‰€æœ‰å±æ€§å</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> val <span class="token keyword">of</span> oMp<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//entriesæœ‰ç‚¹é¸¡è‚‹</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡ºæ‰€æœ‰é”®å€¼å¯¹</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><ol start="2"><li>mapåŸç†
<img src="/ES6/map1.png" alt="map1" style="margin:10px auto"></li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Map å®ç°åŸç†</span>

<span class="token comment">//é“¾è¡¨ï¼šä¸¾ä¾‹{} {} {} {} {}å°†å‡ ä¸ªå¯¹è±¡è”ç³»èµ·æ¥</span>
<span class="token keyword">let</span> node3 <span class="token operator">=</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> <span class="token string">'name3'</span><span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span>
    next<span class="token punctuation">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> node2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> <span class="token string">'name2'</span><span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
    next<span class="token punctuation">:</span> node3<span class="token comment">//è®°å½•å¦ä¸€ä¸ªå¯¹è±¡</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> node1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
    next<span class="token punctuation">:</span> node2<span class="token comment">//è®°å½•å¦ä¸€ä¸ªå¯¹è±¡  é€šè¿‡è¿™ä¸ªå±æ€§è¿›è¡Œé“¾æ¥</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//é€šè¿‡node1.nextæ‰¾åˆ°node2ï¼Œé€šè¿‡node1.next.nextæ‰¾åˆ°node3ï¼Œ</span>


name name<span class="token comment">//mapå­˜ä¸¤ä¸ªç›¸åŒå±æ€§åï¼Œåä¸€ä¸ªä¼šè¦†ç›–å‰ä¸€ä¸ª</span>

<span class="token keyword">let</span> oMp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'name1'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'name2'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ¯ä¸ªå…ƒç´ æ˜¯ä»¥å¯¹è±¡çš„å½¢å¼å­˜å‚¨</span>
<span class="token comment">//æ¯ä¸ªå¯¹è±¡ä¼šæœ‰å¾ˆå¤šå±æ€§ï¼Œå…¶ä¸­ä¸€ä¸ªå±æ€§æ˜¯ç”¨æ¥é“¾æ¥å„å±æ€§çš„</span>
<span class="token comment">//åœ¨å–å€¼çš„æ—¶å€™ï¼Œé€šè¿‡è°ƒç”¨å±æ€§åï¼Œæ ¹æ®hashç®—æ³•ï¼Œå¾—åˆ°å±æ€§å€¼</span>

hash <span class="token operator">-</span><span class="token operator">&gt;</span>
<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token string">'name1'</span> <span class="token string">'age'</span> <span class="token number">1</span> <span class="token boolean">true</span> <span class="token number">NaN</span><span class="token comment">//mapé”®å€¼å¯èƒ½ä¸ä¸€æ ·  ä¸å®šçš„å€¼å­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„èŒƒå›´å¦‚0 - 8</span>

<span class="token comment">//é€šè¿‡hashç®—æ³•  å¼„å‡º ç‰¹ç‚¹èŒƒå›´çš„å€¼</span>
<span class="token comment">//æ¡¶   å¯ä»¥åˆ©ç”¨æ•°ç»„åšä¸€ä¸ªæ¡¶ï¼Œæ¡¶é‡Œæœ‰å…«ä¸ªä½ç½®</span>

<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      
        next<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            key<span class="token punctuation">:</span> <span class="token string">'name1'</span><span class="token punctuation">,</span>
            value<span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
            next<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                key<span class="token punctuation">:</span> <span class="token string">'name2'</span><span class="token punctuation">,</span>
                value<span class="token punctuation">:</span> <span class="token string">'2'</span>
            <span class="token punctuation">}</span> 
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>




<span class="token comment">//mapå…·ä½“å®ç°</span>
<span class="token keyword">let</span> prop <span class="token operator">=</span> <span class="token string">'name'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>prop <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'cst'</span>  <span class="token comment">//ES6å¯ä»¥å°†å˜é‡æ”¾åœ¨[]é‡Œä½œä¸ºå±æ€§å</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">myMap</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>bucketLength <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

myMap<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆå§‹åŒ– </span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>bucket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bucketLength <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ¡¶çš„ä½ç½®æœ‰å…«ä¸ª</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bucket<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            type<span class="token punctuation">:</span> <span class="token string">'bucket_'</span> <span class="token operator">+</span> i<span class="token punctuation">,</span><span class="token comment">//éå†æ¯ä¸ªæ¡¶ï¼Œèµ·ä¸ªç¼–å·</span>
            next<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token comment">//åˆå§‹åŒ–æ—¶ï¼Œè®©æ¯ä¸ªæ¡¶æ˜¯ç©ºçš„</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//å†™hashç®—æ³• </span>
<span class="token comment">// 1. [0, 8)</span>
<span class="token comment">// 2. é‡å¤ç®—å€¼å›ºå®š</span>
myMap<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">makeHash</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> hash <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// string   </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> key <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> key <span class="token operator">==</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//number NaN </span>
            <span class="token comment">//Object.is(key, NaN)æ˜¯ES6é‡Œçš„æ–°æ–¹æ³•ï¼Œç”¨æ¥åˆ¤æ–­é‡Œé¢çš„ä¸¤ä¸ªå‚æ•°æ˜¯å¦ç›¸ç­‰</span>
            hash <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> key<span class="token punctuation">;</span><span class="token comment">//å¦‚æœkeyç­‰äºNaNå°±èµ‹0ï¼Œå¦åˆ™èµ‹key</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> key <span class="token operator">==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// null {} []</span>
            hash <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> key <span class="token operator">==</span> <span class="token string">'boolean'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// true false boolean</span>
            hash <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// undefined  function(){}</span>
            hash <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// string</span>
        <span class="token comment">// 'a' 'ab' 'asdasdadasda';</span>
        <span class="token comment">// å¦‚æœé•¿åº¦å¤§äºç­‰äº3 ï¼Œå–å‰ä¸‰ä¸ªå­—ç¬¦ï¼Œå°†ascii ç´¯åŠ  </span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// key[i]å–å‡ºå­—ç¬¦ä¸²ä¸­çš„æŸä¸€ä½ï¼ŒcharCodeAt(0)å–asciiå€¼</span>
            hash <span class="token operator">+=</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">?</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœæœ‰å€¼å°±å–asciiå€¼ï¼Œæ²¡æœ‰å°±ç´¯åŠ 0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> hash <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span><span class="token comment">//è®©hashåœ¨0-8ä¹‹é—´</span>
<span class="token punctuation">}</span>

myMap<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">set</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeHash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç®—keyçš„hashå€¼</span>
    <span class="token keyword">let</span> oTempBucket <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bucket<span class="token punctuation">[</span>hash<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//æ¡¶ä¸­çš„ä½ç½®</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœoTempBucket.nextå­˜åœ¨æ‰§è¡Œä¸‹é¢</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">.</span>key <span class="token operator">==</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœæœ‰keyå°±è¦†ç›–value</span>
            oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœæ²¡æœ‰keyï¼ŒæŠŠoTempBucket.nextèµ‹ç»™ä¸‹ä¸€ä¸ª,å°±æ˜¯åœ¨åšé“¾å¼</span>
            oTempBucket <span class="token operator">=</span> oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    oTempBucket<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœoTempBucket.nextä¸å­˜åœ¨æ‰§è¡Œä¸‹é¢</span>
        key<span class="token punctuation">:</span> key<span class="token punctuation">,</span>
        value<span class="token punctuation">:</span> value<span class="token punctuation">,</span>
        next<span class="token punctuation">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

myMap<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeHash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç®—keyçš„hashå€¼</span>
    <span class="token keyword">let</span> oTempBucket <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bucket<span class="token punctuation">[</span>hash<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//æ¡¶ä¸­çš„ä½ç½®</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>oTempBucket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oTempBucket<span class="token punctuation">.</span>key <span class="token operator">==</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœæœ‰keyå°±è¿”å›value</span>
            <span class="token keyword">return</span> oTempBucket<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœæ²¡æœ‰keyï¼ŒæŠŠoTempBucket.nextèµ‹ç»™ä¸‹ä¸€ä¸ª,å°±æ˜¯å¾€ä¸‹æ‰¾</span>
            oTempBucket <span class="token operator">=</span> oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> undefined<span class="token punctuation">;</span><span class="token comment">//å¦‚æœæ²¡æ‰¾åˆ°å°±undefined</span>
<span class="token punctuation">}</span>

myMap<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">delete</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeHash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> oTempBucket <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bucket<span class="token punctuation">[</span>hash<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">.</span>key <span class="token operator">==</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            oTempBucket<span class="token punctuation">.</span>next <span class="token operator">=</span> oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token comment">//nextèµ‹å€¼ç»™å‰ä¸€ä¸ª</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            oTempBucket <span class="token operator">=</span> oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

myMap<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">has</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeHash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> oTempBucket <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bucket<span class="token punctuation">[</span>hash<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>oTempBucket<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oTempBucket<span class="token punctuation">.</span>next <span class="token operator">&amp;&amp;</span> oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">.</span>key <span class="token operator">==</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            oTempBucket <span class="token operator">=</span> oTempBucket<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

myMap<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//</span>
<span class="token keyword">let</span> oMp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">myMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'cst'</span>
<span class="token punctuation">}</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'name1'</span><span class="token punctuation">,</span> <span class="token string">'cst1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'name2'</span><span class="token punctuation">,</span> <span class="token string">'cst2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> <span class="token string">'---'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> <span class="token string">'+++'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
oMp<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br></div></div><h2 id="es6ä¹‹promiseä½¿ç”¨"><a href="#es6ä¹‹promiseä½¿ç”¨" aria-hidden="true" class="header-anchor">#</a> ES6ä¹‹promiseä½¿ç”¨</h2> <ol><li>promiseæ˜¯å†…ç½®çš„æ„é€ å‡½æ•°</li> <li>Promise   newæ‰§è¡Œ</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> oP <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Promiseæ‰§è¡Œæ—¶ï¼Œè¦æ‰§è¡Œexecutor å‡½æ•°ï¼ŒåŒæ­¥æ‰§è¡Œ</span>
        <span class="token keyword">let</span> oP <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//è¿™é‡Œè¦åŒæ­¥æ‰§è¡Œ</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å…ˆè¾“å‡º 0  å†è¾“å‡º 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="3"><li>Promise æ‰¿è¯ºå¼‚æ­¥æ“ä½œ
// å¯ä»¥å¯¹æ¯”å­¦ä¹ Deferredï¼ˆjQueryé‡Œçš„å¼‚æ­¥æ“ä½œï¼‰---&gt; ä¸‰ç§çŠ¶æ€ï¼ˆdone    fail    progressï¼‰  è§¦å‘ä¸‰ç§çŠ¶æ€çš„æ–¹æ³•ï¼ˆdone    fail    progressï¼‰</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTime'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> oP <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¼‚æ­¥æ“ä½œ</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">&gt;</span> <span class="token number">60</span> <span class="token operator">?</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¢«è§¦å‘åä¼šå¼‚æ­¥æ‰§è¡Œ</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åªæœ‰æ³¨å†Œthenæ‰èƒ½ è§¦å‘Promiseå›è°ƒ</span>
        <span class="token comment">// then  åªèƒ½æ³¨å†Œä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼Œä¸€ä¸ªæˆåŠŸï¼Œä¸€ä¸ªå¤±è´¥</span>
        <span class="token comment">// å¼‚æ­¥æ‰§è¡Œ</span>
        <span class="token comment">// å®ä»»åŠ¡ï¼šsetTimeout()   Ajaxå›è°ƒ</span>
        <span class="token comment">// å¾®ä»»åŠ¡ï¼š   then     </span>
        <span class="token comment">// å®ä»»åŠ¡â€”â€”&gt;ä¼˜å…ˆæ”¾åˆ°é˜Ÿåˆ—é‡Œ    å¾®ä»»åŠ¡ â€”â€”&gt;åæ”¾åˆ°é˜Ÿåˆ—é‡Œ  (å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡ä¸åœ¨ä¸€ä¸ªé˜Ÿåˆ—é‡Œæ‰§è¡Œ)</span>
        <span class="token comment">// task queue 1                 task queue 2</span>
        <span class="token comment">// å¾®ä»»åŠ¡æœ‰ä¼˜å…ˆ æ‰§è¡Œæƒ</span>
        <span class="token comment">// jq ä½ ä¸çŸ¥é“çš„js UI å¤šçº¿ç¨‹</span>
        oP<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æˆåŠŸçŠ¶æ€æ—¶ï¼Œæ‰§è¡Œresolve('ok')å›è°ƒï¼Œå°±æ˜¯æ‰§è¡Œ console.log(val)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¤±è´¥çŠ¶æ€æ—¶ï¼Œæ‰§è¡Œreject('no')ï¼Œå°±æ˜¯æ‰§è¡Œconsole.log(reason)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è¾“å‡º 0 2 1 setTime</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ol start="4"><li>é“¾å¼æ“ä½œ</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> oP <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¼‚æ­¥æ“ä½œ</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">&gt;</span> <span class="token number">60</span> <span class="token operator">?</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é“¾å¼æ“ä½œ.then åå† .then</span>
        <span class="token comment">// ä¸Šä¸€ä¸ªthenä¸æŠ›å‡ºé”™è¯¯çš„è¯ï¼Œé‚£ä¸‹ä¸€ä¸ªthenåªæ‰§è¡ŒæˆåŠŸçš„å‡½æ•°   </span>
         oP<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'duyi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸Šä¸€ä¸ªthen æ³¨å†Œçš„å‡½æ•°æŠ›å‡ºé”™è¯¯ ä¸‹ä¸€ä¸ªthençš„å¤±è´¥å›è°ƒå°±ä¼šæ‰§è¡Œ</span>
        <span class="token comment">// è¿”å›å€¼ Promise å¯¹è±¡ï¼Œå°†è§¦å‘ä¸‹ä¸€ä¸ª.thençš„æˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒ</span>
        <span class="token comment">//    return new Promise((resolve, reject) =&gt; {</span>
        <span class="token comment">//         reject('newPromise ok');</span>
        <span class="token comment">//    });</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">return</span> <span class="token number">30</span><span class="token punctuation">;</span><span class="token comment">// ä¸Šä¸€ä¸ªthenè¿”å›å€¼ä½œä¸ºä¸‹ä¸€ä¸ªthenæ³¨å†Œå‡½æ•°çš„æ‰§è¡Œå‚æ•°</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok then2:'</span> <span class="token operator">+</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'no then2:'</span> <span class="token operator">+</span> reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ol start="5"><li>nodeé‡Œçš„å›è°ƒç»ƒä¹ </li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">readFile</span> <span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span>  <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//è¯»å–ä¸€ä¸ªæ–‡ä»¶</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">res</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœæœ‰æ•°æ®å°±å¯ä»¥è¢«è§¦å‘æ‰§è¡Œ</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/number.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//åˆ«å¿˜äº†readFileä¼ å‚</span>
    <span class="token keyword">return</span> <span class="token function">readFile</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æˆåŠŸçŠ¶æ€æ‰§è¡Œï¼Œè¯»å–æ–‡ä»¶</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">readFile</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æˆåŠŸçŠ¶æ€æ‰§è¡Œï¼Œè¯»å–æ–‡ä»¶</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æˆåŠŸçŠ¶æ€æ‰§è¡Œï¼Œæ‰“å°æ–‡ä»¶</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol start="6"><li>æ•è·å¼‚å¸¸</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> oP <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// throw new Error('duyi');</span>
            <span class="token function">res</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é“¾å¼è°ƒç”¨çš„æ—¶å€™å¦‚æœå†™ä¸€ä¸ªç©ºthenå…¶å®ç›¸å½“äºä¸å­˜åœ¨å¯ä»¥å¿½è§†</span>
        oP<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'duyi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿™é‡ŒæŠ›å‡ºé”™è¯¯ï¼Œåªè¦åé¢çš„.thené‡Œæœ‰è§¦å‘é”™è¯¯çš„å‡½æ•°å°±å¯ä»¥å¤„ç†</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//å‰é¢æœ‰èƒ½æ•è·å¼‚å¸¸çš„è¿™é‡Œçš„catchå°±ä¸èƒ½ç”¨äº†ï¼Œå¦‚æœæ²¡æœ‰å°±æ•è·</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">98</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//è¿”å›å€¼ä¸èƒ½è¢«ä¸‹é¢.thenè°ƒç”¨</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//ä¸Šé¢æœ‰catchä¸‹é¢.thenä¹Ÿå¯ä»¥ç”¨ï¼Œcatchå¦‚æœæŠ›å‡ºé”™è¯¯ï¼Œå°±è§¦å‘é”™è¯¯å‡½æ•°</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'catch after ok:'</span> <span class="token operator">+</span> val<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'catch after no:'</span> <span class="token operator">+</span> reason<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//æœ€åçš„å›è°ƒï¼Œåé¢ä¸èƒ½å†æ¥.thenäº†</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'over'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ol start="7"><li>.allåé¢çš„ï¼ˆï¼‰é‡Œåªèƒ½å†™æ•°ç»„ï¼Œ.allé‡Œå›è°ƒå…¨éƒ¨æˆåŠŸè§¦å‘.thenæˆåŠŸï¼Œ.allé‡Œå›è°ƒä¸€ä¸ªå¤±è´¥è§¦å‘.thenå¤±è´¥</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/number.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/name.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/score.txt'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//valæ˜¯æ‰€æœ‰å›è°ƒçš„æ‰§è¡Œç»“æœ</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>// Promise.allå¯ä»¥å°†å¤šä¸ªPromiseå®ä¾‹åŒ…è£…æˆä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚
// åŒæ—¶ï¼ŒæˆåŠŸå’Œå¤±è´¥çš„è¿”å›å€¼æ˜¯ä¸åŒçš„ï¼ŒæˆåŠŸçš„æ—¶å€™è¿”å›çš„æ˜¯ä¸€ä¸ªç»“æœæ•°ç»„ï¼Œ
// è€Œå¤±è´¥çš„æ—¶å€™åˆ™è¿”å›æœ€å…ˆè¢«rejectå¤±è´¥çŠ¶æ€çš„å€¼ã€‚</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> <span class="token keyword">function</span> <span class="token function">test</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
               <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                   Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">&gt;</span> <span class="token number">50</span> <span class="token operator">?</span> <span class="token function">res</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">rej</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> oP <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        oP<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="8"><li>race èµ›è·‘  .raceé‡Œå›è°ƒæœ€å…ˆå®Œæˆçš„è§¦å‘.thenæˆåŠŸæˆ–å¤±è´¥</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/number.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/name.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/score.txt'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>mise.raceå°±æ˜¯èµ›è·‘çš„æ„æ€ï¼Œæ„æ€å°±æ˜¯è¯´ï¼Œ
// Promise.race([p1, p2, p3])é‡Œé¢å“ªä¸ªç»“æœè·å¾—çš„å¿«ï¼Œå°±è¿”å›é‚£ä¸ªç»“æœï¼Œ
// ä¸ç®¡ç»“æœæœ¬èº«æ˜¯æˆåŠŸçŠ¶æ€è¿˜æ˜¯å¤±è´¥çŠ¶æ€ã€‚</p> <h2 id="es6ä¹‹promise-ç”¨es5æ¨¡æ‹Ÿå®ç°"><a href="#es6ä¹‹promise-ç”¨es5æ¨¡æ‹Ÿå®ç°" aria-hidden="true" class="header-anchor">#</a> ES6ä¹‹promise----ç”¨ES5æ¨¡æ‹Ÿå®ç°</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">MyPromise</span> <span class="token punctuation">(</span>executor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span><span class="token comment">//è®©thisæŒ‡å‘è‡ªå·±ï¼Œé˜²æ­¢æŒ‡å‘window</span>
    self<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">'pending'</span><span class="token punctuation">;</span><span class="token comment">//æ­£åœ¨è¿›è¡Œçš„çŠ¶æ€ç </span>
    self<span class="token punctuation">.</span>resolveValue <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//ä¸ºäº†è®©.thenæ–¹æ³•èƒ½æ“ä½œresolve å’Œrejectçš„å‚æ•°ï¼Œè®¾ç½®ä¸€ä¸ªå€¼è¢«è°ƒç”¨</span>
    self<span class="token punctuation">.</span>rejectReason <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>ResolveCallBackList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>RejectCallBackList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">resolve</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">'pending'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            self<span class="token punctuation">.</span>resolveValue <span class="token operator">=</span> value<span class="token punctuation">;</span><span class="token comment">//å°†valueå‚æ•°ä¼ ç»™self.resolveValueï¼Œä¾¿äº.thenæ“ä½œ</span>
            self<span class="token punctuation">.</span>ResolveCallBackList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>ele<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//è¦å¼‚æ­¥æ‰§è¡Œçš„æ—¶å€™å†æ‰§è¡Œ</span>
                <span class="token function">ele</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">reject</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">'pending'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            self<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">'Rejected'</span><span class="token punctuation">;</span><span class="token comment">//æ›´æ”¹ä¸ºå¤±è´¥çš„çŠ¶æ€ç </span>
            self<span class="token punctuation">.</span>rejectReason <span class="token operator">=</span> reason<span class="token punctuation">;</span><span class="token comment">//å°†reasonå‚æ•°ä¼ ç»™self.rejectReasonï¼Œä¾¿äº.thenæ“ä½œ</span>
            self<span class="token punctuation">.</span>RejectCallBackList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>ele<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">ele</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>
    
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token function">executor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœ executor(resolve, reject);æŠ›å‡ºé”™è¯¯ï¼Œå°±æ‰§è¡Œreject(e)</span>
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">ResolutionRetrunPromise</span> <span class="token punctuation">(</span>nextPromise<span class="token punctuation">,</span> returnValue<span class="token punctuation">,</span> res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//.then è¿”å›Promiseåï¼Œè¦è§¦å‘ä¸‹ä¸€ä¸ª.then </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>returnValue <span class="token keyword">instanceof</span> <span class="token class-name">MyPromise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Promise å¯¹è±¡</span>
        returnValue<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">res</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">rej</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">res</span><span class="token punctuation">(</span>returnValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

MyPromise<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">then</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>onFulfilled<span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//ç©ºthenå¤„ç†</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onFulfilled<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//.thenæ²¡æœ‰ä¼ æˆåŠŸè§¦å‘å‡½æ•°æ—¶ï¼Œæ‰§è¡Œ</span>
        <span class="token function-variable function">onFulfilled</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> val<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onRejected<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//.thenæ²¡æœ‰ä¼ å¤±è´¥è§¦å‘å‡½æ•°æ—¶ï¼Œæ‰§è¡Œ</span>
        <span class="token function-variable function">onRejected</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>    
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> nextPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„MyPromiseï¼Œä¸º.thenèƒ½å®ç°é“¾å¼æ“ä½œ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">'Fulfilled'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//æ²¡æœ‰å¾®ä»»åŠ¡çš„æƒé™ï¼ŒsetTimeoutæ¨¡æ‹Ÿå¼‚æ­¥æ‰§è¡Œ</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœå‡ºç°é”™è¯¯å°±æŠ›å‡ºé”™è¯¯</span>
                    <span class="token comment">// var nextResolveValue = onFulfilled(self.resolveValue);</span>
                    <span class="token comment">// res(nextResolveValue);</span>
                    <span class="token keyword">var</span> nextResolveValue <span class="token operator">=</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>resolveValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">ResolutionRetrunPromise</span><span class="token punctuation">(</span>nextPromise<span class="token punctuation">,</span> nextResolveValue<span class="token punctuation">,</span> res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿”å›Promiseåå¤„ç†</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">rej</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æŠ›å‡ºé”™è¯¯å°±æ‰§è¡Œ</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">'Rejected'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">var</span> nextRejectValue <span class="token operator">=</span> <span class="token function">onRejected</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>rejectReason<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">ResolutionRetrunPromise</span><span class="token punctuation">(</span>nextPromise<span class="token punctuation">,</span> nextRejectValue<span class="token punctuation">,</span> res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">rej</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token comment">// </span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">'pending'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            self<span class="token punctuation">.</span>ResolveCallBackList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å…ˆå°†è¦æ‰§è¡Œçš„å‡½æ•°æ”¾åˆ°æ•°ç»„é‡Œï¼Œå¼‚æ­¥æ‰§è¡Œçš„æ—¶å€™å†æ‰§è¡Œ</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">var</span> nextResolveValue <span class="token operator">=</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>resolveValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">ResolutionRetrunPromise</span><span class="token punctuation">(</span>nextPromise<span class="token punctuation">,</span> nextResolveValue<span class="token punctuation">,</span> res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">rej</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
            self<span class="token punctuation">.</span>RejectCallBackList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        <span class="token keyword">var</span> nextRejectValue <span class="token operator">=</span> <span class="token function">onRejected</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>rejectReason<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token function">ResolutionRetrunPromise</span><span class="token punctuation">(</span>nextPromise<span class="token punctuation">,</span> nextRejectValue<span class="token punctuation">,</span> res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">rej</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> nextPromise<span class="token punctuation">;</span><span class="token comment">//è¦å®ç°é“¾å¼æ“ä½œï¼Œå°±è¦è¿”å›ä¸€ä¸ªPromiseï¼Œä¾¿äºä¸‹ä¸€æ¬¡å¤„ç†</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

MyPromise<span class="token punctuation">.</span><span class="token function-variable function">race</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>promiseArr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        promiseArr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>promise<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å“ªä¸ªå…ˆæ”¹å˜ï¼Œä¸€å®šä¼šè§¦å‘Promiseçš„resolve, reject</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br></div></div><h2 id="es6ä¹‹iterator"><a href="#es6ä¹‹iterator" aria-hidden="true" class="header-anchor">#</a> ES6ä¹‹Iterator</h2> <ol><li>è¿­ä»£çš„åŸºæœ¬æ¦‚å¿µ<br> <img src="/ES6/Iterator1.png" alt="Iterator1" style="margin:10px auto"> <img src="/ES6/Iterator2.png" alt="Iterator2" style="margin:10px auto"></li> <li>Symbol ç¬¬ä¸ƒç§æ•°æ®ç»“æ„</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> os <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡ºSymbol(abc)</span>
        <span class="token keyword">let</span> os2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'cst'</span><span class="token punctuation">,</span>
            toString<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//é‡å†™äº†toStringæ–¹æ³•ï¼Œè¦ä¸é‡å†™å°±å»æ‰¾objectä¸Šçš„</span>
                <span class="token keyword">return</span> <span class="token string">'duyi'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>os2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡ºSymbol(duyi)</span>
        <span class="token keyword">let</span> os2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Symbolå…·æœ‰å”¯ä¸€æ€§ï¼Œå³ä½¿è¾“å‡ºä¸€æ ·os2ä¹Ÿä¸ç­‰äºos</span>
        
        <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token punctuation">[</span>os2<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'cst2'</span><span class="token punctuation">,</span><span class="token comment">//Symbolç±»å‹æ•°æ®ç»“æ„å¯ä»¥ä½œä¸ºå±æ€§</span>
            <span class="token punctuation">[</span>os<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'cst'</span><span class="token comment">//å–å€¼åªèƒ½å†™obj[os]</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//å…·æœ‰Symbol.iteratorå±æ€§çš„æ‰èƒ½ç”¨ES6çš„è¿­ä»£æ–¹æ³•        </span>
        <span class="token comment">// itertorå‡½æ•°</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> Symbol<span class="token punctuation">.</span>iterator <span class="token punctuation">,</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'Symbol.iterator'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ol start="3"><li>å¯¹æ²¡æœ‰ES6è¿­ä»£æ–¹æ³•çš„å¦‚ä½•æ·»åŠ </li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code> <span class="token comment">// ES6 è§„èŒƒ iterator</span>
        <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>
            <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span>
            <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span>
            length<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token comment">//è¦æƒ³æ²¡æœ‰Symbol.iteratorå±æ€§çš„ï¼Œå…·æœ‰ES6è¿­ä»£æ–¹æ³•ï¼Œå°±è¦æ‰‹åŠ¨æ·»åŠ </span>
            <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> curIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è¦è¿­ä»£å¯¹è±¡çš„ç´¢å¼•ï¼Œä»0å¼€å§‹</span>
                <span class="token keyword">let</span> <span class="token function-variable function">next</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token punctuation">{</span>
                        value<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">[</span>curIndex<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//è¦è¿­ä»£å¯¹è±¡ç´¢å¼•å¯¹ç›¸åº”çš„å€¼</span>
                        done<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token operator">++</span>curIndex<span class="token punctuation">,</span><span class="token comment">//ç´¢å¼•è‡ªåŠ¨åŠ ï¼Œç›´åˆ°ä¸è¦è¿­ä»£å¯¹è±¡é•¿åº¦ç›¸åŒï¼Œè¾“å‡ºtrueï¼Œè¡¨ç¤ºè¿­ä»£å®Œæˆ</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    next<span class="token comment">//å¿…é¡»returnå‡ºnextå‡½æ•°ï¼Œä½¿ç”¨ES6æ–¹æ³•ï¼ˆ...   for ofç­‰ï¼‰å°±è¦è°ƒç”¨iteratoræ–¹æ³•ï¼Œå³æ‰§è¡Œnext</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>obj<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="es6ä¹‹generator"><a href="#es6ä¹‹generator" aria-hidden="true" class="header-anchor">#</a> ES6ä¹‹Generator</h2> <ol><li>åŸºæœ¬æ¦‚å¿µ<br> <img src="/ES6/Generator1.png" alt="Generator1" style="margin:10px auto"></li> <li>Generator ç”Ÿæˆè¿­ä»£å¯¹è±¡</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">test</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å®šä¹‰ç”Ÿæˆå™¨</span>
            <span class="token keyword">yield</span> <span class="token string">'a'</span><span class="token punctuation">;</span><span class="token comment">//oG.next()   è¾“å‡º{value: a ,  done: false}  å¹¶ä¸”æš‚åœ</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">yield</span> <span class="token string">'b'</span><span class="token punctuation">;</span><span class="token comment">//oG.next()   è¾“å‡º 1    å’Œ{value: b ,  done: false}  å¹¶ä¸”æš‚åœ</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">yield</span> <span class="token string">'c'</span><span class="token punctuation">;</span><span class="token comment">//oG.next()   è¾“å‡º 2    å’Œ{value: c ,  done: false}  å¹¶ä¸”æš‚åœ</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">'d'</span><span class="token punctuation">;</span><span class="token comment">//oG.next()   è¾“å‡º 3    å’Œ{value: d ,  done: true}  </span>
        <span class="token punctuation">}</span>
        <span class="token keyword">let</span> oG <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="3"><li>ä¸€ç‚¹åº”ç”¨ä¸€</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">test</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                            
            <span class="token keyword">let</span> value1 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token string">'a'</span><span class="token punctuation">;</span><span class="token comment">//oG.next() è¾“å‡º{value: a ,  done: false}  å¹¶ä¸”æš‚åœ</span>
			
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value1<span class="token punctuation">)</span><span class="token punctuation">;</span>          
            <span class="token keyword">let</span> value2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token string">'b'</span><span class="token punctuation">;</span><span class="token comment">//oG.next('test1')   è¾“å‡º test1(value1è¾“å‡ºå–å†³ä¸.next() ä¼ å…¥ä»€ä¹ˆ)   å’Œ{value: b ,  done: false}  å¹¶ä¸”æš‚åœ</span>
			
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span><span class="token punctuation">;</span>         
            <span class="token keyword">let</span> value3 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token string">'c'</span><span class="token punctuation">;</span><span class="token comment">//oG.next('test2')   è¾“å‡º test2   å’Œ{value: c ,  done: false}  å¹¶ä¸”æš‚åœ</span>
            
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value3<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">'d'</span><span class="token punctuation">;</span><span class="token comment">//oG.next('test3')   è¾“å‡º test3   å’Œ{value: d ,  done: true} </span>
        <span class="token punctuation">}</span>
        <span class="token keyword">let</span> oG <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="4"><li>ä¸€ç‚¹åº”ç”¨äºŒ</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// æ”¹é€ æ·»åŠ Symbol.iteratorçš„å‡½æ•°</span>
        <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>
            <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span>
            <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span>
            length<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> currIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>currIndex <span class="token operator">!=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å½“å˜é‡ä¸ç­‰äºå¯¹è±¡é•¿åº¦ï¼Œå°±æ‰§è¡Œä¸‹é¢</span>
                    <span class="token keyword">yield</span> <span class="token keyword">this</span><span class="token punctuation">[</span>currIndex<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//è¾“å‡ºå±æ€§å€¼ï¼Œæš‚åœ</span>
                    currIndex<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//ä¸‹æ¬¡å…ˆæ‰§è¡Œè¿™ï¼Œå†å¾€å¾ªç¯</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>obj<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ol start="5"><li>ä¸€ç‚¹åº”ç”¨ä¸‰</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// nodeç¯å¢ƒä¸‹ </span>
<span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">readFile</span> <span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">res</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">rej</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//æ–¹æ³•ä¸€ï¼šåˆ©ç”¨.thenæ¥å±‚å±‚è°ƒç”¨</span>
<span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/number.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">readFile</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">readFile</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// æ–¹æ³•äºŒï¼šGenerator å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">read</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> val1 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/number.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> val2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">readFile</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> val3 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">readFile</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> val3<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> oG <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span>value<span class="token punctuation">,</span> done<span class="token punctuation">}</span> <span class="token operator">=</span> oG<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§£æ„ {valueï¼ˆPromiseå¯¹è±¡readFile('./data/number.txt')ï¼‰, doneï¼šfalse}</span>
value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//valæ‹¿åˆ°å€¼</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>value<span class="token punctuation">,</span> done<span class="token punctuation">}</span> <span class="token operator">=</span> oG<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//.next(val)è®©val1æ‹¿å€¼ç»§ç»­æ‰§è¡Œ</span>
    value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span>value<span class="token punctuation">,</span> done<span class="token punctuation">}</span> <span class="token operator">=</span> oG<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//æ–¹æ³•äºŒä¼˜åŒ–ï¼š é€’å½’ä¼˜åŒ–å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">Co</span> <span class="token punctuation">(</span>oIt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> rej<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token function-variable function">next</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//å£°æ˜ä¸€ä¸ªå‡½æ•°</span>
            <span class="token keyword">let</span> <span class="token punctuation">{</span>value<span class="token punctuation">,</span> done<span class="token punctuation">}</span> <span class="token operator">=</span> oIt<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§£æ„</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">res</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token function">next</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é€’å½’</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> rej<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¤±è´¥çš„å›è°ƒ</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">Co</span><span class="token punctuation">(</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//è§¦å‘å¤±è´¥çš„å›è°ƒ</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// coæ˜¯æ’ä»¶æ¨¡å—ï¼Œæ˜¯TJå†™çš„ï¼Œä»–è¿˜å†™äº† express koa node</span>
<span class="token keyword">let</span> co <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'co'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¯ä¸‹è½½æ’ä»¶ï¼Œç›´æ¥å¼•å…¥</span>
<span class="token function">co</span><span class="token punctuation">(</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><h2 id="es7ä¹‹async-await"><a href="#es7ä¹‹async-await" aria-hidden="true" class="header-anchor">#</a> ES7ä¹‹async + await</h2> <ol><li>åŸºæœ¬æ¦‚å¿µ<br> <img src="/ES6/asyncawait.png" alt="asyncawait" style="margin:10px auto"></li> <li>å¯¹ä¸Šé¢ ------&gt;ä¸€ç‚¹åº”ç”¨ä¸‰ çš„æ”¹å†™    åˆ©ç”¨async + await</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">read</span> <span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//asyncå‡½æ•°å¼‚æ­¥æ‰§è¡Œ</span>
    <span class="token keyword">let</span> val1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//awaitç­‰å¾…readFile(url)æ‰§è¡Œå®Œå†å°†ç»“æœèµ‹å€¼ç»™val1</span>
    <span class="token keyword">let</span> val2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> val3 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> val3<span class="token punctuation">;</span><span class="token comment">//æ˜¯Promiseå¯¹è±¡ï¼Œè¿˜éœ€è¦.thenæ¥è§¦å‘å›è°ƒ</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">read</span><span class="token punctuation">(</span><span class="token string">'./data/number.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="3"><li>åŒæ­¥å¹¶å‘çš„å¼‚æ­¥ç»“æœ</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//é¿å…åƒPromise.allä¸€æ ·ï¼Œå‡ºç°ä¸€æ¬¡é”™è¯¯å°±æ— æ³•è¾“å‡º</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">read1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> val1 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        val1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/number1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">read2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> val2 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        val2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/number.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">read3</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> val3 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        val3 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data/number1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">readAll</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//éå†æ‰€æœ‰å‡½æ•°ï¼Œå¹¶æ‰§è¡Œ</span>
    args<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">ele</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">readAll</span><span class="token punctuation">(</span>read1<span class="token punctuation">,</span> read2<span class="token punctuation">,</span> read3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="es6å…¶å®ƒå†…å®¹æ‰©å±•-ä¸è€å¸ˆ"><a href="#es6å…¶å®ƒå†…å®¹æ‰©å±•-ä¸è€å¸ˆ" aria-hidden="true" class="header-anchor">#</a> ES6å…¶å®ƒå†…å®¹æ‰©å±•(ä¸è€å¸ˆ)</h2> <ol><li>æ¨¡å—åŒ–   		
æ–¹æ³•ä¸€ï¼š<br>
å¯¼å‡ºexport {num as n ,str, show, Node} //å¯¼å‡ºçš„numèµ·äº†ä¸ªåˆ«ån   åœ¨å¼•å…¥çš„æ—¶å€™å¿…é¡»å¼•å…¥n	<br>
å¯¼å…¥import   {num ,str, show as pps, Node}  from './a.js'   //å¼•å…¥çš„showèµ·äº†ä¸ªåˆ«åpps   ä¸‹é¢åœ¨ç”¨çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨pps<br>
æ–¹æ³•äºŒï¼š<br>
é»˜è®¤å¯¼å‡ºï¼šexport default 1   é»˜è®¤å¯¼å…¥  import a from './a.js' <br>
æ–¹æ³•ä¸‰ï¼š<br>
é»˜è®¤å¯¼å‡ºï¼šexport {num as default ,str, show, Node} <br>
é»˜è®¤å¯¼å…¥  import a from './a.js' <br>
æ–¹æ³•å››ï¼š<br>
import * as demo from './a.js' //æŠŠæ–‡ä»¶ä¸­æ‰€ç”¨ä¸œè¥¿å¯¼å…¥<br></li></ol></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.6a253733.js" defer></script><script src="/assets/js/9.3dabbb14.js" defer></script>
  </body>
</html>
